import{P as vt,Q as gt,R as Se,H as bt,s as pe,f as b,a as U,g as k,h as w,d as _,c as R,j as s,F as ee,i as N,v as g,D as Z,G as W,w as ue,o as ye,e as le,I as _t,p as Ae,C as ht,K as de,l as X,L as _e,m as Y,n as te,S as Le,E as ae,u as je,T as kt}from"./scheduler.tnyNm5U0.js";import{g as oe,t as Q,c as ce,a as P,S as ve,i as ge,b as be,d as ke,m as Ee,e as Te}from"./index.R_ElRwcJ.js";import{e as Ne}from"./each.-oqiv04n.js";import"./paths.rpYSVT10.js";import{a as se,i as re,t as De,g as fe,c as Me,d as Et}from"./common.DsDv12mj.js";import{e as Ie}from"./stores.bABpd-zC.js";import{p as Tt}from"./stores.9cqK4bRg.js";import{_ as mt}from"./preload-helper.0HuHagjb.js";function Pe(r,e){const a=e.token={};function t(l,n,i,o){if(e.token!==a)return;e.resolved=o;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=o);const u=l&&(e.current=l)(c);let f=!1;e.block&&(e.blocks?e.blocks.forEach((d,p)=>{p!==n&&d&&(oe(),Q(d,1,1,()=>{e.blocks[p]===d&&(e.blocks[p]=null)}),ce())}):e.block.d(1),u.c(),P(u,1),u.m(e.mount(),e.anchor),f=!0),e.block=u,e.blocks&&(e.blocks[n]=u),f&&bt()}if(vt(r)){const l=gt();if(r.then(n=>{Se(l),t(e.then,1,e.value,n),Se(null)},n=>{if(Se(l),t(e.catch,2,e.error,n),Se(null),!e.hasCatch)throw n}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,r),!0;e.resolved=r}}function It(r,e,a){const t=e.slice(),{resolved:l}=r;r.current===r.then&&(t[r.value]=l),r.current===r.catch&&(t[r.error]=l),r.block.p(t,a)}function me(r){let e=r.replies.size;return r.replies.size>0&&r.replies.forEach(a=>{e+=me(a)}),e}function Ge(r,e,a){const t=r.slice();return t[14]=e[a],t}function ze(r){let e,a=Ne(r[0].attachment),t=[];for(let l=0;l<a.length;l+=1)t[l]=We(Ge(r,a,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=le()},l(l){for(let n=0;n<t.length;n+=1)t[n].l(l);e=le()},m(l,n){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(l,n);N(l,e,n)},p(l,n){if(n&177){a=Ne(l[0].attachment);let i;for(i=0;i<a.length;i+=1){const o=Ge(l,a,i);t[i]?t[i].p(o,n):(t[i]=We(o),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=a.length}},d(l){l&&_(e),_t(t,l)}}}function wt(r){let e,a,t,l,n,i,o,c;return{c(){e=b("div"),a=b("video"),t=b("source"),c=U(),this.h()},l(u){e=k(u,"DIV",{class:!0,tabindex:!0});var f=w(e);a=k(f,"VIDEO",{width:!0,height:!0});var d=w(a);t=k(d,"SOURCE",{src:!0,type:!0}),d.forEach(_),c=R(f),f.forEach(_),this.h()},h(){ee(t.src,l=se(r[4],window.Buffer,String(r[14].url)))||s(t,"src",l),s(t,"type",n=r[14].mediaType),s(a,"width",i=r[14].width),s(a,"height",o=r[14].height),a.controls=!0,s(e,"class",ht(r[5].getPlacement())+" svelte-grl42x"),s(e,"tabindex","0")},m(u,f){N(u,e,f),g(e,a),g(a,t),g(e,c)},p(u,f){f&17&&!ee(t.src,l=se(u[4],window.Buffer,String(u[14].url)))&&s(t,"src",l),f&1&&n!==(n=u[14].mediaType)&&s(t,"type",n),f&1&&i!==(i=u[14].width)&&s(a,"width",i),f&1&&o!==(o=u[14].height)&&s(a,"height",o)},d(u){u&&_(e)}}}function St(r){let e,a,t,l,n,i,o,c,u;return{c(){e=b("div"),a=b("img"),o=U(),this.h()},l(f){e=k(f,"DIV",{class:!0,tabindex:!0});var d=w(e);a=k(d,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),o=R(d),d.forEach(_),this.h()},h(){ee(a.src,t=se(r[4],window.Buffer,String(r[14].url)))||s(a,"src",t),s(a,"width",l=r[14].width),s(a,"height",n=r[14].height),s(a,"alt",i=r[14].name),s(a,"class","svelte-grl42x"),s(e,"class",ht(r[5].getPlacement())+" svelte-grl42x"),s(e,"tabindex","0")},m(f,d){N(f,e,d),g(e,a),g(e,o),c||(u=Z(a,"click",r[7]),c=!0)},p(f,d){d&17&&!ee(a.src,t=se(f[4],window.Buffer,String(f[14].url)))&&s(a,"src",t),d&1&&l!==(l=f[14].width)&&s(a,"width",l),d&1&&n!==(n=f[14].height)&&s(a,"height",n),d&1&&i!==(i=f[14].name)&&s(a,"alt",i)},d(f){f&&_(e),c=!1,u()}}}function We(r){let e,a,t;function l(o,c){if(c&1&&(e=null),c&1&&(a=null),e==null&&(e=!!(o[14].type=="Document"&&/^(?:image)\/.+$/.test(String(o[14].mediaType)))),e)return St;if(a==null&&(a=!!(o[14].type=="Document"&&/^(?:video)\/.+$/.test(String(o[14].mediaType)))),a)return wt}let n=l(r,-1),i=n&&n(r);return{c(){i&&i.c(),t=le()},l(o){i&&i.l(o),t=le()},m(o,c){i&&i.m(o,c),N(o,t,c)},p(o,c){n===(n=l(o,c))&&i?i.p(o,c):(i&&i.d(1),i=n&&n(o),i&&(i.c(),i.m(t.parentNode,t)))},d(o){o&&_(t),i&&i.d(o)}}}function At(r){let e,a,t,l,n,i,o,c,u,f=r[0].attachment&&ze(r);return{c(){e=b("div"),a=U(),t=b("div"),l=b("img"),i=U(),o=b("section"),f&&f.c(),this.h()},l(d){e=k(d,"DIV",{class:!0}),w(e).forEach(_),a=R(d),t=k(d,"DIV",{role:!0,"aria-labelledby":!0,class:!0});var p=w(t);l=k(p,"IMG",{src:!0,class:!0}),p.forEach(_),i=R(d),o=k(d,"SECTION",{class:!0});var h=w(o);f&&f.l(h),h.forEach(_),this.h()},h(){s(e,"class","mask hidden svelte-grl42x"),ee(l.src,n="#")||s(l,"src",n),s(l,"class","svelte-grl42x"),s(t,"role","img"),s(t,"aria-labelledby","cancel"),s(t,"class","image hidden svelte-grl42x"),s(o,"class","svelte-grl42x")},m(d,p){N(d,e,p),r[9](e),N(d,a,p),N(d,t,p),g(t,l),r[10](l),r[11](t),N(d,i,p),N(d,o,p),f&&f.m(o,null),c||(u=Z(l,"click",r[6]),c=!0)},p(d,[p]){d[0].attachment?f?f.p(d,p):(f=ze(d),f.c(),f.m(o,null)):f&&(f.d(1),f=null)},i:W,o:W,d(d){d&&(_(e),_(a),_(t),_(i),_(o)),r[9](null),r[10](null),r[11](null),f&&f.d(),c=!1,u()}}}function jt(r,e,a){let t,l;ue(r,Ie,E=>a(8,l=E));let{note:n}=e;ye(async()=>{const{Buffer:E}=await mt(()=>import("./index.aMiLl7Je.js").then(y=>y.i),__vite__mapDeps([0,1]),import.meta.url);window.Buffer=E,u.classList.add("closed")});class i{constructor(y){i.total=y}static{this.total=0}static{this.iteration=0}getPlacement(){return i.iteration++,i.total%2===0||i.total>=3&&i.iteration!==1?"half":"full"}}let o=new i(n.attachment?.length||0);n.attachment?.length;let c,u,f;const d=E=>{console.log(E),a(1,c.src="#",c),f.classList.add("hidden"),u.classList.add("hidden")},p=E=>{console.log(E),E.target&&E.target.src&&(a(1,c.src=E.target.src,c),f.classList.remove("hidden"),u.classList.remove("hidden"))};function h(E){Ae[E?"unshift":"push"](()=>{u=E,a(2,u)})}function v(E){Ae[E?"unshift":"push"](()=>{c=E,a(1,c)})}function A(E){Ae[E?"unshift":"push"](()=>{f=E,a(3,f)})}return r.$$set=E=>{"note"in E&&a(0,n=E.note)},r.$$.update=()=>{r.$$.dirty&256&&a(4,t=l)},[n,c,u,f,t,o,d,p,l,h,v,A]}class pt extends ve{constructor(e){super(),ge(this,e,jt,At,pe,{note:0})}}function Je(r,e,a){const t=r.slice();return t[12]=e[a],t}function Ke(r){let e,a;return{c(){e=b("img"),this.h()},l(t){e=k(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ee(e.src,a=r[0].actor.icon.url)||s(e,"src",a),s(e,"alt","Sender"),s(e,"class","svelte-iote2n")},m(t,l){N(t,e,l)},p(t,l){l&1&&!ee(e.src,a=t[0].actor.icon.url)&&s(e,"src",a)},d(t){t&&_(e)}}}function qe(r){let e,a,t=re(r[2],r[0].actor.name||r[0].actor.preferredUsername,r[0].actor)+"",l,n,i=fe(r[0].actor)+"",o,c;return{c(){e=b("a"),a=new de(!1),l=X(` •
				`),n=b("span"),o=X(i),this.h()},l(u){e=k(u,"A",{href:!0,class:!0});var f=w(e);a=_e(f,!1),l=Y(f,` •
				`),n=k(f,"SPAN",{class:!0});var d=w(n);o=Y(d,i),d.forEach(_),f.forEach(_),this.h()},h(){a.a=l,s(n,"class","url svelte-iote2n"),s(e,"href",c="/search?actor="+r[0].actor.id),s(e,"class","svelte-iote2n")},m(u,f){N(u,e,f),a.m(t,e),g(e,l),g(e,n),g(n,o)},p(u,f){f&5&&t!==(t=re(u[2],u[0].actor.name||u[0].actor.preferredUsername,u[0].actor)+"")&&a.p(t),f&1&&i!==(i=fe(u[0].actor)+"")&&te(o,i),f&1&&c!==(c="/search?actor="+u[0].actor.id)&&s(e,"href",c)},d(u){u&&_(e)}}}function Fe(r){let e,a;return e=new pt({props:{note:r[0].note}}),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,l){Ee(e,t,l),a=!0},p(t,l){const n={};l&1&&(n.note=t[0].note),e.$set(n)},i(t){a||(P(e.$$.fragment,t),a=!0)},o(t){Q(e.$$.fragment,t),a=!1},d(t){Te(e,t)}}}function Qe(r){let e,a,t,l=me(r[0])+"",n,i,o;return{c(){e=b("span"),a=b("i"),t=U(),n=X(l),this.h()},l(c){e=k(c,"SPAN",{class:!0,"data-conversation":!0,"data-note":!0});var u=w(e);a=k(u,"I",{class:!0}),w(a).forEach(_),t=R(u),n=Y(u,l),u.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-comments svelte-iote2n"),s(e,"class","comments svelte-iote2n"),s(e,"data-conversation",i=r[0].note.conversation),s(e,"data-note",o=r[0].note.id)},m(c,u){N(c,e,u),g(e,a),g(e,t),g(e,n)},p(c,u){u&1&&l!==(l=me(c[0])+"")&&te(n,l),u&1&&i!==(i=c[0].note.conversation)&&s(e,"data-conversation",i),u&1&&o!==(o=c[0].note.id)&&s(e,"data-note",o)},d(c){c&&_(e)}}}function Xe(r){let e,a,t;function l(d,p){return d[0].note.ephemeralAnnounced?Dt:Nt}let n=l(r),i=n(r);function o(d,p){return d[0].note.ephemeralLiked?Lt:yt}let c=o(r),u=c(r),f=r[0].actor&&Ye(r);return{c(){e=b("nav"),i.c(),a=U(),u.c(),t=U(),f&&f.c(),this.h()},l(d){e=k(d,"NAV",{class:!0});var p=w(e);i.l(p),a=R(p),u.l(p),t=R(p),f&&f.l(p),p.forEach(_),this.h()},h(){s(e,"class","svelte-iote2n")},m(d,p){N(d,e,p),i.m(e,null),g(e,a),u.m(e,null),g(e,t),f&&f.m(e,null)},p(d,p){n===(n=l(d))&&i?i.p(d,p):(i.d(1),i=n(d),i&&(i.c(),i.m(e,a))),c===(c=o(d))&&u?u.p(d,p):(u.d(1),u=c(d),u&&(u.c(),u.m(e,t))),d[0].actor?f?f.p(d,p):(f=Ye(d),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(d){d&&_(e),i.d(),u.d(),f&&f.d()}}}function Nt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-actor":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat svelte-iote2n"),s(e,"data-object",a=r[0].note.id),s(e,"data-actor",t=r[0].note.attributedTo)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(r[3])),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a),o&1&&t!==(t=i[0].note.attributedTo)&&s(e,"data-actor",t)},d(i){i&&_(e),l=!1,n()}}}function Dt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-actor":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat selected svelte-iote2n"),s(e,"data-object",a=r[0].note.id),s(e,"data-actor",t=r[0].note.attributedTo)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(r[3])),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a),o&1&&t!==(t=i[0].note.attributedTo)&&s(e,"data-actor",t)},d(i){i&&_(e),l=!1,n()}}}function yt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star svelte-iote2n"),s(e,"data-actor",a=r[0].note.attributedTo),s(e,"data-object",t=r[0].note.id)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(r[4])),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.attributedTo)&&s(e,"data-actor",a),o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t)},d(i){i&&_(e),l=!1,n()}}}function Lt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star selected svelte-iote2n"),s(e,"data-actor",a=r[0].note.attributedTo),s(e,"data-object",t=r[0].note.id)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(Ut)),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.attributedTo)&&s(e,"data-actor",a),o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t)},d(i){i&&_(e),l=!1,n()}}}function Ye(r){let e,a,t,l,n,i,o,c,u;return{c(){e=b("i"),this.h()},l(f){e=k(f,"I",{class:!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-reply svelte-iote2n"),s(e,"data-reply",a=r[0].note.id),s(e,"data-display",t=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",l=r[0].actor.url),s(e,"data-username",n=r[0].actor.preferredUsername),s(e,"data-recipient",i=r[0].actor.id),s(e,"data-conversation",o=r[0].note.conversation)},m(f,d){N(f,e,d),c||(u=Z(e,"click",r[7]),c=!0)},p(f,d){d&1&&a!==(a=f[0].note.id)&&s(e,"data-reply",a),d&1&&t!==(t=f[0].actor.name||f[0].actor.preferredUsername)&&s(e,"data-display",t),d&1&&l!==(l=f[0].actor.url)&&s(e,"data-url",l),d&1&&n!==(n=f[0].actor.preferredUsername)&&s(e,"data-username",n),d&1&&i!==(i=f[0].actor.id)&&s(e,"data-recipient",i),d&1&&o!==(o=f[0].note.conversation)&&s(e,"data-conversation",o)},d(f){f&&_(e),c=!1,u()}}}function Ze(r){let e,a,t=Ne(Array.from(r[0].replies.values()).sort(Me)),l=[];for(let i=0;i<t.length;i+=1)l[i]=$e(Je(r,t,i));const n=i=>Q(l[i],1,1,()=>{l[i]=null});return{c(){e=b("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=k(i,"DIV",{class:!0});var o=w(e);for(let c=0;c<l.length;c+=1)l[c].l(o);o.forEach(_),this.h()},h(){s(e,"class","replies svelte-iote2n")},m(i,o){N(i,e,o);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);a=!0},p(i,o){if(o&99){t=Ne(Array.from(i[0].replies.values()).sort(Me));let c;for(c=0;c<t.length;c+=1){const u=Je(i,t,c);l[c]?(l[c].p(u,o),P(l[c],1)):(l[c]=$e(u),l[c].c(),P(l[c],1),l[c].m(e,null))}for(oe(),c=t.length;c<l.length;c+=1)n(c);ce()}},i(i){if(!a){for(let o=0;o<t.length;o+=1)P(l[o]);a=!0}},o(i){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)Q(l[o]);a=!1},d(i){i&&_(e),_t(l,i)}}}function $e(r){let e,a;return e=new Vt({props:{note:r[12],username:r[1]}}),e.$on("reply_to",r[6]),e.$on("note_select",r[5]),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,l){Ee(e,t,l),a=!0},p(t,l){const n={};l&1&&(n.note=t[12]),l&2&&(n.username=t[1]),e.$set(n)},i(t){a||(P(e.$$.fragment,t),a=!0)},o(t){Q(e.$$.fragment,t),a=!1},d(t){Te(e,t)}}}function Ct(r){let e,a,t,l,n,i,o,c,u=re(r[2],r[0].note.content||"",r[0].note)+"",f,d,p,h,v=De(new Date(String(r[0].published)).getTime())+"",A,E,y,H,L,M,B=r[0].actor&&r[0].actor.icon&&Ke(r),V=r[0].actor&&qe(r),D=r[0].note.attachment&&r[0].note.attachment.length>0&&Fe(r),m=r[0].replies?.size&&Qe(r),T=r[1]&&Xe(r),I=r[0].replies?.size&&Ze(r);return{c(){e=b("article"),a=b("div"),t=b("div"),B&&B.c(),l=U(),n=b("address"),V&&V.c(),i=U(),o=b("section"),c=new de(!1),f=U(),D&&D.c(),d=U(),m&&m.c(),p=U(),h=b("time"),A=X(v),y=U(),T&&T.c(),H=U(),I&&I.c(),L=le(),this.h()},l(S){e=k(S,"ARTICLE",{class:!0});var O=w(e);a=k(O,"DIV",{class:!0});var he=w(a);t=k(he,"DIV",{});var J=w(t);B&&B.l(J),J.forEach(_),he.forEach(_),l=R(O),n=k(O,"ADDRESS",{class:!0});var K=w(n);V&&V.l(K),K.forEach(_),i=R(O),o=k(O,"SECTION",{class:!0});var q=w(o);c=_e(q,!1),q.forEach(_),f=R(O),D&&D.l(O),d=R(O),m&&m.l(O),p=R(O),h=k(O,"TIME",{datetime:!0,class:!0});var F=w(h);A=Y(F,v),F.forEach(_),y=R(O),T&&T.l(O),O.forEach(_),H=R(S),I&&I.l(S),L=le(),this.h()},h(){s(a,"class","avatar svelte-iote2n"),s(n,"class","svelte-iote2n"),c.a=null,s(o,"class","svelte-iote2n"),s(h,"datetime",E=r[0].published),s(h,"class","svelte-iote2n"),s(e,"class","svelte-iote2n")},m(S,O){N(S,e,O),g(e,a),g(a,t),B&&B.m(t,null),g(e,l),g(e,n),V&&V.m(n,null),g(e,i),g(e,o),c.m(u,o),g(e,f),D&&D.m(e,null),g(e,d),m&&m.m(e,null),g(e,p),g(e,h),g(h,A),g(e,y),T&&T.m(e,null),N(S,H,O),I&&I.m(S,O),N(S,L,O),M=!0},p(S,[O]){S[0].actor&&S[0].actor.icon?B?B.p(S,O):(B=Ke(S),B.c(),B.m(t,null)):B&&(B.d(1),B=null),S[0].actor?V?V.p(S,O):(V=qe(S),V.c(),V.m(n,null)):V&&(V.d(1),V=null),(!M||O&5)&&u!==(u=re(S[2],S[0].note.content||"",S[0].note)+"")&&c.p(u),S[0].note.attachment&&S[0].note.attachment.length>0?D?(D.p(S,O),O&1&&P(D,1)):(D=Fe(S),D.c(),P(D,1),D.m(e,d)):D&&(oe(),Q(D,1,1,()=>{D=null}),ce()),S[0].replies?.size?m?m.p(S,O):(m=Qe(S),m.c(),m.m(e,p)):m&&(m.d(1),m=null),(!M||O&1)&&v!==(v=De(new Date(String(S[0].published)).getTime())+"")&&te(A,v),(!M||O&1&&E!==(E=S[0].published))&&s(h,"datetime",E),S[1]?T?T.p(S,O):(T=Xe(S),T.c(),T.m(e,null)):T&&(T.d(1),T=null),S[0].replies?.size?I?(I.p(S,O),O&1&&P(I,1)):(I=Ze(S),I.c(),P(I,1),I.m(L.parentNode,L)):I&&(oe(),Q(I,1,1,()=>{I=null}),ce())},i(S){M||(P(D),P(I),M=!0)},o(S){Q(D),Q(I),M=!1},d(S){S&&(_(e),_(H),_(L)),B&&B.d(),V&&V.d(),D&&D.d(),m&&m.d(),T&&T.d(),I&&I.d(S)}}}function Ut(r){String(r.target.dataset.object),String(r.target.dataset.actor)}function Rt(r,e,a){let t,l;ue(r,Ie,h=>a(8,l=h));const n=Le();let{note:i}=e,{username:o}=e;function c(h){console.debug("HANDLING DISPATCHED ANNOUNCE");const v=String(h.target.dataset.object),A=String(h.target.dataset.actor);t&&v&&A?h.target.classList.add("selected"):(console.error("OBJECT OR ACTOR INVALID"),console.debug(`OBJECT: ${v}, ACTOR: ${A}`))}function u(h){console.debug("HANDLING DISPATCHED LIKE");const v=String(h.target.dataset.object),A=String(h.target.dataset.actor);t&&t.send_like(A,v).then(()=>{})}function f(h){n("note_select",h.detail)}function d(h){n("reply_to",h.detail)}function p(h){n("reply_to",{reply_to_recipient:h.target.dataset.recipient,reply_to_note:h.target.dataset.reply,reply_to_display:h.target.dataset.display,reply_to_conversation:h.target.dataset.conversation,reply_to_url:h.target.dataset.url,reply_to_username:h.target.dataset.username})}return r.$$set=h=>{"note"in h&&a(0,i=h.note),"username"in h&&a(1,o=h.username)},r.$$.update=()=>{r.$$.dirty&256&&a(2,t=l)},[i,o,t,c,u,f,d,p,l]}class Vt extends ve{constructor(e){super(),ge(this,e,Rt,Ct,pe,{note:0,username:1})}}function xe(r){let e,a,t,l,n,i=r[0][z].ogTitle+"",o,c,u,f,d=r[0][z].ogImage?.length&&et(r),p=r[0][z].ogDescription&&tt(r),h=r[0][z].ogSiteName&&at(r);return{c(){e=b("a"),a=b("div"),d&&d.c(),t=U(),l=b("div"),n=b("span"),o=X(i),c=U(),p&&p.c(),u=U(),h&&h.c(),this.h()},l(v){e=k(v,"A",{href:!0,target:!0,rel:!0,class:!0});var A=w(e);a=k(A,"DIV",{class:!0});var E=w(a);d&&d.l(E),t=R(E),l=k(E,"DIV",{class:!0});var y=w(l);n=k(y,"SPAN",{class:!0});var H=w(n);o=Y(H,i),H.forEach(_),c=R(y),p&&p.l(y),u=R(y),h&&h.l(y),y.forEach(_),E.forEach(_),A.forEach(_),this.h()},h(){s(n,"class","svelte-9o0bks"),s(l,"class","svelte-9o0bks"),s(a,"class","svelte-9o0bks"),s(e,"href",f=r[0][z].ogUrl),s(e,"target","_blank"),s(e,"rel","noreferrer"),s(e,"class","svelte-9o0bks")},m(v,A){N(v,e,A),g(e,a),d&&d.m(a,null),g(a,t),g(a,l),g(l,n),g(n,o),g(l,c),p&&p.m(l,null),g(l,u),h&&h.m(l,null)},p(v,A){v[0][z].ogImage?.length?d?d.p(v,A):(d=et(v),d.c(),d.m(a,t)):d&&(d.d(1),d=null),A&1&&i!==(i=v[0][z].ogTitle+"")&&te(o,i),v[0][z].ogDescription?p?p.p(v,A):(p=tt(v),p.c(),p.m(l,u)):p&&(p.d(1),p=null),v[0][z].ogSiteName?h?h.p(v,A):(h=at(v),h.c(),h.m(l,null)):h&&(h.d(1),h=null),A&1&&f!==(f=v[0][z].ogUrl)&&s(e,"href",f)},d(v){v&&_(e),d&&d.d(),p&&p.d(),h&&h.d()}}}function et(r){let e,a,t,l,n;return{c(){e=b("div"),a=b("img"),this.h()},l(i){e=k(i,"DIV",{class:!0});var o=w(e);a=k(o,"IMG",{src:!0,alt:!0,class:!0}),o.forEach(_),this.h()},h(){ee(a.src,t=se(r[1],window.Buffer,String(r[0][z].ogImage)))||s(a,"src",t),s(a,"alt","Link Preview"),s(a,"class","svelte-9o0bks"),s(e,"class","image svelte-9o0bks")},m(i,o){N(i,e,o),g(e,a),l||(n=Z(a,"error",r[2]),l=!0)},p(i,o){o&3&&!ee(a.src,t=se(i[1],window.Buffer,String(i[0][z].ogImage)))&&s(a,"src",t)},d(i){i&&_(e),l=!1,n()}}}function tt(r){let e,a=r[0][z].ogDescription+"",t;return{c(){e=b("span"),t=X(a),this.h()},l(l){e=k(l,"SPAN",{class:!0});var n=w(e);t=Y(n,a),n.forEach(_),this.h()},h(){s(e,"class","svelte-9o0bks")},m(l,n){N(l,e,n),g(e,t)},p(l,n){n&1&&a!==(a=l[0][z].ogDescription+"")&&te(t,a)},d(l){l&&_(e)}}}function at(r){let e,a=r[0][z].ogSiteName+"",t;return{c(){e=b("span"),t=X(a),this.h()},l(l){e=k(l,"SPAN",{class:!0});var n=w(e);t=Y(n,a),n.forEach(_),this.h()},h(){s(e,"class","svelte-9o0bks")},m(l,n){N(l,e,n),g(e,t)},p(l,n){n&1&&a!==(a=l[0][z].ogSiteName+"")&&te(t,a)},d(l){l&&_(e)}}}function Ot(r){let e,a=r[0][z].ogUrl&&r[0][z].ogTitle&&xe(r);return{c(){a&&a.c(),e=le()},l(t){a&&a.l(t),e=le()},m(t,l){a&&a.m(t,l),N(t,e,l)},p(t,[l]){t[0][z].ogUrl&&t[0][z].ogTitle?a?a.p(t,l):(a=xe(t),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null)},i:W,o:W,d(t){t&&_(e),a&&a.d(t)}}}let z=0;function Bt(r,e,a){let t,l;ue(r,Ie,o=>a(3,l=o));let{links:n}=e;ye(async()=>{const{Buffer:o}=await mt(()=>import("./index.aMiLl7Je.js").then(c=>c.i),__vite__mapDeps([0,1]),import.meta.url);window.Buffer=o});const i=o=>{console.log(o.target);let c=o.target;c&&(c.style.display="none")};return r.$$set=o=>{"links"in o&&a(0,n=o.links)},r.$$.update=()=>{r.$$.dirty&8&&a(1,t=l)},[n,t,i,l]}class Ht extends ve{constructor(e){super(),ge(this,e,Bt,Ot,pe,{links:0})}}function lt(r){let e,a,t,l,n="Edit",i,o;return{c(){e=b("li"),a=X("Delete"),t=U(),l=b("li"),l.textContent=n,this.h()},l(c){e=k(c,"LI",{"data-object":!0,class:!0});var u=w(e);a=Y(u,"Delete"),u.forEach(_),t=R(c),l=k(c,"LI",{class:!0,"data-svelte-h":!0}),je(l)!=="svelte-nqb85c"&&(l.textContent=n),this.h()},h(){s(e,"data-object",r[0]),s(e,"class","svelte-1v3blo6"),s(l,"class","svelte-1v3blo6")},m(c,u){N(c,e,u),g(e,a),N(c,t,u),N(c,l,u),i||(o=Z(e,"click",ae(r[4])),i=!0)},p(c,u){u&1&&s(e,"data-object",c[0])},d(c){c&&(_(e),_(t),_(l)),i=!1,o()}}}function Mt(r){let e,a,t,l,n,i,o="Mute Author",c,u,f="Block Author",d,p,h="Block Instance",v,A,E=r[1]&&lt(r);return{c(){e=b("i"),a=U(),t=b("dialog"),l=b("ul"),E&&E.c(),n=U(),i=b("li"),i.textContent=o,c=U(),u=b("li"),u.textContent=f,d=U(),p=b("li"),p.textContent=h,this.h()},l(y){e=k(y,"I",{class:!0,"data-object":!0}),w(e).forEach(_),a=R(y),t=k(y,"DIALOG",{class:!0});var H=w(t);l=k(H,"UL",{class:!0});var L=w(l);E&&E.l(L),n=R(L),i=k(L,"LI",{class:!0,"data-svelte-h":!0}),je(i)!=="svelte-cedbu2"&&(i.textContent=o),c=R(L),u=k(L,"LI",{class:!0,"data-svelte-h":!0}),je(u)!=="svelte-1gvp02o"&&(u.textContent=f),d=R(L),p=k(L,"LI",{class:!0,"data-svelte-h":!0}),je(p)!=="svelte-5kz5l4"&&(p.textContent=h),L.forEach(_),H.forEach(_),this.h()},h(){s(e,"class","fa-solid fa-ellipsis svelte-1v3blo6"),s(e,"data-object",r[0]),s(i,"class","svelte-1v3blo6"),s(u,"class","svelte-1v3blo6"),s(p,"class","svelte-1v3blo6"),s(l,"class","svelte-1v3blo6"),s(t,"class","svelte-1v3blo6")},m(y,H){N(y,e,H),N(y,a,H),N(y,t,H),g(t,l),E&&E.m(l,null),g(l,n),g(l,i),g(l,c),g(l,u),g(l,d),g(l,p),r[8](t),v||(A=Z(e,"click",r[3]),v=!0)},p(y,[H]){H&1&&s(e,"data-object",y[0]),y[1]?E?E.p(y,H):(E=lt(y),E.c(),E.m(l,n)):E&&(E.d(1),E=null)},i:W,o:W,d(y){y&&(_(e),_(a),_(t)),E&&E.d(),r[8](null),v=!1,A()}}}function Pt(r,e,a){let t,l;ue(r,Ie,h=>a(7,l=h));let{object:n}=e,{owner:i}=e,{refresh:o}=e,{remove:c}=e;ye(async()=>{});function u(h){console.log("HANDLE MENU ACTIVATED"),d.open?d.close():d.show()}function f(h){console.log("HANDLE DELETE ACTIVATED");const v=h.target.dataset.object;t?.send_delete(v).then(A=>{A&&(console.info("DELETE SENT"),c(v))})}let d;function p(h){Ae[h?"unshift":"push"](()=>{d=h,a(2,d)})}return r.$$set=h=>{"object"in h&&a(0,n=h.object),"owner"in h&&a(1,i=h.owner),"refresh"in h&&a(5,o=h.refresh),"remove"in h&&a(6,c=h.remove)},r.$$.update=()=>{r.$$.dirty&128&&(t=l)},[n,i,d,u,f,o,c,l,p]}class Gt extends ve{constructor(e){super(),ge(this,e,Pt,Mt,pe,{object:0,owner:1,refresh:5,remove:6})}}function rt(r){let e,a,t,l,n,i,o,c;return{c(){e=b("span"),a=b("i"),t=X(` In
			`),l=b("a"),n=X("reply"),o=X(`
			to `),c=new de(!1),this.h()},l(u){e=k(u,"SPAN",{class:!0});var f=w(e);a=k(f,"I",{class:!0}),w(a).forEach(_),t=Y(f,` In
			`),l=k(f,"A",{href:!0,target:!0,rel:!0,class:!0});var d=w(l);n=Y(d,"reply"),d.forEach(_),o=Y(f,`
			to `),c=_e(f,!1),f.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-reply svelte-8a7ih0"),s(l,"href",i=r[0].note.inReplyTo),s(l,"target","_blank"),s(l,"rel","noreferrer"),s(l,"class","svelte-8a7ih0"),c.a=null,s(e,"class","reply svelte-8a7ih0")},m(u,f){N(u,e,f),g(e,a),g(e,t),g(e,l),g(l,n),g(e,o),c.m(r[2],e)},p(u,f){f&1&&i!==(i=u[0].note.inReplyTo)&&s(l,"href",i),f&4&&c.p(u[2])},d(u){u&&_(e)}}}function it(r){let e,a,t,l,n,i=r[3].name+"",o,c=r[3].others+"",u;return{c(){e=b("span"),a=b("i"),t=X(` Reposted by
			`),l=b("a"),n=new de(!1),u=X(c),this.h()},l(f){e=k(f,"SPAN",{class:!0});var d=w(e);a=k(d,"I",{class:!0}),w(a).forEach(_),t=Y(d,` Reposted by
			`),l=k(d,"A",{href:!0,class:!0});var p=w(l);n=_e(p,!1),p.forEach(_),u=Y(d,c),d.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-retweet svelte-8a7ih0"),n.a=null,s(l,"href",o=r[3].url),s(l,"class","svelte-8a7ih0"),s(e,"class","repost svelte-8a7ih0")},m(f,d){N(f,e,d),g(e,a),g(e,t),g(e,l),n.m(i,l),g(e,u)},p(f,d){d&8&&i!==(i=f[3].name+"")&&n.p(i),d&8&&o!==(o=f[3].url)&&s(l,"href",o),d&8&&c!==(c=f[3].others+"")&&te(u,c)},d(f){f&&_(e)}}}function nt(r){let e,a;return{c(){e=b("img"),this.h()},l(t){e=k(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ee(e.src,a=se(r[10],window.Buffer,r[0].actor.icon.url))||s(e,"src",a),s(e,"alt","Sender"),s(e,"class","svelte-8a7ih0")},m(t,l){N(t,e,l)},p(t,l){l&1025&&!ee(e.src,a=se(t[10],window.Buffer,t[0].actor.icon.url))&&s(e,"src",a)},d(t){t&&_(e)}}}function st(r){let e,a,t=re(r[10],r[0].actor.name||r[0].actor.preferredUsername,r[0].actor)+"",l,n,i=fe(r[0].actor)+"",o,c;return{c(){e=b("span"),a=new de(!1),l=U(),n=b("a"),o=X(i),this.h()},l(u){e=k(u,"SPAN",{class:!0});var f=w(e);a=_e(f,!1),f.forEach(_),l=R(u),n=k(u,"A",{href:!0,class:!0});var d=w(n);o=Y(d,i),d.forEach(_),this.h()},h(){a.a=null,s(e,"class","svelte-8a7ih0"),s(n,"href",c="/"+fe(r[0].actor)),s(n,"class","svelte-8a7ih0")},m(u,f){N(u,e,f),a.m(t,e),N(u,l,f),N(u,n,f),g(n,o)},p(u,f){f&1025&&t!==(t=re(u[10],u[0].actor.name||u[0].actor.preferredUsername,u[0].actor)+"")&&a.p(t),f&1&&i!==(i=fe(u[0].actor)+"")&&te(o,i),f&1&&c!==(c="/"+fe(u[0].actor))&&s(n,"href",c)},d(u){u&&(_(e),_(l),_(n))}}}function zt(r){let e,a;return e=new Ht({props:{links:r[0].note.ephemeralMetadata}}),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,l){Ee(e,t,l),a=!0},p(t,l){const n={};l&1&&(n.links=t[0].note.ephemeralMetadata),e.$set(n)},i(t){a||(P(e.$$.fragment,t),a=!0)},o(t){Q(e.$$.fragment,t),a=!1},d(t){Te(e,t)}}}function Wt(r){let e,a;return e=new pt({props:{note:r[0].note}}),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,l){Ee(e,t,l),a=!0},p(t,l){const n={};l&1&&(n.note=t[0].note),e.$set(n)},i(t){a||(P(e.$$.fragment,t),a=!0)},o(t){Q(e.$$.fragment,t),a=!1},d(t){Te(e,t)}}}function ot(r){let e,a,t,l=r[0].note.ephemeralLikes.length+"",n;return{c(){e=b("span"),a=b("i"),t=U(),n=X(l),this.h()},l(i){e=k(i,"SPAN",{class:!0});var o=w(e);a=k(o,"I",{class:!0}),w(a).forEach(_),t=R(o),n=Y(o,l),o.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-star svelte-8a7ih0"),s(e,"class","likes svelte-8a7ih0")},m(i,o){N(i,e,o),g(e,a),g(e,t),g(e,n)},p(i,o){o&1&&l!==(l=i[0].note.ephemeralLikes.length+"")&&te(n,l)},d(i){i&&_(e)}}}function ct(r){let e,a,t,l=me(r[0])+"",n,i,o,c,u,f,d,p,h;return{c(){e=b("span"),a=b("i"),t=U(),n=X(l),this.h()},l(v){e=k(v,"SPAN",{class:!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0,"data-note":!0});var A=w(e);a=k(A,"I",{class:!0}),w(a).forEach(_),t=R(A),n=Y(A,l),A.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-comments svelte-8a7ih0"),s(e,"class","comments svelte-8a7ih0"),s(e,"data-display",i=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",o=r[0].actor.url),s(e,"data-username",c=r[0].actor.preferredUsername),s(e,"data-recipient",u=r[0].actor.id),s(e,"data-conversation",f=r[0].note.conversation),s(e,"data-note",d=r[0].note.id)},m(v,A){N(v,e,A),g(e,a),g(e,t),g(e,n),p||(h=Z(e,"click",ae(r[15])),p=!0)},p(v,A){A&1&&l!==(l=me(v[0])+"")&&te(n,l),A&1&&i!==(i=v[0].actor.name||v[0].actor.preferredUsername)&&s(e,"data-display",i),A&1&&o!==(o=v[0].actor.url)&&s(e,"data-url",o),A&1&&c!==(c=v[0].actor.preferredUsername)&&s(e,"data-username",c),A&1&&u!==(u=v[0].actor.id)&&s(e,"data-recipient",u),A&1&&f!==(f=v[0].note.conversation)&&s(e,"data-conversation",f),A&1&&d!==(d=v[0].note.id)&&s(e,"data-note",d)},d(v){v&&_(e),p=!1,h()}}}function ft(r){let e,a,t,l,n,i,o,c,u,f,d,p,h,v,A,E;function y(T,I){return T[0].note.ephemeralAnnounced?Kt:Jt}let H=y(r),L=H(r);function M(T,I){return T[0].note.ephemeralLiked?Ft:qt}let B=M(r),V=B(r),D=r[0].actor&&ut(r),m=r[0].note.id&&dt(r);return{c(){e=b("nav"),a=b("i"),f=U(),L.c(),d=U(),V.c(),p=U(),D&&D.c(),h=U(),m&&m.c(),this.h()},l(T){e=k(T,"NAV",{class:!0});var I=w(e);a=k(I,"I",{class:!0,"data-conversation":!0,"data-note":!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0}),w(a).forEach(_),f=R(I),L.l(I),d=R(I),V.l(I),p=R(I),D&&D.l(I),h=R(I),m&&m.l(I),I.forEach(_),this.h()},h(){s(a,"class","fa-solid fa-expand svelte-8a7ih0"),s(a,"data-conversation",t=r[0].note.conversation),s(a,"data-note",l=r[0].note.id),s(a,"data-reply",n=r[0].note.id),s(a,"data-display",i=r[0].actor.name||r[0].actor.preferredUsername),s(a,"data-url",o=r[0].actor.url),s(a,"data-username",c=r[0].actor.preferredUsername),s(a,"data-recipient",u=r[0].actor.id),s(e,"class","svelte-8a7ih0")},m(T,I){N(T,e,I),g(e,a),g(e,f),L.m(e,null),g(e,d),V.m(e,null),g(e,p),D&&D.m(e,null),g(e,h),m&&m.m(e,null),v=!0,A||(E=Z(a,"click",ae(r[15])),A=!0)},p(T,I){(!v||I&1&&t!==(t=T[0].note.conversation))&&s(a,"data-conversation",t),(!v||I&1&&l!==(l=T[0].note.id))&&s(a,"data-note",l),(!v||I&1&&n!==(n=T[0].note.id))&&s(a,"data-reply",n),(!v||I&1&&i!==(i=T[0].actor.name||T[0].actor.preferredUsername))&&s(a,"data-display",i),(!v||I&1&&o!==(o=T[0].actor.url))&&s(a,"data-url",o),(!v||I&1&&c!==(c=T[0].actor.preferredUsername))&&s(a,"data-username",c),(!v||I&1&&u!==(u=T[0].actor.id))&&s(a,"data-recipient",u),H===(H=y(T))&&L?L.p(T,I):(L.d(1),L=H(T),L&&(L.c(),L.m(e,d))),B===(B=M(T))&&V?V.p(T,I):(V.d(1),V=B(T),V&&(V.c(),V.m(e,p))),T[0].actor?D?D.p(T,I):(D=ut(T),D.c(),D.m(e,h)):D&&(D.d(1),D=null),T[0].note.id?m?(m.p(T,I),I&1&&P(m,1)):(m=dt(T),m.c(),P(m,1),m.m(e,null)):m&&(oe(),Q(m,1,1,()=>{m=null}),ce())},i(T){v||(P(m),v=!0)},o(T){Q(m),v=!1},d(T){T&&_(e),L.d(),V.d(),D&&D.d(),m&&m.d(),A=!1,E()}}}function Jt(r){let e,a,t,l;return{c(){e=b("i"),this.h()},l(n){e=k(n,"I",{class:!0,"data-object":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat svelte-8a7ih0"),s(e,"data-object",a=r[0].note.id)},m(n,i){N(n,e,i),t||(l=Z(e,"click",ae(r[14])),t=!0)},p(n,i){i&1&&a!==(a=n[0].note.id)&&s(e,"data-object",a)},d(n){n&&_(e),t=!1,l()}}}function Kt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-activity":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat selected svelte-8a7ih0"),s(e,"data-object",a=r[0].note.id),s(e,"data-activity",t=r[0].note.ephemeralAnnounced)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(r[13])),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a),o&1&&t!==(t=i[0].note.ephemeralAnnounced)&&s(e,"data-activity",t)},d(i){i&&_(e),l=!1,n()}}}function qt(r){let e,a,t,l,n;return{c(){e=b("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star svelte-8a7ih0"),s(e,"data-actor",a=r[0].note.attributedTo),s(e,"data-object",t=r[0].note.id)},m(i,o){N(i,e,o),l||(n=Z(e,"click",ae(r[12])),l=!0)},p(i,o){o&1&&a!==(a=i[0].note.attributedTo)&&s(e,"data-actor",a),o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t)},d(i){i&&_(e),l=!1,n()}}}function Ft(r){let e,a,t,l,n,i;return{c(){e=b("i"),this.h()},l(o){e=k(o,"I",{class:!0,"data-actor":!0,"data-object":!0,"data-activity":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star selected svelte-8a7ih0"),s(e,"data-actor",a=r[0].note.attributedTo),s(e,"data-object",t=r[0].note.id),s(e,"data-activity",l=r[0].note.ephemeralLiked)},m(o,c){N(o,e,c),n||(i=Z(e,"click",ae(r[11])),n=!0)},p(o,c){c&1&&a!==(a=o[0].note.attributedTo)&&s(e,"data-actor",a),c&1&&t!==(t=o[0].note.id)&&s(e,"data-object",t),c&1&&l!==(l=o[0].note.ephemeralLiked)&&s(e,"data-activity",l)},d(o){o&&_(e),n=!1,i()}}}function ut(r){let e,a,t,l,n,i,o,c,u;return{c(){e=b("i"),this.h()},l(f){e=k(f,"I",{class:!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0}),w(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-reply svelte-8a7ih0"),s(e,"data-reply",a=r[0].note.id),s(e,"data-display",t=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",l=r[0].actor.url),s(e,"data-username",n=r[0].actor.preferredUsername),s(e,"data-recipient",i=r[0].actor.id),s(e,"data-conversation",o=r[0].note.conversation)},m(f,d){N(f,e,d),c||(u=Z(e,"click",r[16]),c=!0)},p(f,d){d&1&&a!==(a=f[0].note.id)&&s(e,"data-reply",a),d&1&&t!==(t=f[0].actor.name||f[0].actor.preferredUsername)&&s(e,"data-display",t),d&1&&l!==(l=f[0].actor.url)&&s(e,"data-url",l),d&1&&n!==(n=f[0].actor.preferredUsername)&&s(e,"data-username",n),d&1&&i!==(i=f[0].actor.id)&&s(e,"data-recipient",i),d&1&&o!==(o=f[0].note.conversation)&&s(e,"data-conversation",o)},d(f){f&&_(e),c=!1,u()}}}function dt(r){let e,a,t,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Yt,then:Xt,catch:Qt,value:21,blocks:[,,,]};return Pe(a=r[10]?.get_ap_id(),l),{c(){e=le(),l.block.c()},l(n){e=le(),l.block.l(n)},m(n,i){N(n,e,i),l.block.m(n,l.anchor=i),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(n,i){r=n,l.ctx=r,i&1024&&a!==(a=r[10]?.get_ap_id())&&Pe(a,l)||It(l,r,i)},i(n){t||(P(l.block),t=!0)},o(n){for(let i=0;i<3;i+=1){const o=l.blocks[i];Q(o)}t=!1},d(n){n&&_(e),l.block.d(n),l.token=null,l=null}}}function Qt(r){return{c:W,l:W,m:W,p:W,i:W,o:W,d:W}}function Xt(r){let e,a;return e=new Gt({props:{remove:r[6],refresh:r[5],object:r[0].note.id,owner:r[21]==r[0].note.attributedTo}}),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,l){Ee(e,t,l),a=!0},p(t,l){const n={};l&64&&(n.remove=t[6]),l&32&&(n.refresh=t[5]),l&1&&(n.object=t[0].note.id),l&1025&&(n.owner=t[21]==t[0].note.attributedTo),e.$set(n)},i(t){a||(P(e.$$.fragment,t),a=!0)},o(t){Q(e.$$.fragment,t),a=!1},d(t){Te(e,t)}}}function Yt(r){return{c:W,l:W,m:W,p:W,i:W,o:W,d:W}}function Zt(r){let e,a,t,l,n,i,o,c,u,f,d=re(r[10],r[0].note.content||"",r[0].note)+"",p,h,v,A,E,y,H,L,M,B=De(new Date(String(r[0].published)).getTime())+"",V,D,m,T,I,S,O,he,J=r[2]&&rt(r),K=r[3]&&it(r),q=r[0].actor&&r[0].actor.icon&&nt(r),F=r[0].actor&&st(r);const Ce=[Wt,zt],ie=[];function Ue(j,C){return j[0].note.attachment&&j[0].note.attachment.length>0?0:j[0].note.ephemeralMetadata&&j[0].note.ephemeralMetadata.length?1:-1}~(h=Ue(r))&&(v=ie[h]=Ce[h](r));let $=r[0].note.ephemeralLikes?.length&&ot(r),x=r[0].replies?.size&&ct(r),G=r[1]&&ft(r);return{c(){e=b("article"),J&&J.c(),a=U(),K&&K.c(),t=U(),l=b("header"),n=b("div"),q&&q.c(),i=U(),o=b("address"),F&&F.c(),c=U(),u=b("section"),f=new de(!1),p=U(),v&&v.c(),A=U(),E=b("div"),$&&$.c(),y=U(),x&&x.c(),H=U(),L=b("time"),M=b("a"),V=X(B),T=U(),G&&G.c(),this.h()},l(j){e=k(j,"ARTICLE",{"data-conversation":!0,id:!0,class:!0});var C=w(e);J&&J.l(C),a=R(C),K&&K.l(C),t=R(C),l=k(C,"HEADER",{class:!0});var ne=w(l);n=k(ne,"DIV",{class:!0});var Re=w(n);q&&q.l(Re),Re.forEach(_),i=R(ne),o=k(ne,"ADDRESS",{class:!0});var Ve=w(o);F&&F.l(Ve),Ve.forEach(_),ne.forEach(_),c=R(C),u=k(C,"SECTION",{class:!0});var Oe=w(u);f=_e(Oe,!1),Oe.forEach(_),p=R(C),v&&v.l(C),A=R(C),E=k(C,"DIV",{class:!0});var we=w(E);$&&$.l(we),y=R(we),x&&x.l(we),we.forEach(_),H=R(C),L=k(C,"TIME",{datetime:!0,class:!0});var Be=w(L);M=k(Be,"A",{href:!0,target:!0,rel:!0,class:!0});var He=w(M);V=Y(He,B),He.forEach(_),Be.forEach(_),T=R(C),G&&G.l(C),C.forEach(_),this.h()},h(){s(n,"class","svelte-8a7ih0"),s(o,"class","svelte-8a7ih0"),s(l,"class","svelte-8a7ih0"),f.a=null,s(u,"class","svelte-8a7ih0"),s(E,"class","activity svelte-8a7ih0"),s(M,"href",D=r[0].note.url),s(M,"target",r[7]),s(M,"rel",r[8]),s(M,"class","svelte-8a7ih0"),s(L,"datetime",m=r[0].published),s(L,"class","svelte-8a7ih0"),s(e,"data-conversation",I=r[0].note.conversation),s(e,"id",r[9]),s(e,"class","svelte-8a7ih0")},m(j,C){N(j,e,C),J&&J.m(e,null),g(e,a),K&&K.m(e,null),g(e,t),g(e,l),g(l,n),q&&q.m(n,null),g(l,i),g(l,o),F&&F.m(o,null),g(e,c),g(e,u),f.m(d,u),g(e,p),~h&&ie[h].m(e,null),g(e,A),g(e,E),$&&$.m(E,null),g(E,y),x&&x.m(E,null),g(e,H),g(e,L),g(L,M),g(M,V),g(e,T),G&&G.m(e,null),S=!0,O||(he=kt(r[4].call(null,e)),O=!0)},p(j,[C]){j[2]?J?J.p(j,C):(J=rt(j),J.c(),J.m(e,a)):J&&(J.d(1),J=null),j[3]?K?K.p(j,C):(K=it(j),K.c(),K.m(e,t)):K&&(K.d(1),K=null),j[0].actor&&j[0].actor.icon?q?q.p(j,C):(q=nt(j),q.c(),q.m(n,null)):q&&(q.d(1),q=null),j[0].actor?F?F.p(j,C):(F=st(j),F.c(),F.m(o,null)):F&&(F.d(1),F=null),(!S||C&1025)&&d!==(d=re(j[10],j[0].note.content||"",j[0].note)+"")&&f.p(d);let ne=h;h=Ue(j),h===ne?~h&&ie[h].p(j,C):(v&&(oe(),Q(ie[ne],1,1,()=>{ie[ne]=null}),ce()),~h?(v=ie[h],v?v.p(j,C):(v=ie[h]=Ce[h](j),v.c()),P(v,1),v.m(e,A)):v=null),j[0].note.ephemeralLikes?.length?$?$.p(j,C):($=ot(j),$.c(),$.m(E,y)):$&&($.d(1),$=null),j[0].replies?.size?x?x.p(j,C):(x=ct(j),x.c(),x.m(E,null)):x&&(x.d(1),x=null),(!S||C&1)&&B!==(B=De(new Date(String(j[0].published)).getTime())+"")&&te(V,B),(!S||C&1&&D!==(D=j[0].note.url))&&s(M,"href",D),(!S||C&128)&&s(M,"target",j[7]),(!S||C&256)&&s(M,"rel",j[8]),(!S||C&1&&m!==(m=j[0].published))&&s(L,"datetime",m),j[1]?G?(G.p(j,C),C&2&&P(G,1)):(G=ft(j),G.c(),P(G,1),G.m(e,null)):G&&(oe(),Q(G,1,1,()=>{G=null}),ce()),(!S||C&1&&I!==(I=j[0].note.conversation))&&s(e,"data-conversation",I),(!S||C&512)&&s(e,"id",j[9])},i(j){S||(P(v),P(G),S=!0)},o(j){Q(v),Q(G),S=!1},d(j){j&&_(e),J&&J.d(),K&&K.d(),q&&q.d(),F&&F.d(),~h&&ie[h].d(),$&&$.d(),x&&x.d(),G&&G.d(),O=!1,he()}}}function $t(r,e,a){let t,l,n;ue(r,Tt,m=>a(18,l=m)),ue(r,Ie,m=>a(17,n=m));const i=Le(),o=Le();ye(async()=>{t&&c&&c.note&&c.note.id&&a(9,D=t.get_url_safe_base64(c.note.id))});let{note:c}=e,{username:u}=e,{replyToHeader:f}=e,{announceHeader:d}=e,{renderAction:p}=e,{refresh:h}=e,{remove:v}=e;function A(m){const T=String(m.target.dataset.object),I=String(m.target.dataset.actor),S=String(m.target.dataset.activity);console.debug(`UNDOING ${S}`),t&&t.send_unlike(I,T,S).then(O=>{console.debug("UNLIKE SENT"),a(0,c.note.ephemeralLiked=null,c),a(0,c)})}function E(m){const T=String(m.target.dataset.object),I=String(m.target.dataset.actor);t&&t.send_like(I,T).then(S=>{console.debug(`LIKE SENT ${S}`),a(0,c.note.ephemeralLiked=S,c),a(0,c)})}function y(m){const T=String(m.target.dataset.object),I=String(m.target.dataset.activity);t&&T?t.send_unannounce(T,I).then(S=>{console.debug("UNANNOUNCE SENT"),a(0,c.note.ephemeralAnnounced=null,c),a(0,c)}):console.error("OBJECT INVALID")}function H(m){const T=String(m.target.dataset.object);t&&T?t.send_announce(T).then(I=>{console.debug(`ANNOUNCE SENT ${I}`),a(0,c.note.ephemeralAnnounced=I,c),a(0,c)}):console.error("OBJECT INVALID")}function L(m){console.log("DISPATCHING NOTE_SELECT"),console.log(m),o("noteSelect",{replyToConversation:m.target.dataset.conversation,replyToRecipient:m.target.dataset.recipient,replyToNote:m.target.dataset.note,replyToDisplay:re(t,m.target.dataset.display,c.actor),replyToUrl:m.target.dataset.url,replyToUsername:m.target.dataset.username,openAside:!1})}function M(m){i("replyTo",{replyToRecipient:m.target.dataset.recipient,replyToNote:m.target.dataset.reply,replyToDisplay:re(t,m.target.dataset.display,c.actor),replyToConversation:m.target.dataset.conversation,replyToUrl:m.target.dataset.url,replyToUsername:m.target.dataset.username,openAside:!0})}let B=null,V=null;c&&c.note&&c.note.url&&!Et(l.url.toString(),c.note.url)&&(B="_blank",V="noreferrer");let D="";return r.$$set=m=>{"note"in m&&a(0,c=m.note),"username"in m&&a(1,u=m.username),"replyToHeader"in m&&a(2,f=m.replyToHeader),"announceHeader"in m&&a(3,d=m.announceHeader),"renderAction"in m&&a(4,p=m.renderAction),"refresh"in m&&a(5,h=m.refresh),"remove"in m&&a(6,v=m.remove)},r.$$.update=()=>{r.$$.dirty&131072&&a(10,t=n)},[c,u,f,d,p,h,v,B,V,D,t,A,E,y,H,L,M,n]}class sa extends ve{constructor(e){super(),ge(this,e,$t,Zt,pe,{note:0,username:1,replyToHeader:2,announceHeader:3,renderAction:4,refresh:5,remove:6})}}export{sa as A,Vt as R,Pe as h,It as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index.aMiLl7Je.js","./_commonjsHelpers.5-cIlDoe.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}