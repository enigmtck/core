function c(e){return e?.length!==void 0?e:Array.from(e)}class u{constructor(r,t,s,n){this.note=t,this.activity=s,this.actor=r,t.published?this.published=String(t.published):t.ephemeral?.timestamp?this.published=t.ephemeral.timestamp:this.published=new Date().toISOString(),t.ephemeral?.timestamp?this.created_at=t.ephemeral.timestamp:this.created_at=new Date().toISOString(),this.replies=n||new Map,this.public=this.isPublic()}jsonTo(){let r=[];return this.note.to&&(Array.isArray(this.note.to)?r.push(...this.note.to):r.push(this.note.to)),this.note.cc&&(Array.isArray(this.note.cc)?r.push(...this.note.cc):r.push(this.note.cc)),JSON.stringify(r)}jsonSender(){return JSON.stringify(this.actor)}isPublic(){const r=["https://www.w3.org/ns/activitystreams#Public","as:Public","Public"];let t=[];return this.note.to&&(Array.isArray(this.note.to)?t.push(...this.note.to):t.push(this.note.to)),this.note.cc&&(Array.isArray(this.note.cc)?t.push(...this.note.cc):t.push(this.note.cc)),t.some(s=>r.includes(s))}}const o=e=>typeof e=="object"&&e!==null;function l(e){const r=["","k","M","B","T"];let t=0;for(;e>=1e3&&t<r.length-1;)e/=1e3,t++;return t===0?Math.floor(e).toString():e.toFixed(1)+r[t]}function h(e){if(typeof e=="string")return e;if(Array.isArray(e))return e[0]}const p=(e,r)=>{try{const t=new URL(e);let s=t.pathname.slice(1);const n=t.hostname;return s=s.endsWith("/")?s.slice(0,-1):s,s.startsWith("@")?r?`${s}`:`${s}@${n}`:null}catch(t){return console.error("Error parsing URL:",t),null}};function f(e){return new Promise(r=>setTimeout(r,e))}function m(e){const r=/^https:\/\/([a-zA-Z0-9\-.]+?)\/[A-Za-z0-9/\-._]+$/;if(e.id){const t=e.id.match(r);if(t)return`@${e.preferredUsername}@${t[1]}`}return String(e.url)}function d(e,r,t){if(e&&t.tag){let s=[];Array.isArray(t.tag)?s=[...t.tag]:s.push(t.tag),s.forEach(n=>{n.type==="Emoji"&&n.icon&&r&&(r=r.replaceAll(n.name,`<img class="emoji" src="${i(e,n.icon.url)}"/>`))})}return r}function g(e,r){return Date.parse(e.created_at)<Date.parse(r.created_at)?-1:Date.parse(e.created_at)>Date.parse(r.created_at)?1:0}function y(e){const r=new URL(e),t=r.searchParams.get("max"),s=r.searchParams.get("min");return t?{value:t,type:"max"}:s?{value:s,type:"min"}:{value:null,type:null}}function b(e){const r=/https:\/\/(?:[a-zA-Z0-9.-]+)(?:\.[a-zA-Z0-9.-]+)+\/(?:notes|conversation)\/([a-zA-Z0-9-]+)/,t=e.match(r);return t&&t[1]?t[1]:null}function A(e,r){const t=/(https:\/\/(?:[a-zA-Z0-9.-]+)(?:\.[a-zA-Z0-9.-]+)+)\/.*/,s=e.match(t),n=r.match(t);return s!==null&&n!==null&&s[1]==n[1]}function i(e,r){return e?"/api/cache?url="+e.get_url_safe_base64(r):r}function a(e){return e.instrument&&e.instrument.find(t=>t.type==="VaultItem")||null}const v=(e,r)=>{if(r?.object.type=="EncryptedNote"){let t;return e&&(t=a(r))?e.decrypt_text(t.content)||"":'<span class"failure">Message could not be decrypted</span>'}else return r?.object.content||""},S=e=>e?e.replace(/<[^>]*>/g," "):"";export{u as D,o as a,y as b,g as c,p as d,c as e,i as f,h as g,m as h,d as i,l as j,b as k,v as l,A as m,S as r,f as s};
