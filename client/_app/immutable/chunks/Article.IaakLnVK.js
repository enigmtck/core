import{P as mt,Q as pt,R as Se,H as vt,s as pe,f as g,g as k,h as I,d as _,j as s,i as N,G as W,w as ue,o as De,e as ae,I as dt,a as R,c as O,F as le,v,K as de,l as X,L as _e,m as Y,n as ee,S as ye,D as x,E as te,u as Ae,p as bt,T as gt}from"./scheduler.tnyNm5U0.js";import{g as oe,t as Q,c as ce,a as M,S as ve,i as be,b as ge,d as ke,m as Ee,e as Te}from"./index.R_ElRwcJ.js";import{e as je}from"./each.-oqiv04n.js";import"./paths.bRF-GyMQ.js";import{a as se,i as re,t as Ne,g as fe,c as He,d as kt}from"./common.DsDv12mj.js";import{e as we}from"./stores.bABpd-zC.js";import{p as Et}from"./stores.4RI7Y1qb.js";import{_ as _t}from"./preload-helper.0HuHagjb.js";function Pe(r,e){const t=e.token={};function a(l,n,i,o){if(e.token!==t)return;e.resolved=o;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=o);const f=l&&(e.current=l)(c);let u=!1;e.block&&(e.blocks?e.blocks.forEach((d,b)=>{b!==n&&d&&(oe(),Q(d,1,1,()=>{e.blocks[b]===d&&(e.blocks[b]=null)}),ce())}):e.block.d(1),f.c(),M(f,1),f.m(e.mount(),e.anchor),u=!0),e.block=f,e.blocks&&(e.blocks[n]=f),u&&vt()}if(mt(r)){const l=pt();if(r.then(n=>{Se(l),a(e.then,1,e.value,n),Se(null)},n=>{if(Se(l),a(e.catch,2,e.error,n),Se(null),!e.hasCatch)throw n}),e.current!==e.pending)return a(e.pending,0),!0}else{if(e.current!==e.then)return a(e.then,1,e.value,r),!0;e.resolved=r}}function Tt(r,e,t){const a=e.slice(),{resolved:l}=r;r.current===r.then&&(a[r.value]=l),r.current===r.catch&&(a[r.error]=l),r.block.p(a,t)}function me(r){let e=r.replies.size;return r.replies.size>0&&r.replies.forEach(t=>{e+=me(t)}),e}function Me(r,e,t){const a=r.slice();return a[6]=e[t],a}function ze(r){let e,t=je(r[0].attachment),a=[];for(let l=0;l<t.length;l+=1)a[l]=Ge(Me(r,t,l));return{c(){for(let l=0;l<a.length;l+=1)a[l].c();e=ae()},l(l){for(let n=0;n<a.length;n+=1)a[n].l(l);e=ae()},m(l,n){for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(l,n);N(l,e,n)},p(l,n){if(n&7){t=je(l[0].attachment);let i;for(i=0;i<t.length;i+=1){const o=Me(l,t,i);a[i]?a[i].p(o,n):(a[i]=Ge(o),a[i].c(),a[i].m(e.parentNode,e))}for(;i<a.length;i+=1)a[i].d(1);a.length=t.length}},d(l){l&&_(e),dt(a,l)}}}function wt(r){let e,t,a,l,n,i,o,c;return{c(){e=g("div"),t=g("video"),a=g("source"),c=R(),this.h()},l(f){e=k(f,"DIV",{class:!0,tabindex:!0});var u=I(e);t=k(u,"VIDEO",{width:!0,height:!0});var d=I(t);a=k(d,"SOURCE",{src:!0,type:!0}),d.forEach(_),c=O(u),u.forEach(_),this.h()},h(){le(a.src,l=se(r[1],window.Buffer,String(r[6].url)))||s(a,"src",l),s(a,"type",n=r[6].mediaType),s(t,"width",i=r[6].width),s(t,"height",o=r[6].height),t.controls=!0,s(e,"class",r[2].getPlacement()),s(e,"tabindex","0")},m(f,u){N(f,e,u),v(e,t),v(t,a),v(e,c)},p(f,u){u&3&&!le(a.src,l=se(f[1],window.Buffer,String(f[6].url)))&&s(a,"src",l),u&1&&n!==(n=f[6].mediaType)&&s(a,"type",n),u&1&&i!==(i=f[6].width)&&s(t,"width",i),u&1&&o!==(o=f[6].height)&&s(t,"height",o)},d(f){f&&_(e)}}}function It(r){let e,t,a,l,n,i,o;return{c(){e=g("div"),t=g("img"),o=R(),this.h()},l(c){e=k(c,"DIV",{class:!0,tabindex:!0});var f=I(e);t=k(f,"IMG",{src:!0,width:!0,height:!0,alt:!0}),o=O(f),f.forEach(_),this.h()},h(){le(t.src,a=se(r[1],window.Buffer,String(r[6].url)))||s(t,"src",a),s(t,"width",l=r[6].width),s(t,"height",n=r[6].height),s(t,"alt",i=r[6].name),s(e,"class",r[2].getPlacement()),s(e,"tabindex","0")},m(c,f){N(c,e,f),v(e,t),v(e,o)},p(c,f){f&3&&!le(t.src,a=se(c[1],window.Buffer,String(c[6].url)))&&s(t,"src",a),f&1&&l!==(l=c[6].width)&&s(t,"width",l),f&1&&n!==(n=c[6].height)&&s(t,"height",n),f&1&&i!==(i=c[6].name)&&s(t,"alt",i)},d(c){c&&_(e)}}}function Ge(r){let e,t,a;function l(o,c){if(c&1&&(e=null),c&1&&(t=null),e==null&&(e=!!(o[6].type=="Document"&&/^(?:image)\/.+$/.test(String(o[6].mediaType)))),e)return It;if(t==null&&(t=!!(o[6].type=="Document"&&/^(?:video)\/.+$/.test(String(o[6].mediaType)))),t)return wt}let n=l(r,-1),i=n&&n(r);return{c(){i&&i.c(),a=ae()},l(o){i&&i.l(o),a=ae()},m(o,c){i&&i.m(o,c),N(o,a,c)},p(o,c){n===(n=l(o,c))&&i?i.p(o,c):(i&&i.d(1),i=n&&n(o),i&&(i.c(),i.m(a.parentNode,a)))},d(o){o&&_(a),i&&i.d(o)}}}function St(r){let e,t=r[0].attachment&&ze(r);return{c(){e=g("section"),t&&t.c(),this.h()},l(a){e=k(a,"SECTION",{class:!0});var l=I(e);t&&t.l(l),l.forEach(_),this.h()},h(){s(e,"class","svelte-1vvyzpr")},m(a,l){N(a,e,l),t&&t.m(e,null)},p(a,[l]){a[0].attachment?t?t.p(a,l):(t=ze(a),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:W,o:W,d(a){a&&_(e),t&&t.d()}}}function At(r,e,t){let a,l;ue(r,we,c=>t(3,l=c));let{note:n}=e;De(async()=>{const{Buffer:c}=await _t(()=>import("./index.aMiLl7Je.js").then(f=>f.i),__vite__mapDeps([0,1]),import.meta.url);window.Buffer=c});class i{constructor(f){i.total=f}static{this.total=0}static{this.iteration=0}getPlacement(){return i.iteration++,i.total%2===0||i.total>=3&&i.iteration!==1?"half":"full"}}let o=new i(n.attachment?.length||0);return n.attachment?.length,r.$$set=c=>{"note"in c&&t(0,n=c.note)},r.$$.update=()=>{r.$$.dirty&8&&t(1,a=l)},[n,a,o,l]}class ht extends ve{constructor(e){super(),be(this,e,At,St,pe,{note:0})}}function We(r,e,t){const a=r.slice();return a[12]=e[t],a}function Je(r){let e,t;return{c(){e=g("img"),this.h()},l(a){e=k(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){le(e.src,t=r[0].actor.icon.url)||s(e,"src",t),s(e,"alt","Sender"),s(e,"class","svelte-iote2n")},m(a,l){N(a,e,l)},p(a,l){l&1&&!le(e.src,t=a[0].actor.icon.url)&&s(e,"src",t)},d(a){a&&_(e)}}}function Ke(r){let e,t,a=re(r[2],r[0].actor.name||r[0].actor.preferredUsername,r[0].actor)+"",l,n,i=fe(r[0].actor)+"",o,c;return{c(){e=g("a"),t=new de(!1),l=X(` •
				`),n=g("span"),o=X(i),this.h()},l(f){e=k(f,"A",{href:!0,class:!0});var u=I(e);t=_e(u,!1),l=Y(u,` •
				`),n=k(u,"SPAN",{class:!0});var d=I(n);o=Y(d,i),d.forEach(_),u.forEach(_),this.h()},h(){t.a=l,s(n,"class","url svelte-iote2n"),s(e,"href",c="/search?actor="+r[0].actor.id),s(e,"class","svelte-iote2n")},m(f,u){N(f,e,u),t.m(a,e),v(e,l),v(e,n),v(n,o)},p(f,u){u&5&&a!==(a=re(f[2],f[0].actor.name||f[0].actor.preferredUsername,f[0].actor)+"")&&t.p(a),u&1&&i!==(i=fe(f[0].actor)+"")&&ee(o,i),u&1&&c!==(c="/search?actor="+f[0].actor.id)&&s(e,"href",c)},d(f){f&&_(e)}}}function qe(r){let e,t;return e=new ht({props:{note:r[0].note}}),{c(){ge(e.$$.fragment)},l(a){ke(e.$$.fragment,a)},m(a,l){Ee(e,a,l),t=!0},p(a,l){const n={};l&1&&(n.note=a[0].note),e.$set(n)},i(a){t||(M(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){Te(e,a)}}}function Fe(r){let e,t,a,l=me(r[0])+"",n,i,o;return{c(){e=g("span"),t=g("i"),a=R(),n=X(l),this.h()},l(c){e=k(c,"SPAN",{class:!0,"data-conversation":!0,"data-note":!0});var f=I(e);t=k(f,"I",{class:!0}),I(t).forEach(_),a=O(f),n=Y(f,l),f.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-comments svelte-iote2n"),s(e,"class","comments svelte-iote2n"),s(e,"data-conversation",i=r[0].note.conversation),s(e,"data-note",o=r[0].note.id)},m(c,f){N(c,e,f),v(e,t),v(e,a),v(e,n)},p(c,f){f&1&&l!==(l=me(c[0])+"")&&ee(n,l),f&1&&i!==(i=c[0].note.conversation)&&s(e,"data-conversation",i),f&1&&o!==(o=c[0].note.id)&&s(e,"data-note",o)},d(c){c&&_(e)}}}function Qe(r){let e,t,a;function l(d,b){return d[0].note.ephemeralAnnounced?Nt:jt}let n=l(r),i=n(r);function o(d,b){return d[0].note.ephemeralLiked?yt:Dt}let c=o(r),f=c(r),u=r[0].actor&&Xe(r);return{c(){e=g("nav"),i.c(),t=R(),f.c(),a=R(),u&&u.c(),this.h()},l(d){e=k(d,"NAV",{class:!0});var b=I(e);i.l(b),t=O(b),f.l(b),a=O(b),u&&u.l(b),b.forEach(_),this.h()},h(){s(e,"class","svelte-iote2n")},m(d,b){N(d,e,b),i.m(e,null),v(e,t),f.m(e,null),v(e,a),u&&u.m(e,null)},p(d,b){n===(n=l(d))&&i?i.p(d,b):(i.d(1),i=n(d),i&&(i.c(),i.m(e,t))),c===(c=o(d))&&f?f.p(d,b):(f.d(1),f=c(d),f&&(f.c(),f.m(e,a))),d[0].actor?u?u.p(d,b):(u=Xe(d),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},d(d){d&&_(e),i.d(),f.d(),u&&u.d()}}}function jt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-actor":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat svelte-iote2n"),s(e,"data-object",t=r[0].note.id),s(e,"data-actor",a=r[0].note.attributedTo)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(r[3])),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t),o&1&&a!==(a=i[0].note.attributedTo)&&s(e,"data-actor",a)},d(i){i&&_(e),l=!1,n()}}}function Nt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-actor":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat selected svelte-iote2n"),s(e,"data-object",t=r[0].note.id),s(e,"data-actor",a=r[0].note.attributedTo)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(r[3])),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t),o&1&&a!==(a=i[0].note.attributedTo)&&s(e,"data-actor",a)},d(i){i&&_(e),l=!1,n()}}}function Dt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star svelte-iote2n"),s(e,"data-actor",t=r[0].note.attributedTo),s(e,"data-object",a=r[0].note.id)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(r[4])),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.attributedTo)&&s(e,"data-actor",t),o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a)},d(i){i&&_(e),l=!1,n()}}}function yt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star selected svelte-iote2n"),s(e,"data-actor",t=r[0].note.attributedTo),s(e,"data-object",a=r[0].note.id)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(Ut)),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.attributedTo)&&s(e,"data-actor",t),o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a)},d(i){i&&_(e),l=!1,n()}}}function Xe(r){let e,t,a,l,n,i,o,c,f;return{c(){e=g("i"),this.h()},l(u){e=k(u,"I",{class:!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-reply svelte-iote2n"),s(e,"data-reply",t=r[0].note.id),s(e,"data-display",a=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",l=r[0].actor.url),s(e,"data-username",n=r[0].actor.preferredUsername),s(e,"data-recipient",i=r[0].actor.id),s(e,"data-conversation",o=r[0].note.conversation)},m(u,d){N(u,e,d),c||(f=x(e,"click",r[7]),c=!0)},p(u,d){d&1&&t!==(t=u[0].note.id)&&s(e,"data-reply",t),d&1&&a!==(a=u[0].actor.name||u[0].actor.preferredUsername)&&s(e,"data-display",a),d&1&&l!==(l=u[0].actor.url)&&s(e,"data-url",l),d&1&&n!==(n=u[0].actor.preferredUsername)&&s(e,"data-username",n),d&1&&i!==(i=u[0].actor.id)&&s(e,"data-recipient",i),d&1&&o!==(o=u[0].note.conversation)&&s(e,"data-conversation",o)},d(u){u&&_(e),c=!1,f()}}}function Ye(r){let e,t,a=je(Array.from(r[0].replies.values()).sort(He)),l=[];for(let i=0;i<a.length;i+=1)l[i]=Ze(We(r,a,i));const n=i=>Q(l[i],1,1,()=>{l[i]=null});return{c(){e=g("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=k(i,"DIV",{class:!0});var o=I(e);for(let c=0;c<l.length;c+=1)l[c].l(o);o.forEach(_),this.h()},h(){s(e,"class","replies svelte-iote2n")},m(i,o){N(i,e,o);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);t=!0},p(i,o){if(o&99){a=je(Array.from(i[0].replies.values()).sort(He));let c;for(c=0;c<a.length;c+=1){const f=We(i,a,c);l[c]?(l[c].p(f,o),M(l[c],1)):(l[c]=Ze(f),l[c].c(),M(l[c],1),l[c].m(e,null))}for(oe(),c=a.length;c<l.length;c+=1)n(c);ce()}},i(i){if(!t){for(let o=0;o<a.length;o+=1)M(l[o]);t=!0}},o(i){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)Q(l[o]);t=!1},d(i){i&&_(e),dt(l,i)}}}function Ze(r){let e,t;return e=new Rt({props:{note:r[12],username:r[1]}}),e.$on("reply_to",r[6]),e.$on("note_select",r[5]),{c(){ge(e.$$.fragment)},l(a){ke(e.$$.fragment,a)},m(a,l){Ee(e,a,l),t=!0},p(a,l){const n={};l&1&&(n.note=a[12]),l&2&&(n.username=a[1]),e.$set(n)},i(a){t||(M(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){Te(e,a)}}}function Lt(r){let e,t,a,l,n,i,o,c,f=re(r[2],r[0].note.content||"",r[0].note)+"",u,d,b,h,p=Ne(new Date(String(r[0].published)).getTime())+"",S,D,V,H,y,P,B=r[0].actor&&r[0].actor.icon&&Je(r),U=r[0].actor&&Ke(r),j=r[0].note.attachment&&r[0].note.attachment.length>0&&qe(r),m=r[0].replies?.size&&Fe(r),E=r[1]&&Qe(r),T=r[0].replies?.size&&Ye(r);return{c(){e=g("article"),t=g("div"),a=g("div"),B&&B.c(),l=R(),n=g("address"),U&&U.c(),i=R(),o=g("section"),c=new de(!1),u=R(),j&&j.c(),d=R(),m&&m.c(),b=R(),h=g("time"),S=X(p),V=R(),E&&E.c(),H=R(),T&&T.c(),y=ae(),this.h()},l(w){e=k(w,"ARTICLE",{class:!0});var C=I(e);t=k(C,"DIV",{class:!0});var he=I(t);a=k(he,"DIV",{});var J=I(a);B&&B.l(J),J.forEach(_),he.forEach(_),l=O(C),n=k(C,"ADDRESS",{class:!0});var K=I(n);U&&U.l(K),K.forEach(_),i=O(C),o=k(C,"SECTION",{class:!0});var q=I(o);c=_e(q,!1),q.forEach(_),u=O(C),j&&j.l(C),d=O(C),m&&m.l(C),b=O(C),h=k(C,"TIME",{datetime:!0,class:!0});var F=I(h);S=Y(F,p),F.forEach(_),V=O(C),E&&E.l(C),C.forEach(_),H=O(w),T&&T.l(w),y=ae(),this.h()},h(){s(t,"class","avatar svelte-iote2n"),s(n,"class","svelte-iote2n"),c.a=null,s(o,"class","svelte-iote2n"),s(h,"datetime",D=r[0].published),s(h,"class","svelte-iote2n"),s(e,"class","svelte-iote2n")},m(w,C){N(w,e,C),v(e,t),v(t,a),B&&B.m(a,null),v(e,l),v(e,n),U&&U.m(n,null),v(e,i),v(e,o),c.m(f,o),v(e,u),j&&j.m(e,null),v(e,d),m&&m.m(e,null),v(e,b),v(e,h),v(h,S),v(e,V),E&&E.m(e,null),N(w,H,C),T&&T.m(w,C),N(w,y,C),P=!0},p(w,[C]){w[0].actor&&w[0].actor.icon?B?B.p(w,C):(B=Je(w),B.c(),B.m(a,null)):B&&(B.d(1),B=null),w[0].actor?U?U.p(w,C):(U=Ke(w),U.c(),U.m(n,null)):U&&(U.d(1),U=null),(!P||C&5)&&f!==(f=re(w[2],w[0].note.content||"",w[0].note)+"")&&c.p(f),w[0].note.attachment&&w[0].note.attachment.length>0?j?(j.p(w,C),C&1&&M(j,1)):(j=qe(w),j.c(),M(j,1),j.m(e,d)):j&&(oe(),Q(j,1,1,()=>{j=null}),ce()),w[0].replies?.size?m?m.p(w,C):(m=Fe(w),m.c(),m.m(e,b)):m&&(m.d(1),m=null),(!P||C&1)&&p!==(p=Ne(new Date(String(w[0].published)).getTime())+"")&&ee(S,p),(!P||C&1&&D!==(D=w[0].published))&&s(h,"datetime",D),w[1]?E?E.p(w,C):(E=Qe(w),E.c(),E.m(e,null)):E&&(E.d(1),E=null),w[0].replies?.size?T?(T.p(w,C),C&1&&M(T,1)):(T=Ye(w),T.c(),M(T,1),T.m(y.parentNode,y)):T&&(oe(),Q(T,1,1,()=>{T=null}),ce())},i(w){P||(M(j),M(T),P=!0)},o(w){Q(j),Q(T),P=!1},d(w){w&&(_(e),_(H),_(y)),B&&B.d(),U&&U.d(),j&&j.d(),m&&m.d(),E&&E.d(),T&&T.d(w)}}}function Ut(r){String(r.target.dataset.object),String(r.target.dataset.actor)}function Ct(r,e,t){let a,l;ue(r,we,h=>t(8,l=h));const n=ye();let{note:i}=e,{username:o}=e;function c(h){console.debug("HANDLING DISPATCHED ANNOUNCE");const p=String(h.target.dataset.object),S=String(h.target.dataset.actor);a&&p&&S?h.target.classList.add("selected"):(console.error("OBJECT OR ACTOR INVALID"),console.debug(`OBJECT: ${p}, ACTOR: ${S}`))}function f(h){console.debug("HANDLING DISPATCHED LIKE");const p=String(h.target.dataset.object),S=String(h.target.dataset.actor);a&&a.send_like(S,p).then(()=>{})}function u(h){n("note_select",h.detail)}function d(h){n("reply_to",h.detail)}function b(h){n("reply_to",{reply_to_recipient:h.target.dataset.recipient,reply_to_note:h.target.dataset.reply,reply_to_display:h.target.dataset.display,reply_to_conversation:h.target.dataset.conversation,reply_to_url:h.target.dataset.url,reply_to_username:h.target.dataset.username})}return r.$$set=h=>{"note"in h&&t(0,i=h.note),"username"in h&&t(1,o=h.username)},r.$$.update=()=>{r.$$.dirty&256&&t(2,a=l)},[i,o,a,c,f,u,d,b,l]}class Rt extends ve{constructor(e){super(),be(this,e,Ct,Lt,pe,{note:0,username:1})}}function $e(r){let e,t,a,l,n,i=r[0][G].ogTitle+"",o,c,f,u,d=r[0][G].ogImage?.length&&xe(r),b=r[0][G].ogDescription&&et(r),h=r[0][G].ogSiteName&&tt(r);return{c(){e=g("a"),t=g("div"),d&&d.c(),a=R(),l=g("div"),n=g("span"),o=X(i),c=R(),b&&b.c(),f=R(),h&&h.c(),this.h()},l(p){e=k(p,"A",{href:!0,target:!0,rel:!0,class:!0});var S=I(e);t=k(S,"DIV",{class:!0});var D=I(t);d&&d.l(D),a=O(D),l=k(D,"DIV",{class:!0});var V=I(l);n=k(V,"SPAN",{class:!0});var H=I(n);o=Y(H,i),H.forEach(_),c=O(V),b&&b.l(V),f=O(V),h&&h.l(V),V.forEach(_),D.forEach(_),S.forEach(_),this.h()},h(){s(n,"class","svelte-9o0bks"),s(l,"class","svelte-9o0bks"),s(t,"class","svelte-9o0bks"),s(e,"href",u=r[0][G].ogUrl),s(e,"target","_blank"),s(e,"rel","noreferrer"),s(e,"class","svelte-9o0bks")},m(p,S){N(p,e,S),v(e,t),d&&d.m(t,null),v(t,a),v(t,l),v(l,n),v(n,o),v(l,c),b&&b.m(l,null),v(l,f),h&&h.m(l,null)},p(p,S){p[0][G].ogImage?.length?d?d.p(p,S):(d=xe(p),d.c(),d.m(t,a)):d&&(d.d(1),d=null),S&1&&i!==(i=p[0][G].ogTitle+"")&&ee(o,i),p[0][G].ogDescription?b?b.p(p,S):(b=et(p),b.c(),b.m(l,f)):b&&(b.d(1),b=null),p[0][G].ogSiteName?h?h.p(p,S):(h=tt(p),h.c(),h.m(l,null)):h&&(h.d(1),h=null),S&1&&u!==(u=p[0][G].ogUrl)&&s(e,"href",u)},d(p){p&&_(e),d&&d.d(),b&&b.d(),h&&h.d()}}}function xe(r){let e,t,a,l,n;return{c(){e=g("div"),t=g("img"),this.h()},l(i){e=k(i,"DIV",{class:!0});var o=I(e);t=k(o,"IMG",{src:!0,alt:!0,class:!0}),o.forEach(_),this.h()},h(){le(t.src,a=se(r[1],window.Buffer,String(r[0][G].ogImage)))||s(t,"src",a),s(t,"alt","Link Preview"),s(t,"class","svelte-9o0bks"),s(e,"class","image svelte-9o0bks")},m(i,o){N(i,e,o),v(e,t),l||(n=x(t,"error",r[2]),l=!0)},p(i,o){o&3&&!le(t.src,a=se(i[1],window.Buffer,String(i[0][G].ogImage)))&&s(t,"src",a)},d(i){i&&_(e),l=!1,n()}}}function et(r){let e,t=r[0][G].ogDescription+"",a;return{c(){e=g("span"),a=X(t),this.h()},l(l){e=k(l,"SPAN",{class:!0});var n=I(e);a=Y(n,t),n.forEach(_),this.h()},h(){s(e,"class","svelte-9o0bks")},m(l,n){N(l,e,n),v(e,a)},p(l,n){n&1&&t!==(t=l[0][G].ogDescription+"")&&ee(a,t)},d(l){l&&_(e)}}}function tt(r){let e,t=r[0][G].ogSiteName+"",a;return{c(){e=g("span"),a=X(t),this.h()},l(l){e=k(l,"SPAN",{class:!0});var n=I(e);a=Y(n,t),n.forEach(_),this.h()},h(){s(e,"class","svelte-9o0bks")},m(l,n){N(l,e,n),v(e,a)},p(l,n){n&1&&t!==(t=l[0][G].ogSiteName+"")&&ee(a,t)},d(l){l&&_(e)}}}function Ot(r){let e,t=r[0][G].ogUrl&&r[0][G].ogTitle&&$e(r);return{c(){t&&t.c(),e=ae()},l(a){t&&t.l(a),e=ae()},m(a,l){t&&t.m(a,l),N(a,e,l)},p(a,[l]){a[0][G].ogUrl&&a[0][G].ogTitle?t?t.p(a,l):(t=$e(a),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:W,o:W,d(a){a&&_(e),t&&t.d(a)}}}let G=0;function Vt(r,e,t){let a,l;ue(r,we,o=>t(3,l=o));let{links:n}=e;De(async()=>{const{Buffer:o}=await _t(()=>import("./index.aMiLl7Je.js").then(c=>c.i),__vite__mapDeps([0,1]),import.meta.url);window.Buffer=o});const i=o=>{console.log(o.target);let c=o.target;c&&(c.style.display="none")};return r.$$set=o=>{"links"in o&&t(0,n=o.links)},r.$$.update=()=>{r.$$.dirty&8&&t(1,a=l)},[n,a,i,l]}class Bt extends ve{constructor(e){super(),be(this,e,Vt,Ot,pe,{links:0})}}function at(r){let e,t,a,l,n="Edit",i,o;return{c(){e=g("li"),t=X("Delete"),a=R(),l=g("li"),l.textContent=n,this.h()},l(c){e=k(c,"LI",{"data-object":!0,class:!0});var f=I(e);t=Y(f,"Delete"),f.forEach(_),a=O(c),l=k(c,"LI",{class:!0,"data-svelte-h":!0}),Ae(l)!=="svelte-nqb85c"&&(l.textContent=n),this.h()},h(){s(e,"data-object",r[0]),s(e,"class","svelte-1v3blo6"),s(l,"class","svelte-1v3blo6")},m(c,f){N(c,e,f),v(e,t),N(c,a,f),N(c,l,f),i||(o=x(e,"click",te(r[4])),i=!0)},p(c,f){f&1&&s(e,"data-object",c[0])},d(c){c&&(_(e),_(a),_(l)),i=!1,o()}}}function Ht(r){let e,t,a,l,n,i,o="Mute Author",c,f,u="Block Author",d,b,h="Block Instance",p,S,D=r[1]&&at(r);return{c(){e=g("i"),t=R(),a=g("dialog"),l=g("ul"),D&&D.c(),n=R(),i=g("li"),i.textContent=o,c=R(),f=g("li"),f.textContent=u,d=R(),b=g("li"),b.textContent=h,this.h()},l(V){e=k(V,"I",{class:!0,"data-object":!0}),I(e).forEach(_),t=O(V),a=k(V,"DIALOG",{class:!0});var H=I(a);l=k(H,"UL",{class:!0});var y=I(l);D&&D.l(y),n=O(y),i=k(y,"LI",{class:!0,"data-svelte-h":!0}),Ae(i)!=="svelte-cedbu2"&&(i.textContent=o),c=O(y),f=k(y,"LI",{class:!0,"data-svelte-h":!0}),Ae(f)!=="svelte-1gvp02o"&&(f.textContent=u),d=O(y),b=k(y,"LI",{class:!0,"data-svelte-h":!0}),Ae(b)!=="svelte-5kz5l4"&&(b.textContent=h),y.forEach(_),H.forEach(_),this.h()},h(){s(e,"class","fa-solid fa-ellipsis svelte-1v3blo6"),s(e,"data-object",r[0]),s(i,"class","svelte-1v3blo6"),s(f,"class","svelte-1v3blo6"),s(b,"class","svelte-1v3blo6"),s(l,"class","svelte-1v3blo6"),s(a,"class","svelte-1v3blo6")},m(V,H){N(V,e,H),N(V,t,H),N(V,a,H),v(a,l),D&&D.m(l,null),v(l,n),v(l,i),v(l,c),v(l,f),v(l,d),v(l,b),r[8](a),p||(S=x(e,"click",r[3]),p=!0)},p(V,[H]){H&1&&s(e,"data-object",V[0]),V[1]?D?D.p(V,H):(D=at(V),D.c(),D.m(l,n)):D&&(D.d(1),D=null)},i:W,o:W,d(V){V&&(_(e),_(t),_(a)),D&&D.d(),r[8](null),p=!1,S()}}}function Pt(r,e,t){let a,l;ue(r,we,h=>t(7,l=h));let{object:n}=e,{owner:i}=e,{refresh:o}=e,{remove:c}=e;De(async()=>{});function f(h){console.log("HANDLE MENU ACTIVATED"),d.open?d.close():d.show()}function u(h){console.log("HANDLE DELETE ACTIVATED");const p=h.target.dataset.object;a?.send_delete(p).then(S=>{S&&(console.info("DELETE SENT"),c(p))})}let d;function b(h){bt[h?"unshift":"push"](()=>{d=h,t(2,d)})}return r.$$set=h=>{"object"in h&&t(0,n=h.object),"owner"in h&&t(1,i=h.owner),"refresh"in h&&t(5,o=h.refresh),"remove"in h&&t(6,c=h.remove)},r.$$.update=()=>{r.$$.dirty&128&&(a=l)},[n,i,d,f,u,o,c,l,b]}class Mt extends ve{constructor(e){super(),be(this,e,Pt,Ht,pe,{object:0,owner:1,refresh:5,remove:6})}}function lt(r){let e,t,a,l,n,i,o,c;return{c(){e=g("span"),t=g("i"),a=X(` In
			`),l=g("a"),n=X("reply"),o=X(`
			to `),c=new de(!1),this.h()},l(f){e=k(f,"SPAN",{class:!0});var u=I(e);t=k(u,"I",{class:!0}),I(t).forEach(_),a=Y(u,` In
			`),l=k(u,"A",{href:!0,target:!0,rel:!0,class:!0});var d=I(l);n=Y(d,"reply"),d.forEach(_),o=Y(u,`
			to `),c=_e(u,!1),u.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-reply svelte-8a7ih0"),s(l,"href",i=r[0].note.inReplyTo),s(l,"target","_blank"),s(l,"rel","noreferrer"),s(l,"class","svelte-8a7ih0"),c.a=null,s(e,"class","reply svelte-8a7ih0")},m(f,u){N(f,e,u),v(e,t),v(e,a),v(e,l),v(l,n),v(e,o),c.m(r[2],e)},p(f,u){u&1&&i!==(i=f[0].note.inReplyTo)&&s(l,"href",i),u&4&&c.p(f[2])},d(f){f&&_(e)}}}function rt(r){let e,t,a,l,n,i=r[3].name+"",o,c=r[3].others+"",f;return{c(){e=g("span"),t=g("i"),a=X(` Reposted by
			`),l=g("a"),n=new de(!1),f=X(c),this.h()},l(u){e=k(u,"SPAN",{class:!0});var d=I(e);t=k(d,"I",{class:!0}),I(t).forEach(_),a=Y(d,` Reposted by
			`),l=k(d,"A",{href:!0,class:!0});var b=I(l);n=_e(b,!1),b.forEach(_),f=Y(d,c),d.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-retweet svelte-8a7ih0"),n.a=null,s(l,"href",o=r[3].url),s(l,"class","svelte-8a7ih0"),s(e,"class","repost svelte-8a7ih0")},m(u,d){N(u,e,d),v(e,t),v(e,a),v(e,l),n.m(i,l),v(e,f)},p(u,d){d&8&&i!==(i=u[3].name+"")&&n.p(i),d&8&&o!==(o=u[3].url)&&s(l,"href",o),d&8&&c!==(c=u[3].others+"")&&ee(f,c)},d(u){u&&_(e)}}}function it(r){let e,t;return{c(){e=g("img"),this.h()},l(a){e=k(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){le(e.src,t=se(r[10],window.Buffer,r[0].actor.icon.url))||s(e,"src",t),s(e,"alt","Sender"),s(e,"class","svelte-8a7ih0")},m(a,l){N(a,e,l)},p(a,l){l&1025&&!le(e.src,t=se(a[10],window.Buffer,a[0].actor.icon.url))&&s(e,"src",t)},d(a){a&&_(e)}}}function nt(r){let e,t,a=re(r[10],r[0].actor.name||r[0].actor.preferredUsername,r[0].actor)+"",l,n,i=fe(r[0].actor)+"",o,c;return{c(){e=g("span"),t=new de(!1),l=R(),n=g("a"),o=X(i),this.h()},l(f){e=k(f,"SPAN",{class:!0});var u=I(e);t=_e(u,!1),u.forEach(_),l=O(f),n=k(f,"A",{href:!0,class:!0});var d=I(n);o=Y(d,i),d.forEach(_),this.h()},h(){t.a=null,s(e,"class","svelte-8a7ih0"),s(n,"href",c="/"+fe(r[0].actor)),s(n,"class","svelte-8a7ih0")},m(f,u){N(f,e,u),t.m(a,e),N(f,l,u),N(f,n,u),v(n,o)},p(f,u){u&1025&&a!==(a=re(f[10],f[0].actor.name||f[0].actor.preferredUsername,f[0].actor)+"")&&t.p(a),u&1&&i!==(i=fe(f[0].actor)+"")&&ee(o,i),u&1&&c!==(c="/"+fe(f[0].actor))&&s(n,"href",c)},d(f){f&&(_(e),_(l),_(n))}}}function zt(r){let e,t;return e=new Bt({props:{links:r[0].note.ephemeralMetadata}}),{c(){ge(e.$$.fragment)},l(a){ke(e.$$.fragment,a)},m(a,l){Ee(e,a,l),t=!0},p(a,l){const n={};l&1&&(n.links=a[0].note.ephemeralMetadata),e.$set(n)},i(a){t||(M(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){Te(e,a)}}}function Gt(r){let e,t;return e=new ht({props:{note:r[0].note}}),{c(){ge(e.$$.fragment)},l(a){ke(e.$$.fragment,a)},m(a,l){Ee(e,a,l),t=!0},p(a,l){const n={};l&1&&(n.note=a[0].note),e.$set(n)},i(a){t||(M(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){Te(e,a)}}}function st(r){let e,t,a,l=r[0].note.ephemeralLikes.length+"",n;return{c(){e=g("span"),t=g("i"),a=R(),n=X(l),this.h()},l(i){e=k(i,"SPAN",{class:!0});var o=I(e);t=k(o,"I",{class:!0}),I(t).forEach(_),a=O(o),n=Y(o,l),o.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-star svelte-8a7ih0"),s(e,"class","likes svelte-8a7ih0")},m(i,o){N(i,e,o),v(e,t),v(e,a),v(e,n)},p(i,o){o&1&&l!==(l=i[0].note.ephemeralLikes.length+"")&&ee(n,l)},d(i){i&&_(e)}}}function ot(r){let e,t,a,l=me(r[0])+"",n,i,o,c,f,u,d,b,h;return{c(){e=g("span"),t=g("i"),a=R(),n=X(l),this.h()},l(p){e=k(p,"SPAN",{class:!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0,"data-note":!0});var S=I(e);t=k(S,"I",{class:!0}),I(t).forEach(_),a=O(S),n=Y(S,l),S.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-comments svelte-8a7ih0"),s(e,"class","comments svelte-8a7ih0"),s(e,"data-display",i=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",o=r[0].actor.url),s(e,"data-username",c=r[0].actor.preferredUsername),s(e,"data-recipient",f=r[0].actor.id),s(e,"data-conversation",u=r[0].note.conversation),s(e,"data-note",d=r[0].note.id)},m(p,S){N(p,e,S),v(e,t),v(e,a),v(e,n),b||(h=x(e,"click",te(r[15])),b=!0)},p(p,S){S&1&&l!==(l=me(p[0])+"")&&ee(n,l),S&1&&i!==(i=p[0].actor.name||p[0].actor.preferredUsername)&&s(e,"data-display",i),S&1&&o!==(o=p[0].actor.url)&&s(e,"data-url",o),S&1&&c!==(c=p[0].actor.preferredUsername)&&s(e,"data-username",c),S&1&&f!==(f=p[0].actor.id)&&s(e,"data-recipient",f),S&1&&u!==(u=p[0].note.conversation)&&s(e,"data-conversation",u),S&1&&d!==(d=p[0].note.id)&&s(e,"data-note",d)},d(p){p&&_(e),b=!1,h()}}}function ct(r){let e,t,a,l,n,i,o,c,f,u,d,b,h,p,S,D;function V(E,T){return E[0].note.ephemeralAnnounced?Jt:Wt}let H=V(r),y=H(r);function P(E,T){return E[0].note.ephemeralLiked?qt:Kt}let B=P(r),U=B(r),j=r[0].actor&&ft(r),m=r[0].note.id&&ut(r);return{c(){e=g("nav"),t=g("i"),u=R(),y.c(),d=R(),U.c(),b=R(),j&&j.c(),h=R(),m&&m.c(),this.h()},l(E){e=k(E,"NAV",{class:!0});var T=I(e);t=k(T,"I",{class:!0,"data-conversation":!0,"data-note":!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0}),I(t).forEach(_),u=O(T),y.l(T),d=O(T),U.l(T),b=O(T),j&&j.l(T),h=O(T),m&&m.l(T),T.forEach(_),this.h()},h(){s(t,"class","fa-solid fa-expand svelte-8a7ih0"),s(t,"data-conversation",a=r[0].note.conversation),s(t,"data-note",l=r[0].note.id),s(t,"data-reply",n=r[0].note.id),s(t,"data-display",i=r[0].actor.name||r[0].actor.preferredUsername),s(t,"data-url",o=r[0].actor.url),s(t,"data-username",c=r[0].actor.preferredUsername),s(t,"data-recipient",f=r[0].actor.id),s(e,"class","svelte-8a7ih0")},m(E,T){N(E,e,T),v(e,t),v(e,u),y.m(e,null),v(e,d),U.m(e,null),v(e,b),j&&j.m(e,null),v(e,h),m&&m.m(e,null),p=!0,S||(D=x(t,"click",te(r[15])),S=!0)},p(E,T){(!p||T&1&&a!==(a=E[0].note.conversation))&&s(t,"data-conversation",a),(!p||T&1&&l!==(l=E[0].note.id))&&s(t,"data-note",l),(!p||T&1&&n!==(n=E[0].note.id))&&s(t,"data-reply",n),(!p||T&1&&i!==(i=E[0].actor.name||E[0].actor.preferredUsername))&&s(t,"data-display",i),(!p||T&1&&o!==(o=E[0].actor.url))&&s(t,"data-url",o),(!p||T&1&&c!==(c=E[0].actor.preferredUsername))&&s(t,"data-username",c),(!p||T&1&&f!==(f=E[0].actor.id))&&s(t,"data-recipient",f),H===(H=V(E))&&y?y.p(E,T):(y.d(1),y=H(E),y&&(y.c(),y.m(e,d))),B===(B=P(E))&&U?U.p(E,T):(U.d(1),U=B(E),U&&(U.c(),U.m(e,b))),E[0].actor?j?j.p(E,T):(j=ft(E),j.c(),j.m(e,h)):j&&(j.d(1),j=null),E[0].note.id?m?(m.p(E,T),T&1&&M(m,1)):(m=ut(E),m.c(),M(m,1),m.m(e,null)):m&&(oe(),Q(m,1,1,()=>{m=null}),ce())},i(E){p||(M(m),p=!0)},o(E){Q(m),p=!1},d(E){E&&_(e),y.d(),U.d(),j&&j.d(),m&&m.d(),S=!1,D()}}}function Wt(r){let e,t,a,l;return{c(){e=g("i"),this.h()},l(n){e=k(n,"I",{class:!0,"data-object":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat svelte-8a7ih0"),s(e,"data-object",t=r[0].note.id)},m(n,i){N(n,e,i),a||(l=x(e,"click",te(r[14])),a=!0)},p(n,i){i&1&&t!==(t=n[0].note.id)&&s(e,"data-object",t)},d(n){n&&_(e),a=!1,l()}}}function Jt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-object":!0,"data-activity":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-repeat selected svelte-8a7ih0"),s(e,"data-object",t=r[0].note.id),s(e,"data-activity",a=r[0].note.ephemeralAnnounced)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(r[13])),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.id)&&s(e,"data-object",t),o&1&&a!==(a=i[0].note.ephemeralAnnounced)&&s(e,"data-activity",a)},d(i){i&&_(e),l=!1,n()}}}function Kt(r){let e,t,a,l,n;return{c(){e=g("i"),this.h()},l(i){e=k(i,"I",{class:!0,"data-actor":!0,"data-object":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star svelte-8a7ih0"),s(e,"data-actor",t=r[0].note.attributedTo),s(e,"data-object",a=r[0].note.id)},m(i,o){N(i,e,o),l||(n=x(e,"click",te(r[12])),l=!0)},p(i,o){o&1&&t!==(t=i[0].note.attributedTo)&&s(e,"data-actor",t),o&1&&a!==(a=i[0].note.id)&&s(e,"data-object",a)},d(i){i&&_(e),l=!1,n()}}}function qt(r){let e,t,a,l,n,i;return{c(){e=g("i"),this.h()},l(o){e=k(o,"I",{class:!0,"data-actor":!0,"data-object":!0,"data-activity":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-star selected svelte-8a7ih0"),s(e,"data-actor",t=r[0].note.attributedTo),s(e,"data-object",a=r[0].note.id),s(e,"data-activity",l=r[0].note.ephemeralLiked)},m(o,c){N(o,e,c),n||(i=x(e,"click",te(r[11])),n=!0)},p(o,c){c&1&&t!==(t=o[0].note.attributedTo)&&s(e,"data-actor",t),c&1&&a!==(a=o[0].note.id)&&s(e,"data-object",a),c&1&&l!==(l=o[0].note.ephemeralLiked)&&s(e,"data-activity",l)},d(o){o&&_(e),n=!1,i()}}}function ft(r){let e,t,a,l,n,i,o,c,f;return{c(){e=g("i"),this.h()},l(u){e=k(u,"I",{class:!0,"data-reply":!0,"data-display":!0,"data-url":!0,"data-username":!0,"data-recipient":!0,"data-conversation":!0}),I(e).forEach(_),this.h()},h(){s(e,"class","fa-solid fa-reply svelte-8a7ih0"),s(e,"data-reply",t=r[0].note.id),s(e,"data-display",a=r[0].actor.name||r[0].actor.preferredUsername),s(e,"data-url",l=r[0].actor.url),s(e,"data-username",n=r[0].actor.preferredUsername),s(e,"data-recipient",i=r[0].actor.id),s(e,"data-conversation",o=r[0].note.conversation)},m(u,d){N(u,e,d),c||(f=x(e,"click",r[16]),c=!0)},p(u,d){d&1&&t!==(t=u[0].note.id)&&s(e,"data-reply",t),d&1&&a!==(a=u[0].actor.name||u[0].actor.preferredUsername)&&s(e,"data-display",a),d&1&&l!==(l=u[0].actor.url)&&s(e,"data-url",l),d&1&&n!==(n=u[0].actor.preferredUsername)&&s(e,"data-username",n),d&1&&i!==(i=u[0].actor.id)&&s(e,"data-recipient",i),d&1&&o!==(o=u[0].note.conversation)&&s(e,"data-conversation",o)},d(u){u&&_(e),c=!1,f()}}}function ut(r){let e,t,a,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Xt,then:Qt,catch:Ft,value:21,blocks:[,,,]};return Pe(t=r[10]?.get_ap_id(),l),{c(){e=ae(),l.block.c()},l(n){e=ae(),l.block.l(n)},m(n,i){N(n,e,i),l.block.m(n,l.anchor=i),l.mount=()=>e.parentNode,l.anchor=e,a=!0},p(n,i){r=n,l.ctx=r,i&1024&&t!==(t=r[10]?.get_ap_id())&&Pe(t,l)||Tt(l,r,i)},i(n){a||(M(l.block),a=!0)},o(n){for(let i=0;i<3;i+=1){const o=l.blocks[i];Q(o)}a=!1},d(n){n&&_(e),l.block.d(n),l.token=null,l=null}}}function Ft(r){return{c:W,l:W,m:W,p:W,i:W,o:W,d:W}}function Qt(r){let e,t;return e=new Mt({props:{remove:r[6],refresh:r[5],object:r[0].note.id,owner:r[21]==r[0].note.attributedTo}}),{c(){ge(e.$$.fragment)},l(a){ke(e.$$.fragment,a)},m(a,l){Ee(e,a,l),t=!0},p(a,l){const n={};l&64&&(n.remove=a[6]),l&32&&(n.refresh=a[5]),l&1&&(n.object=a[0].note.id),l&1025&&(n.owner=a[21]==a[0].note.attributedTo),e.$set(n)},i(a){t||(M(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){Te(e,a)}}}function Xt(r){return{c:W,l:W,m:W,p:W,i:W,o:W,d:W}}function Yt(r){let e,t,a,l,n,i,o,c,f,u,d=re(r[10],r[0].note.content||"",r[0].note)+"",b,h,p,S,D,V,H,y,P,B=Ne(new Date(String(r[0].published)).getTime())+"",U,j,m,E,T,w,C,he,J=r[2]&&lt(r),K=r[3]&&rt(r),q=r[0].actor&&r[0].actor.icon&&it(r),F=r[0].actor&&nt(r);const Le=[Gt,zt],ie=[];function Ue(A,L){return A[0].note.attachment&&A[0].note.attachment.length>0?0:A[0].note.ephemeralMetadata&&A[0].note.ephemeralMetadata.length?1:-1}~(h=Ue(r))&&(p=ie[h]=Le[h](r));let Z=r[0].note.ephemeralLikes?.length&&st(r),$=r[0].replies?.size&&ot(r),z=r[1]&&ct(r);return{c(){e=g("article"),J&&J.c(),t=R(),K&&K.c(),a=R(),l=g("header"),n=g("div"),q&&q.c(),i=R(),o=g("address"),F&&F.c(),c=R(),f=g("section"),u=new de(!1),b=R(),p&&p.c(),S=R(),D=g("div"),Z&&Z.c(),V=R(),$&&$.c(),H=R(),y=g("time"),P=g("a"),U=X(B),E=R(),z&&z.c(),this.h()},l(A){e=k(A,"ARTICLE",{"data-conversation":!0,id:!0,class:!0});var L=I(e);J&&J.l(L),t=O(L),K&&K.l(L),a=O(L),l=k(L,"HEADER",{class:!0});var ne=I(l);n=k(ne,"DIV",{class:!0});var Ce=I(n);q&&q.l(Ce),Ce.forEach(_),i=O(ne),o=k(ne,"ADDRESS",{class:!0});var Re=I(o);F&&F.l(Re),Re.forEach(_),ne.forEach(_),c=O(L),f=k(L,"SECTION",{class:!0});var Oe=I(f);u=_e(Oe,!1),Oe.forEach(_),b=O(L),p&&p.l(L),S=O(L),D=k(L,"DIV",{class:!0});var Ie=I(D);Z&&Z.l(Ie),V=O(Ie),$&&$.l(Ie),Ie.forEach(_),H=O(L),y=k(L,"TIME",{datetime:!0,class:!0});var Ve=I(y);P=k(Ve,"A",{href:!0,target:!0,rel:!0,class:!0});var Be=I(P);U=Y(Be,B),Be.forEach(_),Ve.forEach(_),E=O(L),z&&z.l(L),L.forEach(_),this.h()},h(){s(n,"class","svelte-8a7ih0"),s(o,"class","svelte-8a7ih0"),s(l,"class","svelte-8a7ih0"),u.a=null,s(f,"class","svelte-8a7ih0"),s(D,"class","activity svelte-8a7ih0"),s(P,"href",j=r[0].note.url),s(P,"target",r[7]),s(P,"rel",r[8]),s(P,"class","svelte-8a7ih0"),s(y,"datetime",m=r[0].published),s(y,"class","svelte-8a7ih0"),s(e,"data-conversation",T=r[0].note.conversation),s(e,"id",r[9]),s(e,"class","svelte-8a7ih0")},m(A,L){N(A,e,L),J&&J.m(e,null),v(e,t),K&&K.m(e,null),v(e,a),v(e,l),v(l,n),q&&q.m(n,null),v(l,i),v(l,o),F&&F.m(o,null),v(e,c),v(e,f),u.m(d,f),v(e,b),~h&&ie[h].m(e,null),v(e,S),v(e,D),Z&&Z.m(D,null),v(D,V),$&&$.m(D,null),v(e,H),v(e,y),v(y,P),v(P,U),v(e,E),z&&z.m(e,null),w=!0,C||(he=gt(r[4].call(null,e)),C=!0)},p(A,[L]){A[2]?J?J.p(A,L):(J=lt(A),J.c(),J.m(e,t)):J&&(J.d(1),J=null),A[3]?K?K.p(A,L):(K=rt(A),K.c(),K.m(e,a)):K&&(K.d(1),K=null),A[0].actor&&A[0].actor.icon?q?q.p(A,L):(q=it(A),q.c(),q.m(n,null)):q&&(q.d(1),q=null),A[0].actor?F?F.p(A,L):(F=nt(A),F.c(),F.m(o,null)):F&&(F.d(1),F=null),(!w||L&1025)&&d!==(d=re(A[10],A[0].note.content||"",A[0].note)+"")&&u.p(d);let ne=h;h=Ue(A),h===ne?~h&&ie[h].p(A,L):(p&&(oe(),Q(ie[ne],1,1,()=>{ie[ne]=null}),ce()),~h?(p=ie[h],p?p.p(A,L):(p=ie[h]=Le[h](A),p.c()),M(p,1),p.m(e,S)):p=null),A[0].note.ephemeralLikes?.length?Z?Z.p(A,L):(Z=st(A),Z.c(),Z.m(D,V)):Z&&(Z.d(1),Z=null),A[0].replies?.size?$?$.p(A,L):($=ot(A),$.c(),$.m(D,null)):$&&($.d(1),$=null),(!w||L&1)&&B!==(B=Ne(new Date(String(A[0].published)).getTime())+"")&&ee(U,B),(!w||L&1&&j!==(j=A[0].note.url))&&s(P,"href",j),(!w||L&128)&&s(P,"target",A[7]),(!w||L&256)&&s(P,"rel",A[8]),(!w||L&1&&m!==(m=A[0].published))&&s(y,"datetime",m),A[1]?z?(z.p(A,L),L&2&&M(z,1)):(z=ct(A),z.c(),M(z,1),z.m(e,null)):z&&(oe(),Q(z,1,1,()=>{z=null}),ce()),(!w||L&1&&T!==(T=A[0].note.conversation))&&s(e,"data-conversation",T),(!w||L&512)&&s(e,"id",A[9])},i(A){w||(M(p),M(z),w=!0)},o(A){Q(p),Q(z),w=!1},d(A){A&&_(e),J&&J.d(),K&&K.d(),q&&q.d(),F&&F.d(),~h&&ie[h].d(),Z&&Z.d(),$&&$.d(),z&&z.d(),C=!1,he()}}}function Zt(r,e,t){let a,l,n;ue(r,Et,m=>t(18,l=m)),ue(r,we,m=>t(17,n=m));const i=ye(),o=ye();De(async()=>{a&&c&&c.note&&c.note.id&&t(9,j=a.get_url_safe_base64(c.note.id))});let{note:c}=e,{username:f}=e,{replyToHeader:u}=e,{announceHeader:d}=e,{renderAction:b}=e,{refresh:h}=e,{remove:p}=e;function S(m){const E=String(m.target.dataset.object),T=String(m.target.dataset.actor),w=String(m.target.dataset.activity);console.debug(`UNDOING ${w}`),a&&a.send_unlike(T,E,w).then(C=>{console.debug("UNLIKE SENT"),t(0,c.note.ephemeralLiked=null,c),t(0,c)})}function D(m){const E=String(m.target.dataset.object),T=String(m.target.dataset.actor);a&&a.send_like(T,E).then(w=>{console.debug(`LIKE SENT ${w}`),t(0,c.note.ephemeralLiked=w,c),t(0,c)})}function V(m){const E=String(m.target.dataset.object),T=String(m.target.dataset.activity);a&&E?a.send_unannounce(E,T).then(w=>{console.debug("UNANNOUNCE SENT"),t(0,c.note.ephemeralAnnounced=null,c),t(0,c)}):console.error("OBJECT INVALID")}function H(m){const E=String(m.target.dataset.object);a&&E?a.send_announce(E).then(T=>{console.debug(`ANNOUNCE SENT ${T}`),t(0,c.note.ephemeralAnnounced=T,c),t(0,c)}):console.error("OBJECT INVALID")}function y(m){console.log("DISPATCHING NOTE_SELECT"),console.log(m),o("noteSelect",{replyToConversation:m.target.dataset.conversation,replyToRecipient:m.target.dataset.recipient,replyToNote:m.target.dataset.note,replyToDisplay:re(a,m.target.dataset.display,c.actor),replyToUrl:m.target.dataset.url,replyToUsername:m.target.dataset.username,openAside:!1})}function P(m){i("replyTo",{replyToRecipient:m.target.dataset.recipient,replyToNote:m.target.dataset.reply,replyToDisplay:re(a,m.target.dataset.display,c.actor),replyToConversation:m.target.dataset.conversation,replyToUrl:m.target.dataset.url,replyToUsername:m.target.dataset.username,openAside:!0})}let B=null,U=null;c&&c.note&&c.note.url&&!kt(l.url.toString(),c.note.url)&&(B="_blank",U="noreferrer");let j="";return r.$$set=m=>{"note"in m&&t(0,c=m.note),"username"in m&&t(1,f=m.username),"replyToHeader"in m&&t(2,u=m.replyToHeader),"announceHeader"in m&&t(3,d=m.announceHeader),"renderAction"in m&&t(4,b=m.renderAction),"refresh"in m&&t(5,h=m.refresh),"remove"in m&&t(6,p=m.remove)},r.$$.update=()=>{r.$$.dirty&131072&&t(10,a=n)},[c,f,u,d,b,h,p,B,U,j,a,S,D,V,H,y,P,n]}class na extends ve{constructor(e){super(),be(this,e,Zt,Yt,pe,{note:0,username:1,replyToHeader:2,announceHeader:3,renderAction:4,refresh:5,remove:6})}}export{na as A,Rt as R,Pe as h,Tt as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index.aMiLl7Je.js","./_commonjsHelpers.5-cIlDoe.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}