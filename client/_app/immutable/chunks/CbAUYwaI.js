import"./CWj6FrbW.js";import{aL as ot,p as it,I as ct,w as u,A as B,E as e,aC as lt,z as o,aI as m,aJ as i,D as c,aE as x,aG as mt,x as dt,aN as vt,y as v,a as ut}from"./CPBLXjHw.js";import{i as y}from"./DQNDscH3.js";import{h as A}from"./lslhiYcw.js";import{s as C}from"./BjYZIULF.js";import{s as ft}from"./DSGZP5v2.js";import{s as gt}from"./663Jjc3J.js";import{s as yt,a as _t}from"./DmKqPpxj.js";import{g as ht}from"./BALzUkBY.js";import{c as G,g as kt,b as J}from"./CR2iVpIj.js";import{e as bt}from"./CS4B0N_g.js";var wt=u('<button class="close-button svelte-js944r" tabindex="0" aria-label="Close"><i class="fa-solid fa-xmark svelte-js944r"></i></button>'),jt=u('<div class="actor-banner svelte-js944r"></div>'),xt=u('<div class="actor-summary svelte-js944r"><!></div>'),At=u('<div class="actor-hashtags svelte-js944r"><!></div>'),Ct=u('<div class="actor-capabilities svelte-js944r"><i class="fa-solid fa-lock svelte-js944r" title="Supports encryption"></i></div>'),Et=u('<div role="button" tabindex="0"><!> <!> <div class="actor-content svelte-js944r"><div class="actor-avatar svelte-js944r"><img class="svelte-js944r"/></div> <div class="actor-info svelte-js944r"><div class="actor-name svelte-js944r"><span class="svelte-js944r"><!></span></div> <div class="actor-acct svelte-js944r" role="link" tabindex="0"> </div> <!> <!> <!></div></div></div>');function zt(M,a){it(a,!0);const R=()=>_t(bt,"$enigmatickWasm",V),[V,q]=yt();ct(()=>{var t;console.log("ActorCard actor data:",{id:a.actor.id,name:a.actor.name,hasSummary:!!a.actor.summary,summaryLength:((t=a.actor.summary)==null?void 0:t.length)||0,hasTags:!!a.actor.tag,tagType:a.actor.tag?Array.isArray(a.actor.tag)?"array":typeof a.actor.tag:"none",tagValue:a.actor.tag,tags:a.actor.tag?Array.isArray(a.actor.tag)?a.actor.tag:[a.actor.tag]:[]})});const l=i(R);let f=lt(!1);const _=i(()=>{var t;if(!((t=a.actor.image)!=null&&t.url)||!e(l))return null;try{return G(e(l),String(a.actor.image.url))}catch(r){return console.warn("Failed to get banner URL:",r),null}}),K=t=>{const r=t.target;r.closest("a")||r.closest(".close-button")||B(f,!e(f))},E=t=>{t.preventDefault(),t.stopPropagation(),a.onClose&&a.onClose()},S=t=>{if(t.preventDefault(),t.stopPropagation(),e(h)&&e(h).startsWith("@")){ht(`/${e(h)}`);return}console.warn("Cannot navigate: no webfinger available for actor",a.actor.id)},U="/icons/robot-mask.png",h=i(()=>{const t=a.actor.ephemeral,r=a.actor;if(t!=null&&t.webfinger)return t.webfinger;if(r.webfinger)return r.webfinger;try{const n=a.actor.id,j=a.actor.preferredUsername;if(n){const s=kt(a.actor);return s&&s.startsWith("@")?s:j||"unknown"}return j||"unknown"}catch{return a.actor.preferredUsername||"unknown"}}),O=i(()=>{const t=e(h);if(!t)return a.actor.preferredUsername||"unknown";const r=String(t);return r.startsWith("@")?r:`@${r}`}),Q=i(()=>{var t;return(t=a.actor.icon)!=null&&t.url&&e(l)?G(e(l),a.actor.icon.url):null}),F=i(()=>{if(!a.actor.name)return a.actor.preferredUsername;if(e(l))try{return J(e(l),a.actor.name,a.actor)}catch(t){return console.warn("Failed to insert emojis in actor name:",t),a.actor.name}return a.actor.name}),W=i(()=>{const t=a.actor.tag;if(!t)return"";try{const n=(Array.isArray(t)?t:[t]).filter(s=>s&&typeof s=="object"&&s.type==="Hashtag");return n.length===0?"":n.map(s=>{if(s.href&&s.name){const st=String(s.name).replace(/^#/,"");return`<a href="${s.href}" class="hashtag-link">#${st}</a>`}return""}).filter(Boolean).join(" ")}catch(r){return console.warn("Failed to format hashtags:",r,t),""}}),X=i(()=>{const t=a.actor.summary;if(!t)return"";try{if(typeof document<"u"){const r=document.createElement("div");return r.innerHTML=t,r.textContent||r.innerText||""}return String(t).replace(/<[^>]*>/g,"").trim()}catch(r){return console.warn("Failed to extract summary text:",r),String(t).replace(/<[^>]*>/g,"").trim()}}),Y=i(()=>{const t=a.actor.summary;if(!t)return"";let r=t;if(e(l))try{r=J(e(l),t,a.actor)}catch(n){console.warn("Failed to insert emojis in summary:",n)}return r});var d=Et();let D;d.__click=K,d.__keydown=t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),B(f,!e(f)))};var L=o(d);{var Z=t=>{var r=wt();r.__click=E,r.__keydown=n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),E(n))},v(t,r)};y(L,t=>{a.onClose&&t(Z)})}var T=m(L,2);{var p=t=>{var r=jt();let n;x(()=>n=gt(r,"",n,{"background-image":e(_)?`url(${e(_)})`:void 0})),v(t,r)};y(T,t=>{e(_)&&t(p)})}var H=m(T,2),b=o(H),k=o(b);c(b);var I=m(b,2),w=o(I),N=o(w),$=o(N);A($,()=>e(F)||a.actor.preferredUsername),c(N),c(w);var g=m(w,2);g.__click=S,g.__keydown=t=>{(t.key==="Enter"||t.key===" ")&&S(t)};var tt=o(g,!0);c(g);var P=m(g,2);{var at=t=>{var r=xt(),n=o(r);A(n,()=>e(Y)||a.actor.summary),c(r),x(()=>C(r,"title",e(X)||"")),v(t,r)};y(P,t=>{a.actor.summary&&t(at)})}var z=m(P,2);{var rt=t=>{var r=At(),n=o(r);A(n,()=>e(W)),c(r),v(t,r)};y(z,t=>{e(W)&&t(rt)})}var et=m(z,2);{var nt=t=>{var r=Ct();v(t,r)};y(et,t=>{var r;(r=a.actor.capabilities)!=null&&r.enigmatickEncryption&&t(nt)})}c(I),c(H),c(d),x(()=>{D=ft(d,1,"actor-card svelte-js944r",null,D,{"has-banner":!!e(_),expanded:e(f)}),C(k,"src",e(Q)||U),C(k,"alt",e(F)||a.actor.preferredUsername),mt(tt,e(O))}),dt("error",k,t=>{t.target.src=U}),vt(k),v(M,d),ut(),q()}ot(["click","keydown"]);export{zt as A};
