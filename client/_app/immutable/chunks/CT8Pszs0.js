import{h as l,ac as h,aI as d,aJ as p,aK as m,aL as g,aM as _}from"./C-PNKZ_s.js";const y=Symbol("is custom element"),b=Symbol("is html");function M(e){if(l){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;c(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var s=e.checked;c(e,"checked",null),e.checked=s}}};e.__on_r=r,h(r),d()}}function j(e,t){var r=u(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function I(e,t){var r=u(e);r.checked!==(r.checked=t??void 0)&&(e.checked=t)}function c(e,t,r,n){var s=u(e);l&&(s[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||s[t]!==(s[t]=r)&&(t==="loading"&&(e[p]=r),r==null?e.removeAttribute(t):typeof r!="string"&&A(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function u(e){return e.__attributes??(e.__attributes={[y]:e.nodeName.includes("-"),[b]:e.namespaceURI===m})}var f=new Map;function A(e){var t=e.getAttribute("is")||e.nodeName,r=f.get(t);if(r)return r;f.set(t,r=[]);for(var n,s=e,o=Element.prototype;o!==s;){n=_(s);for(var i in n)n[i].set&&r.push(i);s=g(s)}return r}class E{constructor(t,r,n,s){var o,i;this.note=r,this.activity=n,this.actor=t,r.published?this.published=String(r.published):(o=r.ephemeral)!=null&&o.timestamp?this.published=r.ephemeral.timestamp:this.published=new Date().toISOString(),(i=r.ephemeral)!=null&&i.timestamp?this.created_at=r.ephemeral.timestamp:this.created_at=new Date().toISOString(),this.replies=s||new Map,this.public=this.isPublic()}jsonTo(){let t=[];return this.note.to&&t.push(...a(this.note.to)),this.note.cc&&t.push(...a(this.note.cc)),JSON.stringify(t)}jsonSender(){return JSON.stringify(this.actor)}isPublic(){const t=["https://www.w3.org/ns/activitystreams#Public","as:Public","Public"];let r=[];return this.note.to&&r.push(...a(this.note.to)),this.note.cc&&r.push(...a(this.note.cc)),r.map(s=>typeof s=="string"?s:s&&typeof s=="object"?"href"in s&&s.href?String(s.href):"id"in s&&s.id?String(s.id):"url"in s&&s.url?String(s.url):String(s):String(s)).some(s=>t.includes(s))}}const w=e=>typeof e=="object"&&e!==null&&e.type==="Note",k=e=>typeof e=="object"&&e!==null&&e.type==="EncryptedNote",T=e=>typeof e=="object"&&e!==null&&e.type==="Article",U=e=>typeof e=="object"&&e!==null;function x(e){if(!e)return null;if(Array.isArray(e)){const t=e[0];return typeof t=="string"?t:t&&typeof t=="object"&&"href"in t&&t.href||null}else{if(typeof e=="string")return e;if(typeof e=="object"&&"href"in e)return e.href||null}return null}function L(e){const t=["","k","M","B","T"];let r=0;for(;e>=1e3&&r<t.length-1;)e/=1e3,r++;return r===0?Math.floor(e).toString():e.toFixed(1)+t[r]}function P(e){if(typeof e=="string")return e;if(Array.isArray(e))return e[0]}const D=(e,t)=>{try{const r=new URL(e);let n=r.pathname.slice(1);const s=r.hostname;return n=n.endsWith("/")?n.slice(0,-1):n,n.startsWith("@")?t?`${n}`:`${n}@${s}`:null}catch(r){return console.error("Error parsing URL:",r),null}};function O(e){return new Promise(t=>setTimeout(t,e))}function z(e){const t=/^https:\/\/([a-zA-Z0-9\-.]+?)\/[A-Za-z0-9/\-._]+$/;if(e.id){const r=e.id.match(t);if(r)return`@${e.preferredUsername}@${r[1]}`}return String(e.url)}function R(e,t,r){return e&&r.tag&&a(r.tag).forEach(s=>{s.type==="Emoji"&&s.icon&&t&&(t=t.replaceAll(s.name,`<img class="emoji" src="${S(e,s.icon.url)}"/>`))}),t}function Z(e,t){return Date.parse(e.created_at)<Date.parse(t.created_at)?-1:Date.parse(e.created_at)>Date.parse(t.created_at)?1:0}function $(e){const t=new URL(e),r=t.searchParams.get("max"),n=t.searchParams.get("min");return r?{value:r,type:"max"}:n?{value:n,type:"min"}:{value:null,type:null}}function V(e){const t=/https:\/\/(?:[a-zA-Z0-9.-]+)(?:\.[a-zA-Z0-9.-]+)+\/(?:notes|conversation)\/([a-zA-Z0-9-]+)/,r=e.match(t);return r&&r[1]?r[1]:null}function W(e,t){const r=/(https:\/\/(?:[a-zA-Z0-9.-]+)(?:\.[a-zA-Z0-9.-]+)+)\/.*/,n=e.match(r),s=t.match(r);return n!==null&&s!==null&&n[1]==s[1]}function S(e,t){return e?"/api/cache?url="+e.get_url_safe_base64(t):t}function N(e){return e.instrument&&e.instrument.find(r=>r.type==="VaultItem")||null}const C=(e,t)=>{if((t==null?void 0:t.object.type)=="EncryptedNote"){let r;return e&&(r=N(t))?e.decrypt_text(r.content)||"":'<span class"failure">Message could not be decrypted</span>'}else return(t==null?void 0:t.object.content)||""},J=e=>e?e.replace(/<[^>]*>/g," "):"",q=e=>e?Array.isArray(e)?e[0]||null:e:null,a=e=>e==null?[]:Array.isArray(e)?e:[e];export{E as D,$ as a,O as b,Z as c,q as d,V as e,D as f,z as g,S as h,R as i,P as j,L as k,C as l,x as m,J as n,j as o,I as p,W as q,M as r,c as s,U as t,k as u,T as v,a as w,w as x};
