import"./CWj6FrbW.js";import{aG as pe,p as de,y as K,v as a,r,aw as D,o as be,ax as he,k as m,ay as h,m as _e,n as f,a as ge,aD as d,q as c,aC as u,aF as xe,u as v,aB as ke}from"./C-PNKZ_s.js";import{i as $}from"./CPpPu6cz.js";import{r as we,s as G,h as ye}from"./CT8Pszs0.js";import{s as H}from"./CGqlG8Jg.js";import{b as Pe}from"./BmQI8EjA.js";import{b as R}from"./C6Vr0pnO.js";import{a as M,s as De}from"./ChSDbmkr.js";import{g as T}from"./CjNKWMH0.js";import{p as $e}from"./D7gh-3I6.js";import{a as j,e as Le,o as qe}from"./n0qzx-_D.js";var Ce=m('<a href="/timeline" title="Home"><i class="fa-solid fa-house"></i></a> <a href="/timeline?view=direct" title="Direct Messages"><i class="fa-solid fa-at"></i></a>',1),Se=m('<img alt="Profile" class="profile-image svelte-1elxaub"/>'),Ae=m('<div class="profile-placeholder svelte-1elxaub"><i class="fa-solid fa-user"></i></div>'),Ge=m('<div class="dropdown-menu svelte-1elxaub"><a class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-user svelte-1elxaub"></i> Profile</a> <a href="/settings" class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-gear svelte-1elxaub"></i> Settings</a> <button class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-right-from-bracket svelte-1elxaub"></i> Logout</button></div>'),He=m('<div class="profile-section svelte-1elxaub"><button class="profile-button svelte-1elxaub" aria-label="Profile menu"><!></button> <!></div>'),Me=m('<button class="nav-link svelte-1elxaub" title="Login" aria-label="Login"><i class="fa-solid fa-right-to-bracket"></i></button>'),Oe=m('<header class="header svelte-1elxaub"><div class="header-content svelte-1elxaub"><a href="/" class="app-name svelte-1elxaub">ENIGMATICK</a> <form class="search-form svelte-1elxaub"><div class="input-wrapper svelte-1elxaub"><input type="text" placeholder="Search..." class="search-input svelte-1elxaub"/> <button type="submit" class="search-button svelte-1elxaub" aria-label="Search"><i class="fa-solid fa-magnifying-glass svelte-1elxaub"></i></button></div></form> <nav class="header-nav svelte-1elxaub"><!> <a href="/timeline?view=global" title="Global"><i class="fa-solid fa-globe"></i></a> <!></nav></div></header>');function Te(z,V){de(V,!0);const X=()=>M(j,"$appData",L),Y=()=>M(Le,"$enigmatickWasm",L),i=()=>M($e,"$page",L),[L,Z]=De();let p=D(""),n=D(!1),_,g;const b=d(()=>X().username),x=d(Y);let k=D(null);const ee=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&(!t||t==="")}),ae=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&t==="direct"}),te=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&t==="global"});let O=d(()=>{var e,t;return!((t=(e=a(k))==null?void 0:e.icon)!=null&&t.url)||!a(x)?null:ye(a(x),String(a(k).icon.url))});K(()=>{a(x)&&a(b)&&!a(k)&&a(x).get_profile_by_username(a(b)).then(e=>{if(e)try{r(k,JSON.parse(e),!0)}catch(t){console.error("Failed to parse profile:",t)}}).catch(e=>{console.error("Failed to fetch profile:",e)})});const se=e=>{e.preventDefault(),a(p).trim()&&T(`/search?q=${encodeURIComponent(a(p).trim())}`)},le=e=>{e.stopPropagation(),r(n,!a(n))},E=e=>{g&&_&&!g.contains(e.target)&&!_.contains(e.target)&&r(n,!1)},re=async()=>{r(n,!1),j.set({username:null,display_name:null,avatar:null,domain:null,url:null}),T("/")};be(()=>{if(document.addEventListener("click",E),i().url.pathname==="/search"){const e=i().url.searchParams.get("q");e&&r(p,e,!0)}}),he(()=>{document.removeEventListener("click",E)});let q=D(null);K(()=>{if(i().url.pathname==="/search"){const e=i().url.searchParams.get("q");e!==a(q)&&(r(q,e,!0),e!==null&&r(p,e,!0))}else r(q,null)});var C=Oe(),F=c(C),w=u(c(F),2),I=c(w),U=c(I);we(U),xe(2),v(I),v(w);var W=u(w,2),B=c(W);{var ie=e=>{var t=Ce(),l=ke(t);let y;var S=u(l,2);let P;h(()=>{y=H(l,1,"nav-link svelte-1elxaub",null,y,{active:a(ee)}),P=H(S,1,"nav-link svelte-1elxaub",null,P,{active:a(ae)})}),f(e,t)};$(B,e=>{a(b)&&e(ie)})}var N=u(B,2);let Q;var oe=u(N,2);{var ne=e=>{var t=He(),l=c(t);l.__click=le;var y=c(l);{var S=s=>{var o=Se();h(()=>G(o,"src",a(O))),f(s,o)},P=s=>{var o=Ae();f(s,o)};$(y,s=>{a(O)?s(S):s(P,!1)})}v(l),R(l,s=>_=s,()=>_);var ue=u(l,2);{var ve=s=>{var o=Ge(),A=c(o);A.__click=()=>r(n,!1);var J=u(A,2);J.__click=()=>r(n,!1);var fe=u(J,2);fe.__click=re,v(o),R(o,me=>g=me,()=>g),h(()=>G(A,"href",`/@${a(b)??""}`)),f(s,o)};$(ue,s=>{a(n)&&s(ve)})}v(t),h(()=>G(l,"aria-expanded",a(n))),f(e,t)},ce=e=>{var t=Me();t.__click=l=>{l.preventDefault(),qe()},f(e,t)};$(oe,e=>{a(b)?e(ne):e(ce,!1)})}v(W),v(F),v(C),h(()=>Q=H(N,1,"nav-link svelte-1elxaub",null,Q,{active:a(te)})),_e("submit",w,se),Pe(U,()=>a(p),e=>r(p,e)),f(z,C),ge(),Z()}pe(["click"]);export{Te as H};
