import"./CWj6FrbW.js";import{aL as pe,p as de,I as B,E as a,A as r,aC as D,o as be,aD as he,w as m,aE as h,x as _e,y as f,a as ge,aJ as d,z as c,aI as u,aO as xe,D as v,aH as ke}from"./CPBLXjHw.js";import{i as L}from"./DQNDscH3.js";import{r as we,s as E}from"./BjYZIULF.js";import{s as H}from"./DSGZP5v2.js";import{b as ye}from"./Cv8Dbkhj.js";import{b as K}from"./CD7duDpS.js";import{a as I,s as Pe}from"./DmKqPpxj.js";import{g as R}from"./BALzUkBY.js";import{p as De}from"./NTu1Tg67.js";import{a as T,e as Le,o as $e}from"./CS4B0N_g.js";import{c as Ce}from"./CR2iVpIj.js";var Se=m('<a href="/timeline" title="Home"><i class="fa-solid fa-house"></i></a> <a href="/timeline?view=direct" title="Direct Messages"><i class="fa-solid fa-at"></i></a>',1),qe=m('<img alt="Profile" class="profile-image svelte-1elxaub"/>'),Ae=m('<div class="profile-placeholder svelte-1elxaub"><i class="fa-solid fa-user"></i></div>'),Ee=m('<div class="dropdown-menu svelte-1elxaub"><a class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-user svelte-1elxaub"></i> Profile</a> <a href="/settings" class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-gear svelte-1elxaub"></i> Settings</a> <button class="dropdown-item svelte-1elxaub"><i class="fa-solid fa-right-from-bracket svelte-1elxaub"></i> Logout</button></div>'),He=m('<div class="profile-section svelte-1elxaub"><button class="profile-button svelte-1elxaub" aria-label="Profile menu"><!></button> <!></div>'),Ie=m('<button class="nav-link svelte-1elxaub" title="Login" aria-label="Login"><i class="fa-solid fa-right-to-bracket"></i></button>'),Oe=m('<header class="header svelte-1elxaub"><div class="header-content svelte-1elxaub"><a href="/" class="app-name svelte-1elxaub">ENIGMATICK</a> <form class="search-form svelte-1elxaub"><div class="input-wrapper svelte-1elxaub"><input type="text" placeholder="Search..." class="search-input svelte-1elxaub"/> <button type="submit" class="search-button svelte-1elxaub" aria-label="Search"><i class="fa-solid fa-magnifying-glass svelte-1elxaub"></i></button></div></form> <nav class="header-nav svelte-1elxaub"><!> <a href="/timeline?view=global" title="Global"><i class="fa-solid fa-globe"></i></a> <!></nav></div></header>');function Te(j,V){de(V,!0);const X=()=>I(T,"$appData",$),Y=()=>I(Le,"$enigmatickWasm",$),i=()=>I(De,"$page",$),[$,Z]=Pe();let p=D(""),n=D(!1),_,g;const b=d(()=>X().username),x=d(Y);let k=D(null);const ee=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&(!t||t==="")}),ae=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&t==="direct"}),te=d(()=>{const e=i().url.pathname,t=i().url.searchParams.get("view");return e==="/timeline"&&t==="global"});let O=d(()=>{var e,t;return!((t=(e=a(k))==null?void 0:e.icon)!=null&&t.url)||!a(x)?null:Ce(a(x),String(a(k).icon.url))});B(()=>{a(x)&&a(b)&&!a(k)&&a(x).get_profile_by_username(a(b)).then(e=>{if(e)try{r(k,JSON.parse(e),!0)}catch(t){console.error("Failed to parse profile:",t)}}).catch(e=>{console.error("Failed to fetch profile:",e)})});const se=e=>{e.preventDefault(),a(p).trim()&&R(`/search?q=${encodeURIComponent(a(p).trim())}`)},le=e=>{e.stopPropagation(),r(n,!a(n))},M=e=>{g&&_&&!g.contains(e.target)&&!_.contains(e.target)&&r(n,!1)},re=async()=>{r(n,!1),T.set({username:null,display_name:null,avatar:null,domain:null,url:null}),R("/")};be(()=>{if(document.addEventListener("click",M),i().url.pathname==="/search"){const e=i().url.searchParams.get("q");e&&r(p,e,!0)}}),he(()=>{document.removeEventListener("click",M)});let C=D(null);B(()=>{if(i().url.pathname==="/search"){const e=i().url.searchParams.get("q");e!==a(C)&&(r(C,e,!0),e!==null&&r(p,e,!0))}else r(C,null)});var S=Oe(),G=c(S),w=u(c(G),2),U=c(w),W=c(U);we(W),xe(2),v(U),v(w);var F=u(w,2),J=c(F);{var ie=e=>{var t=Se(),l=ke(t);let y;var q=u(l,2);let P;h(()=>{y=H(l,1,"nav-link svelte-1elxaub",null,y,{active:a(ee)}),P=H(q,1,"nav-link svelte-1elxaub",null,P,{active:a(ae)})}),f(e,t)};L(J,e=>{a(b)&&e(ie)})}var N=u(J,2);let Q;var oe=u(N,2);{var ne=e=>{var t=He(),l=c(t);l.__click=le;var y=c(l);{var q=s=>{var o=qe();h(()=>E(o,"src",a(O))),f(s,o)},P=s=>{var o=Ae();f(s,o)};L(y,s=>{a(O)?s(q):s(P,!1)})}v(l),K(l,s=>_=s,()=>_);var ue=u(l,2);{var ve=s=>{var o=Ee(),A=c(o);A.__click=()=>r(n,!1);var z=u(A,2);z.__click=()=>r(n,!1);var fe=u(z,2);fe.__click=re,v(o),K(o,me=>g=me,()=>g),h(()=>E(A,"href",`/@${a(b)??""}`)),f(s,o)};L(ue,s=>{a(n)&&s(ve)})}v(t),h(()=>E(l,"aria-expanded",a(n))),f(e,t)},ce=e=>{var t=Ie();t.__click=l=>{l.preventDefault(),$e()},f(e,t)};L(oe,e=>{a(b)?e(ne):e(ce,!1)})}v(F),v(G),v(S),h(()=>Q=H(N,1,"nav-link svelte-1elxaub",null,Q,{active:a(te)})),_e("submit",w,se),ye(W,()=>a(p),e=>r(p,e)),f(j,S),ge(),Z()}pe(["click"]);export{Te as H};
