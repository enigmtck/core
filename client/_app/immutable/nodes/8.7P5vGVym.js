import{s as P,f,a as C,g as h,h as M,u as v,c as y,d as b,j as c,i as S,v as g,D as L,E as T,G as w,x as p,o as k,p as x}from"../chunks/scheduler.tnyNm5U0.js";import{S as D,i as H}from"../chunks/index.R_ElRwcJ.js";import"../chunks/paths.-I_WBx4g.js";import{a as q,w as _}from"../chunks/stores.bABpd-zC.js";import O,{update_password as A,load_instance_information as F,import_state as N}from"../chunks/@vite-plugin-wasm-pack@enigmatick_wasm.yARQCucD.js";function U(r){let a,o,d='<form method="dialog" class="svelte-2qpcaz"><h3 class="svelte-2qpcaz">Password Update Failed</h3> <p class="svelte-2qpcaz">Something went wrong. Check your current password and try again.</p> <button class="svelte-2qpcaz">Okay</button></form>',i,e,m=`<h3 class="svelte-2qpcaz">Change Password</h3> <label class="svelte-2qpcaz">Current Password
			<input name="current_password" type="password" placeholder="Current Password" class="svelte-2qpcaz"/></label> <label class="svelte-2qpcaz">New Password
			<input name="new_password" type="password" placeholder="Use a Password Manager" class="svelte-2qpcaz"/></label> <label class="svelte-2qpcaz">Confirm New Password
			<input name="confirm_password" type="password" placeholder="Confirm Password" class="svelte-2qpcaz"/></label> <button class="svelte-2qpcaz">Update</button>`,s,n;return{c(){a=f("main"),o=f("dialog"),o.innerHTML=d,i=C(),e=f("form"),e.innerHTML=m,this.h()},l(l){a=h(l,"MAIN",{class:!0});var t=M(a);o=h(t,"DIALOG",{class:!0,"data-svelte-h":!0}),v(o)!=="svelte-kd86bo"&&(o.innerHTML=d),i=y(t),e=h(t,"FORM",{id:!0,method:!0,class:!0,"data-svelte-h":!0}),v(e)!=="svelte-185f70x"&&(e.innerHTML=m),t.forEach(b),this.h()},h(){c(o,"class","svelte-2qpcaz"),c(e,"id","change_password"),c(e,"method","POST"),c(e,"class","svelte-2qpcaz"),c(a,"class","svelte-2qpcaz")},m(l,t){S(l,a,t),g(a,o),r[2](o),g(a,i),g(a,e),s||(n=L(e,"submit",T(r[1])),s=!0)},p:w,i:w,o:w,d(l){l&&b(a),r[2](null),s=!1,n()}}}function E(r,a,o){let d=p(q).username;p(q).display_name,k(()=>{d&&O().then(()=>{F().then(s=>{console.log(s?.domain),console.log(s?.url),p(_)&&(N(p(_)),console.log("loaded state from store"),console.log(p(_))),console.log("init WASM")})})});function i(s){let n=new FormData(s.target),l=n.get("current_password"),t=n.get("new_password"),u=n.get("confirm_password");l&&t&&u&&t===u&&(console.log(l+" "+t+" "+u),A(String(l),String(t)).then(z=>{z?s.target.reset():e.showModal()}))}let e;function m(s){x[s?"unshift":"push"](()=>{e=s,o(0,e)})}return[e,i,m]}class W extends D{constructor(a){super(),H(this,a,E,U,P,{})}}export{W as component};
