import{s as ee,f as l,a as C,l as Y,g as r,h as S,u as M,c as L,m as J,d as v,r as te,j as e,i as Q,v as a,D as F,E as O,G as V,M as ae,w as se,x as ne,o as le}from"../chunks/scheduler.tnyNm5U0.js";import{g as re}from"../chunks/globals.0cDDIVm6.js";import{S as oe,i as ie}from"../chunks/index.R_ElRwcJ.js";import{e as ce,a as ue}from"../chunks/stores.bABpd-zC.js";import{g as X}from"../chunks/navigation.g998M0x9.js";const{document:Z}=re;function me(g){let s,d,h="ENIGMATICK",b,o,T="Create Account",_,t,n,E=`Username
			<input name="username" type="text" placeholder="bob" class="svelte-12jgjtu"/>`,k,i,N=`Display Name
			<input name="display_name" type="text" placeholder="Bob Anderson" class="svelte-12jgjtu"/>`,P,j,B,c,H,y,I,u,D,w,G='<button class="svelte-12jgjtu">Create Account</button>',A,f,R=`body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  display: block;
  background: white;
}
@media screen and (max-width: 600px) {
  body {
    background: #fafafa;
  }
}`,q,W;return{c(){s=l("main"),d=l("h1"),d.textContent=h,b=C(),o=l("h2"),o.textContent=T,_=C(),t=l("form"),n=l("label"),n.innerHTML=E,k=C(),i=l("label"),i.innerHTML=N,P=C(),j=l("label"),B=Y(`Password
			`),c=l("input"),H=C(),y=l("label"),I=Y(`Confirm Password
			`),u=l("input"),D=C(),w=l("div"),w.innerHTML=G,A=C(),f=l("style"),f.textContent=R,this.h()},l(x){s=r(x,"MAIN",{class:!0});var p=S(s);d=r(p,"H1",{class:!0,"data-svelte-h":!0}),M(d)!=="svelte-1bn9c6g"&&(d.textContent=h),b=L(p),o=r(p,"H2",{class:!0,"data-svelte-h":!0}),M(o)!=="svelte-lqaecl"&&(o.textContent=T),_=L(p),t=r(p,"FORM",{id:!0,method:!0,class:!0});var m=S(t);n=r(m,"LABEL",{class:!0,"data-svelte-h":!0}),M(n)!=="svelte-onj7mi"&&(n.innerHTML=E),k=L(m),i=r(m,"LABEL",{class:!0,"data-svelte-h":!0}),M(i)!=="svelte-1umteht"&&(i.innerHTML=N),P=L(m),j=r(m,"LABEL",{class:!0});var U=S(j);B=J(U,`Password
			`),c=r(U,"INPUT",{name:!0,type:!0,minlength:!0,placeholder:!0,class:!0}),U.forEach(v),H=L(m),y=r(m,"LABEL",{class:!0});var $=S(y);I=J($,`Confirm Password
			`),u=r($,"INPUT",{name:!0,type:!0,minlength:!0,placeholder:!0,class:!0}),$.forEach(v),D=L(m),w=r(m,"DIV",{class:!0,"data-svelte-h":!0}),M(w)!=="svelte-1msvkw3"&&(w.innerHTML=G),m.forEach(v),p.forEach(v),A=L(x);const K=te("svelte-1s0zqhx",Z.head);f=r(K,"STYLE",{lang:!0,"data-svelte-h":!0}),M(f)!=="svelte-16pe6kz"&&(f.textContent=R),K.forEach(v),this.h()},h(){e(d,"class","svelte-12jgjtu"),e(o,"class","svelte-12jgjtu"),e(n,"class","svelte-12jgjtu"),e(i,"class","svelte-12jgjtu"),e(c,"name","password"),e(c,"type","password"),c.required=!0,e(c,"minlength","5"),e(c,"placeholder","Use a password manager"),e(c,"class","svelte-12jgjtu"),e(j,"class","svelte-12jgjtu"),e(u,"name","confirm_password"),e(u,"type","password"),u.required=!0,e(u,"minlength","5"),e(u,"placeholder","Confirm your password"),e(u,"class","svelte-12jgjtu"),e(y,"class","svelte-12jgjtu"),e(w,"class","svelte-12jgjtu"),e(t,"id","signup"),e(t,"method","POST"),e(t,"class","svelte-12jgjtu"),e(s,"class","svelte-12jgjtu"),e(f,"lang","scss")},m(x,p){Q(x,s,p),a(s,d),a(s,b),a(s,o),a(s,_),a(s,t),a(t,n),a(t,k),a(t,i),a(t,P),a(t,j),a(j,B),a(j,c),a(t,H),a(t,y),a(y,I),a(y,u),a(t,D),a(t,w),Q(x,A,p),a(Z.head,f),q||(W=[F(c,"change",O(z)),F(u,"change",O(z)),F(t,"submit",O(g[0]))],q=!0)},p:V,i:V,o:V,d(x){x&&(v(s),v(A)),v(f),q=!1,ae(W)}}}function z(){const g=document.getElementsByName("password")[0],s=document.getElementsByName("confirm_password")[0];return g.value==s.value}function de(g,s,d){let h,b;se(g,ce,_=>d(1,b=_));let o=ne(ue).username;le(()=>{o&&X(`/@${o}`)});async function T(_){const t=document.getElementsByTagName("button")[0];if(t.disabled=!0,_.target.checkValidity&&z()){let n=new FormData(_.target);console.log(n);let E=h?.create_olm_account();if(E){let k=h?.get_identity_public_key(E),i=h?.get_one_time_keys(E);n.get("username")&&n.get("display_name")&&n.get("password")&&k&&i&&h?.create_user(String(n.get("username")),String(n.get("display_name")),String(n.get("password")),String(k),String(i.pickled_account)).then(N=>{X("/login")})}}else console.error("FORM INVALID")}return g.$$.update=()=>{g.$$.dirty&2&&(h=b)},[T,b]}class ve extends oe{constructor(s){super(),ie(this,s,de,me,ee,{})}}export{ve as component};
