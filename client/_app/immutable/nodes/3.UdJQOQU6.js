import{s as Re,G as Xe,a as B,f as w,c as V,g as E,h as M,d as m,j as u,i as N,w as ve,o as Qe,e as he,H as Ye,v as k,C as $,D as re,p as Oe,I as Rl,F as O,l as ce,m as ue,n as De,E as Ie,J as Be,K as Ve,k as Cl,u as me,L as Je,M as Bl,B as pe}from"../chunks/scheduler.vJi1FF2t.js";import{S as ze,i as Ge,a as F,g as de,t as L,c as _e,b as ke,d as we,m as Ee,e as Te}from"../chunks/index.NkgvvCTc.js";import{p as Vl}from"../chunks/stores.RFVp_Ggc.js";import{C as Jl,s as zl,a as Gl}from"../chunks/Compose.Fv6IHVy0.js";import{a as Ll,e as We}from"../chunks/stores.Q3fukup_.js";import{e as je,i as be,c as $e,a as Wl,b as ql,D as Kl,d as Ze,g as Se,f as Me,h as xe,j as Pe}from"../chunks/common.iVHbJUVt.js";import{h as He,u as Ul,R as Zl,A as Ql}from"../chunks/Article.F1uC_LI8.js";import{b as Yl,g as Xl}from"../chunks/navigation.9JcVx6SN.js";import{g as $l}from"../chunks/globals.0cDDIVm6.js";import"../chunks/paths.s9Ljdrp4.js";function el(o,e,n){const s=o.slice();return s[34]=e[n],s}function ll(o,e,n){const s=o.slice();return s[37]=e[n],s}function tl(o){let e,n,s={senderFunction:o[8],direct:!1};return e=new Jl({props:s}),o[16](e),{c(){ke(e.$$.fragment)},l(l){we(e.$$.fragment,l)},m(l,t){Ee(e,l,t),n=!0},p(l,t){const i={};e.$set(i)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){L(e.$$.fragment,l),n=!1},d(l){o[16](null),Te(e,l)}}}function nl(o){let e,n,s,l=je(Array.from(o[1].values())),t=[];for(let a=0;a<l.length;a+=1)t[a]=rl(el(o,l,a));const i=a=>L(t[a],1,1,()=>{t[a]=null});let r=o[2]&&al(o);return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=B(),r&&r.c(),n=he()},l(a){for(let c=0;c<t.length;c+=1)t[c].l(a);e=V(a),r&&r.l(a),n=he()},m(a,c){for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(a,c);N(a,e,c),r&&r.m(a,c),N(a,n,c),s=!0},p(a,c){if(c[0]&7875){l=je(Array.from(a[1].values()));let f;for(f=0;f<l.length;f+=1){const d=el(a,l,f);t[f]?(t[f].p(d,c),F(t[f],1)):(t[f]=rl(d),t[f].c(),F(t[f],1),t[f].m(e.parentNode,e))}for(de(),f=l.length;f<t.length;f+=1)i(f);_e()}a[2]?r?r.p(a,c):(r=al(a),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i(a){if(!s){for(let c=0;c<l.length;c+=1)F(t[c]);s=!0}},o(a){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)L(t[c]);s=!1},d(a){a&&(m(e),m(n)),Ye(t,a),r&&r.d(a)}}}function sl(o){let e,n,s,l,t={ctx:o,current:null,token:null,hasCatch:!1,pending:st,then:et,catch:xl,value:40,blocks:[,,,]};He(e=o[9](o[34].note),t);let i=o[34].note.id==fl&&o[34].replies?.size&&ol(o);return{c(){t.block.c(),n=B(),i&&i.c(),s=he()},l(r){t.block.l(r),n=V(r),i&&i.l(r),s=he()},m(r,a){t.block.m(r,t.anchor=a),t.mount=()=>n.parentNode,t.anchor=n,N(r,n,a),i&&i.m(r,a),N(r,s,a),l=!0},p(r,a){o=r,t.ctx=o,a[0]&2&&e!==(e=o[9](o[34].note))&&He(e,t)||Ul(t,o,a),o[34].note.id==fl&&o[34].replies?.size?i?(i.p(o,a),a[0]&2&&F(i,1)):(i=ol(o),i.c(),F(i,1),i.m(s.parentNode,s)):i&&(de(),L(i,1,1,()=>{i=null}),_e())},i(r){l||(F(t.block),F(i),l=!0)},o(r){for(let a=0;a<3;a+=1){const c=t.blocks[a];L(c)}L(i),l=!1},d(r){r&&(m(n),m(s)),t.block.d(r),t.token=null,t=null,i&&i.d(r)}}}function xl(o){return{c:O,l:O,m:O,p:O,i:O,o:O,d:O}}function et(o){let e,n,s,l={ctx:o,current:null,token:null,hasCatch:!1,pending:nt,then:tt,catch:lt,value:41,blocks:[,,,]};return He(n=o[10](o[34].note),l),{c(){e=he(),l.block.c()},l(t){e=he(),l.block.l(t)},m(t,i){N(t,e,i),l.block.m(t,l.anchor=i),l.mount=()=>e.parentNode,l.anchor=e,s=!0},p(t,i){o=t,l.ctx=o,i[0]&2&&n!==(n=o[10](o[34].note))&&He(n,l)||Ul(l,o,i)},i(t){s||(F(l.block),s=!0)},o(t){for(let i=0;i<3;i+=1){const r=l.blocks[i];L(r)}s=!1},d(t){t&&m(e),l.block.d(t),l.token=null,l=null}}}function lt(o){return{c:O,l:O,m:O,p:O,i:O,o:O,d:O}}function tt(o){let e,n;return e=new Ql({props:{remove:o[7],refresh:o[6],note:o[34],username:o[12],renderAction:it,cachedNote:o[11]}}),e.$on("replyTo",function(){Rl(o[0].handleReplyToMessage)&&o[0].handleReplyToMessage.apply(this,arguments)}),e.$on("noteSelect",Pl),{c(){ke(e.$$.fragment)},l(s){we(e.$$.fragment,s)},m(s,l){Ee(e,s,l),n=!0},p(s,l){o=s;const t={};l[0]&2&&(t.note=o[34]),e.$set(t)},i(s){n||(F(e.$$.fragment,s),n=!0)},o(s){L(e.$$.fragment,s),n=!1},d(s){Te(e,s)}}}function nt(o){return{c:O,l:O,m:O,p:O,i:O,o:O,d:O}}function st(o){return{c:O,l:O,m:O,p:O,i:O,o:O,d:O}}function ol(o){let e,n,s=je(Array.from(o[34].replies.values()).sort($e)),l=[];for(let i=0;i<s.length;i+=1)l[i]=il(ll(o,s,i));const t=i=>L(l[i],1,1,()=>{l[i]=null});return{c(){e=w("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var r=M(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){u(e,"class","replies svelte-acyv1")},m(i,r){N(i,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null);n=!0},p(i,r){if(r[0]&4227){s=je(Array.from(i[34].replies.values()).sort($e));let a;for(a=0;a<s.length;a+=1){const c=ll(i,s,a);l[a]?(l[a].p(c,r),F(l[a],1)):(l[a]=il(c),l[a].c(),F(l[a],1),l[a].m(e,null))}for(de(),a=s.length;a<l.length;a+=1)t(a);_e()}},i(i){if(!n){for(let r=0;r<s.length;r+=1)F(l[r]);n=!0}},o(i){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)L(l[r]);n=!1},d(i){i&&m(e),Ye(l,i)}}}function il(o){let e,n;return e=new Zl({props:{remove:o[7],note:o[37],username:o[12]}}),e.$on("replyTo",function(){Rl(o[0].handleReplyToMessage)&&o[0].handleReplyToMessage.apply(this,arguments)}),e.$on("noteSelect",Pl),{c(){ke(e.$$.fragment)},l(s){we(e.$$.fragment,s)},m(s,l){Ee(e,s,l),n=!0},p(s,l){o=s;const t={};l[0]&2&&(t.note=o[37]),e.$set(t)},i(s){n||(F(e.$$.fragment,s),n=!0)},o(s){L(e.$$.fragment,s),n=!1},d(s){Te(e,s)}}}function rl(o){let e,n,s=o[34].note&&sl(o);return{c(){s&&s.c(),e=he()},l(l){s&&s.l(l),e=he()},m(l,t){s&&s.m(l,t),N(l,e,t),n=!0},p(l,t){l[34].note?s?(s.p(l,t),t[0]&2&&F(s,1)):(s=sl(l),s.c(),F(s,1),s.m(e.parentNode,e)):s&&(de(),L(s,1,1,()=>{s=null}),_e())},i(l){n||(F(s),n=!0)},o(l){L(s),n=!1},d(l){l&&m(e),s&&s.d(l)}}}function al(o){let e,n,s,l;return{c(){e=w("button"),n=w("i"),this.h()},l(t){e=E(t,"BUTTON",{class:!0});var i=M(e);n=E(i,"I",{class:!0}),M(n).forEach(m),i.forEach(m),this.h()},h(){u(n,"class","fa-solid fa-ellipsis"),e.disabled=o[3],u(e,"class","svelte-acyv1")},m(t,i){N(t,e,i),k(e,n),s||(l=$(e,"click",re(o[17])),s=!0)},p(t,i){i[0]&8&&(e.disabled=t[3])},d(t){t&&m(e),s=!1,l()}}}function ot(o){let e,n,s,l=o[4]&&tl(o),t=o[4]&&nl(o);return{c(){l&&l.c(),e=B(),n=w("div"),t&&t.c(),this.h()},l(i){l&&l.l(i),e=V(i),n=E(i,"DIV",{class:!0});var r=M(n);t&&t.l(r),r.forEach(m),this.h()},h(){u(n,"class","svelte-acyv1")},m(i,r){l&&l.m(i,r),N(i,e,r),N(i,n,r),t&&t.m(n,null),s=!0},p(i,r){i[4]?l?(l.p(i,r),r[0]&16&&F(l,1)):(l=tl(i),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(de(),L(l,1,1,()=>{l=null}),_e()),i[4]?t?(t.p(i,r),r[0]&16&&F(t,1)):(t=nl(i),t.c(),F(t,1),t.m(n,null)):t&&(de(),L(t,1,1,()=>{t=null}),_e())},i(i){s||(F(l),F(t),s=!0)},o(i){L(l),L(t),s=!1},d(i){i&&(m(e),m(n)),l&&l.d(i),t&&t.d()}}}let fl=null;function it(o){}function Ke(o){if(console.debug(`IN parseProfile: ${o}`),o)try{return JSON.parse(o)}catch{return console.error("UNABLE TO PARSE PROFILE"),console.debug(o),null}else return console.error("UNABLE TO PARSE NULL OR UNDEFINED"),null}function Pl(){console.debug("NOT IMPLEMENTED")}function rt(o,e,n){let s,l,t;ve(o,Ll,_=>n(20,l=_)),ve(o,We,_=>n(15,t=_));let i,{local:r}=e,{handle:a}=e;new Array,Qe(async()=>{}),console.debug(`HANDLE ${a}`);async function c(_){const g=_.orderedItems;if(console.debug(g),g){for(const p of g)if(p.type==="Create")T(p);else if(p.type==="Announce")if(console.debug("PROCESSING ANNOUNCE"),Wl(p.object))T(p);else{let h=await s?.get_note(String(p.object));if(console.debug("ANNOUNCED NOTE"),console.debug(h),h){const j=JSON.parse(h);if(console.debug(j),p.actor){let H=Ke(await D(p.actor));if(H){let W=j.ephemeral||{};W.announces=[H],j.ephemeral=W}}p.object=j,T(p)}}}n(2,oe=_.next||null),le=_.prev||null}async function f(_,g){console.debug("RESETTING NOTES MAP"),n(1,C=new Map),!x&&s&&(x=new s.EnigmatickCache);let p=s?.get_state();if(p)if(p.get_server_url(),g&&_){const h=await s?.get_outbox(_);if(h){const j=JSON.parse(h);console.debug(j),c(j).then(()=>{n(3,P=!1)})}}else s?.get_remote_outbox(`@${_}`).then(h=>{if(h){const j=JSON.parse(h);s?.get_remote_outbox(`@${_}`,j.first).then(H=>{if(H){const W=JSON.parse(H);c(W).then(()=>{n(3,P=!1)})}})}})}async function d(){let _=null;if(oe?_=oe:le&&(_=le),console.debug(`loadMore URL: ${_}`),_)if(n(3,P=!0),r&&se){let g=ql(_);console.debug(`maxMin: ${g}`),g&&g.type&&g.value&&s?.get_outbox(se,g.type,g.value).then(p=>{if(p){const h=JSON.parse(p);c(h).then(()=>{n(3,P=!1)})}})}else s?.get_remote_outbox(`@${a}`,_).then(g=>{if(g){const p=JSON.parse(g);c(p).then(()=>{n(3,P=!1)})}})}function A(){console.debug("REFRESH"),C.clear(),f(a,r).then(_=>{console.log("LOADED")})}function K(_){C.delete(_),n(1,C)}async function y(_){const g=_.note;C.get(String(g.id))||(C.set(String(g.id),_),ne.set(String(g.id),[String(g.id)]))}async function T(_){console.log("ADDING ACTIVITY"),console.debug(_);let g=_.object;g.ephemeral?.actors&&g.ephemeral.actors.forEach(h=>{h.id&&U.set(h.id,JSON.stringify(h))}),g.ephemeral?.likes&&(console.debug("EPHEMERAL LIKES"),console.debug(g.ephemeral.likes)),console.debug(`NOTE ATTRIBUTED_TO: ${g.attributedTo}`);let p=g.ephemeral?.attributedTo?.at(0);if((p==null||p==null)&&(p=Ke(await D(g.attributedTo))),console.debug("NOTE ACTOR"),console.debug(p),p){console.debug("PARSED PROFILE"),console.debug(p);const h=new Kl(p,g,_);console.debug("DISPLAY_NOTE"),console.debug(h),await y(h),n(1,C)}n(1,C)}async function J(_,g,p,h,j,H,W){if(s){let z=(await s.SendParams.new()).set_content(p).set_public();W||z.set_public(),z.set_attachments(JSON.stringify(h)),z.set_hashtags(H);for(const[X,Q]of j)z.add_mention(X,Q.id||"",Q.capabilities?.enigmatickEncryption||!1);return g&&(z.set_in_reply_to(String(g.note.id)),z.set_conversation(String(g.note.conversation))),await s.send_note(z)}else return null}async function S(_){if(_.inReplyTo){const g=await G(_.inReplyTo);if(g){const p=JSON.parse(String(g)),h=p.ephemeral?.attributedTo?.at(0)??Ke(await D(p.attributedTo));if(h&&s){console.debug(`IN replyActor: ${h.name} | ${h.preferredUsername}`);const j=be(s,h.name??h.preferredUsername,h);return console.debug(`NAME: ${j}`),j}else return null}else return null}else return null}async function Y(_){if(_.ephemeral?.announces){const g=_.ephemeral.announces[0];let p="";if(_.ephemeral?.announces.length==2?p=` and ${_.ephemeral.announces.length-1} other`:_.ephemeral.announces.length>2&&(p=` and ${_.ephemeral.announces.length-1} others`),g){const h=be(s,g.name||g.preferredUsername,g);return{url:g.url,name:h,others:p}}else return null}else return null}async function D(_){if(_&&s&&x)try{return console.debug(`RETRIEVING ${_} FROM CACHE`),await s.get_actor_cached(x,_)}catch{return console.error(`FAILED TO RETRIEVE: ${a}`),null}return null}async function G(_){return console.debug(`RETRIEVING NOTE: ${_}`),s&&!U.has(_)&&U.set(_,await s.get_note(_)),U.get(_)}let C=new Map,ne=new Map,U=new Map,x=null,se=l.username,oe=null,le=null,P=!0;function Z(_){Oe[_?"unshift":"push"](()=>{i=_,n(0,i)})}const ie=()=>d();return o.$$set=_=>{"local"in _&&n(13,r=_.local),"handle"in _&&n(14,a=_.handle)},o.$$.update=()=>{o.$$.dirty[0]&32768&&n(4,s=t),o.$$.dirty[0]&24576&&f(a,r).then(()=>{console.debug("RELOADED POSTS")})},[i,C,oe,P,s,d,A,K,J,S,Y,G,se,r,a,t,Z,ie]}class at extends ze{constructor(e){super(),Ge(this,e,rt,ot,Re,{local:13,handle:14},null,[-1,-1])}get local(){return this.$$.ctx[13]}set local(e){this.$$set({local:e}),Xe()}get handle(){return this.$$.ctx[14]}set handle(e){this.$$set({handle:e}),Xe()}}function cl(o){let e,n;return{c(){e=w("img"),this.h()},l(s){e=E(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Ie(e.src,n=Me(o[1],o[0].icon.url))||u(e,"src",n),u(e,"alt","Avatar"),u(e,"class","svelte-1hzuv10")},m(s,l){N(s,e,l)},p(s,l){l&3&&!Ie(e.src,n=Me(s[1],s[0].icon.url))&&u(e,"src",n)},d(s){s&&m(e)}}}function ft(o){let e,n=o[0].name+"",s;return{c(){e=w("span"),s=ce(n),this.h()},l(l){e=E(l,"SPAN",{class:!0});var t=M(e);s=ue(t,n),t.forEach(m),this.h()},h(){u(e,"class","svelte-1hzuv10")},m(l,t){N(l,e,t),k(e,s)},p(l,t){t&1&&n!==(n=l[0].name+"")&&De(s,n)},d(l){l&&m(e)}}}function ct(o){let e,n,s=be(o[1],o[0].name,o[0])+"";return{c(){e=w("span"),n=new Be(!1),this.h()},l(l){e=E(l,"SPAN",{class:!0});var t=M(e);n=Ve(t,!1),t.forEach(m),this.h()},h(){n.a=null,u(e,"class","svelte-1hzuv10")},m(l,t){N(l,e,t),n.m(s,e)},p(l,t){t&3&&s!==(s=be(l[1],l[0].name,l[0])+"")&&n.p(s)},d(l){l&&m(e)}}}function ut(o){let e,n,s,l,t,i,r,a=(o[0].webfinger||Ze(Se(o[0].url)||"",!0)||Se(o[0].url))+"",c,f,d=o[0].icon&&cl(o);function A(T,J){return T[0]&&T[0].name?ct:ft}let K=A(o),y=K(o);return{c(){e=w("div"),n=w("a"),s=w("div"),d&&d.c(),l=B(),t=w("div"),y.c(),i=B(),r=w("span"),c=ce(a),this.h()},l(T){e=E(T,"DIV",{class:!0});var J=M(e);n=E(J,"A",{href:!0,class:!0});var S=M(n);s=E(S,"DIV",{class:!0});var Y=M(s);d&&d.l(Y),Y.forEach(m),l=V(S),t=E(S,"DIV",{class:!0});var D=M(t);y.l(D),i=V(D),r=E(D,"SPAN",{class:!0});var G=M(r);c=ue(G,a),G.forEach(m),D.forEach(m),S.forEach(m),J.forEach(m),this.h()},h(){u(s,"class","image svelte-1hzuv10"),u(r,"class","handle svelte-1hzuv10"),u(t,"class","text svelte-1hzuv10"),u(n,"href",f="/"+o[0].webfinger),u(n,"class","svelte-1hzuv10"),u(e,"class","svelte-1hzuv10")},m(T,J){N(T,e,J),k(e,n),k(n,s),d&&d.m(s,null),k(n,l),k(n,t),y.m(t,null),k(t,i),k(t,r),k(r,c)},p(T,[J]){T[0].icon?d?d.p(T,J):(d=cl(T),d.c(),d.m(s,null)):d&&(d.d(1),d=null),K===(K=A(T))&&y?y.p(T,J):(y.d(1),y=K(T),y&&(y.c(),y.m(t,i))),J&1&&a!==(a=(T[0].webfinger||Ze(Se(T[0].url)||"",!0)||Se(T[0].url))+"")&&De(c,a),J&1&&f!==(f="/"+T[0].webfinger)&&u(n,"href",f)},i:O,o:O,d(T){T&&m(e),d&&d.d(),y.d()}}}function ht(o,e,n){let s,l;ve(o,We,i=>n(2,l=i));let{profile:t}=e;return o.$$set=i=>{"profile"in i&&n(0,t=i.profile)},o.$$.update=()=>{o.$$.dirty&4&&n(1,s=l)},[t,s,l]}class mt extends ze{constructor(e){super(),Ge(this,e,ht,ut,Re,{profile:0})}}const{Boolean:dt}=$l;function ul(o,e,n){const s=o.slice();return s[14]=e[n],s}function hl(o){let e,n;return e=new mt({props:{profile:o[14]}}),{c(){ke(e.$$.fragment)},l(s){we(e.$$.fragment,s)},m(s,l){Ee(e,s,l),n=!0},p(s,l){const t={};l&2&&(t.profile=s[14]),e.$set(t)},i(s){n||(F(e.$$.fragment,s),n=!0)},o(s){L(e.$$.fragment,s),n=!1},d(s){Te(e,s)}}}function ml(o){let e,n,s,l;return{c(){e=w("button"),n=w("i"),this.h()},l(t){e=E(t,"BUTTON",{class:!0});var i=M(e);n=E(i,"I",{class:!0}),M(n).forEach(m),i.forEach(m),this.h()},h(){u(n,"class","fa-solid fa-ellipsis"),e.disabled=pt,u(e,"class","svelte-17ipyhu")},m(t,i){N(t,e,i),k(e,n),s||(l=$(e,"click",re(o[9])),s=!0)},p:O,d(t){t&&m(e),s=!1,l()}}}function _t(o){let e,n,s,l=je(o[1]),t=[];for(let a=0;a<l.length;a+=1)t[a]=hl(ul(o,l,a));const i=a=>L(t[a],1,1,()=>{t[a]=null});let r=o[0]!==void 0&&ml(o);return{c(){e=w("div");for(let a=0;a<t.length;a+=1)t[a].c();n=B(),r&&r.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var c=M(e);for(let f=0;f<t.length;f+=1)t[f].l(c);n=V(c),r&&r.l(c),c.forEach(m),this.h()},h(){u(e,"class","svelte-17ipyhu")},m(a,c){N(a,e,c);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);k(e,n),r&&r.m(e,null),s=!0},p(a,[c]){if(c&2){l=je(a[1]);let f;for(f=0;f<l.length;f+=1){const d=ul(a,l,f);t[f]?(t[f].p(d,c),F(t[f],1)):(t[f]=hl(d),t[f].c(),F(t[f],1),t[f].m(e,n))}for(de(),f=l.length;f<t.length;f+=1)i(f);_e()}a[0]!==void 0?r?r.p(a,c):(r=ml(a),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i(a){if(!s){for(let c=0;c<l.length;c+=1)F(t[c]);s=!0}},o(a){t=t.filter(dt);for(let c=0;c<t.length;c+=1)L(t[c]);s=!1},d(a){a&&m(e),Ye(t,a),r&&r.d()}}}let pt=!1;function bt(o,e,n){let s,l;ve(o,We,S=>n(8,l=S));let{handle:t}=e,{local:i}=e,{view:r}=e,{cache:a}=e,{cachedActor:c}=e,f;const d=async(S,Y)=>{if(r=="Followers"){let D=await s?.get_remote_followers(S);if(console.debug(D),D)return JSON.parse(D).first}else if(r=="Following"){let D=await s?.get_remote_following(S);if(D)return JSON.parse(D).first}},A=async(S,Y)=>{const G=await s?.[r==="Followers"?"get_remote_followers":"get_remote_following"](S,Y);if(!G)return null;const C=JSON.parse(G);let ne=[];return C.ephemeral?.actors?ne=C.ephemeral.actors:C.orderedItems&&(ne=await Promise.all(C.orderedItems.map(async U=>{try{const x=await c(U,a);return JSON.parse(x)}catch{return console.error(`Failed to retrieve ${U}`),null}})).then(U=>U.filter(Boolean))),{profiles:ne,next:C.next}},K=async(S,Y)=>{const D=Y?await s?.get_webfinger_from_handle(S)||S:`@${S}`,G=await d(D);if(!G)return;const C=await A(D,G);C&&(n(1,T=C.profiles),n(0,f=C.next))},y=async()=>{const S=i?await s?.get_webfinger_from_handle(t)||t:`@${t}`;if(!S||!f)return;const Y=await A(S,f);Y&&(n(1,T=[...T,...Y.profiles]),n(0,f=Y.next))};let T=[];Qe(async()=>{});const J=()=>y();return o.$$set=S=>{"handle"in S&&n(3,t=S.handle),"local"in S&&n(4,i=S.local),"view"in S&&n(5,r=S.view),"cache"in S&&n(6,a=S.cache),"cachedActor"in S&&n(7,c=S.cachedActor)},o.$$.update=()=>{o.$$.dirty&256&&(s=l),o.$$.dirty&24&&K(t,i).then(()=>{console.debug("RELOADED FOLLOWS")})},[f,T,y,t,i,r,a,c,l,J]}class Hl extends ze{constructor(e){super(),Ge(this,e,bt,_t,Re,{handle:3,local:4,view:5,cache:6,cachedActor:7})}}function dl(o){let e,n,s,l,t,i,r,a,c,f,d,A,K,y=xe(o[13])+"",T,J,S,Y,D,G,C,ne,U,x,se,oe,le,P,Z,ie,_=o[17]&&_l(o),g=o[13].image&&pl(o),p=o[17]&&bl(o),h=o[13].name&&gl(o),j=o[17]&&vl(o),H=o[6]&&Ol(o),W=o[17]&&!o[6]&&Sl(o),z=!o[17]&&Il(o),X=o[14]&&jl(o),Q=(o[14]||o[17])&&Ml(o),ee=o[17]&&Fl(o);const Ce=[Et,wt,kt],ae=[];function Le(v,R){return v[4]===v[27].Posts?0:v[4]==v[27].Followers?1:v[4]==v[27].Following?2:-1}return~(P=Le(o))&&(Z=ae[P]=Ce[P](o)),{c(){e=w("div"),n=w("div"),_&&_.c(),s=B(),g&&g.c(),l=B(),t=w("div"),i=w("div"),p&&p.c(),r=B(),a=w("img"),f=B(),d=w("div"),h&&h.c(),A=B(),K=w("a"),T=ce(y),S=B(),j&&j.c(),Y=B(),D=w("div"),H&&H.c(),G=B(),W&&W.c(),C=B(),z&&z.c(),ne=B(),U=w("div"),X&&X.c(),x=B(),Q&&Q.c(),se=B(),ee&&ee.c(),oe=B(),le=w("section"),Z&&Z.c(),this.h()},l(v){e=E(v,"DIV",{class:!0});var R=M(e);n=E(R,"DIV",{class:!0});var fe=M(n);_&&_.l(fe),s=V(fe),g&&g.l(fe),fe.forEach(m),l=V(R),t=E(R,"DIV",{class:!0});var ye=M(t);i=E(ye,"DIV",{class:!0});var Ne=M(i);p&&p.l(Ne),r=V(Ne),a=E(Ne,"IMG",{src:!0,alt:!0,class:!0}),Ne.forEach(m),f=V(ye),d=E(ye,"DIV",{class:!0});var Ae=M(d);h&&h.l(Ae),A=V(Ae),K=E(Ae,"A",{href:!0,class:!0});var Ue=M(K);T=ue(Ue,y),Ue.forEach(m),Ae.forEach(m),ye.forEach(m),S=V(R),j&&j.l(R),Y=V(R),D=E(R,"DIV",{class:!0});var b=M(D);H&&H.l(b),G=V(b),W&&W.l(b),C=V(b),z&&z.l(b),b.forEach(m),ne=V(R),U=E(R,"DIV",{class:!0});var I=M(U);X&&X.l(I),x=V(I),Q&&Q.l(I),se=V(I),ee&&ee.l(I),I.forEach(m),R.forEach(m),oe=V(v),le=E(v,"SECTION",{class:!0});var q=M(le);Z&&Z.l(q),q.forEach(m),this.h()},h(){u(n,"class","banner svelte-14ajx5b"),Ie(a.src,c=Me(o[16],String(o[13].icon?.url)))||u(a,"src",c),u(a,"alt","Avatar"),u(a,"class","svelte-14ajx5b"),u(i,"class","avatar svelte-14ajx5b"),u(K,"href",J=Se(o[13].url)),u(K,"class","svelte-14ajx5b"),u(d,"class","details svelte-14ajx5b"),u(t,"class","identity svelte-14ajx5b"),u(D,"class","summary svelte-14ajx5b"),u(U,"class","tabs svelte-14ajx5b"),u(e,"class","profile svelte-14ajx5b"),u(le,"class","svelte-14ajx5b")},m(v,R){N(v,e,R),k(e,n),_&&_.m(n,null),k(n,s),g&&g.m(n,null),k(e,l),k(e,t),k(t,i),p&&p.m(i,null),k(i,r),k(i,a),k(t,f),k(t,d),h&&h.m(d,null),k(d,A),k(d,K),k(K,T),k(e,S),j&&j.m(e,null),k(e,Y),k(e,D),H&&H.m(D,null),k(D,G),W&&W.m(D,null),k(D,C),z&&z.m(D,null),k(e,ne),k(e,U),X&&X.m(U,null),k(U,x),Q&&Q.m(U,null),k(U,se),ee&&ee.m(U,null),N(v,oe,R),N(v,le,R),~P&&ae[P].m(le,null),ie=!0},p(v,R){v[17]?_?_.p(v,R):(_=_l(v),_.c(),_.m(n,s)):_&&(_.d(1),_=null),v[13].image?g?g.p(v,R):(g=pl(v),g.c(),g.m(n,null)):g&&(g.d(1),g=null),v[17]?p?p.p(v,R):(p=bl(v),p.c(),p.m(i,r)):p&&(p.d(1),p=null),(!ie||R[0]&73728&&!Ie(a.src,c=Me(v[16],String(v[13].icon?.url))))&&u(a,"src",c),v[13].name?h?h.p(v,R):(h=gl(v),h.c(),h.m(d,A)):h&&(h.d(1),h=null),(!ie||R[0]&8192)&&y!==(y=xe(v[13])+"")&&De(T,y),(!ie||R[0]&8192&&J!==(J=Se(v[13].url)))&&u(K,"href",J),v[17]?j?j.p(v,R):(j=vl(v),j.c(),j.m(e,Y)):j&&(j.d(1),j=null),v[6]?H?H.p(v,R):(H=Ol(v),H.c(),H.m(D,G)):H&&(H.d(1),H=null),v[17]&&!v[6]?W?W.p(v,R):(W=Sl(v),W.c(),W.m(D,C)):W&&(W.d(1),W=null),v[17]?z&&(z.d(1),z=null):z?z.p(v,R):(z=Il(v),z.c(),z.m(D,null)),v[14]?X?X.p(v,R):(X=jl(v),X.c(),X.m(U,x)):X&&(X.d(1),X=null),v[14]||v[17]?Q?Q.p(v,R):(Q=Ml(v),Q.c(),Q.m(U,se)):Q&&(Q.d(1),Q=null),v[17]?ee?ee.p(v,R):(ee=Fl(v),ee.c(),ee.m(U,null)):ee&&(ee.d(1),ee=null);let fe=P;P=Le(v),P===fe?~P&&ae[P].p(v,R):(Z&&(de(),L(ae[fe],1,1,()=>{ae[fe]=null}),_e()),~P?(Z=ae[P],Z?Z.p(v,R):(Z=ae[P]=Ce[P](v),Z.c()),F(Z,1),Z.m(le,null)):Z=null)},i(v){ie||(F(Z),ie=!0)},o(v){L(Z),ie=!1},d(v){v&&(m(e),m(oe),m(le)),_&&_.d(),g&&g.d(),p&&p.d(),h&&h.d(),j&&j.d(),H&&H.d(),W&&W.d(),z&&z.d(),X&&X.d(),Q&&Q.d(),ee&&ee.d(),~P&&ae[P].d()}}}function _l(o){let e,n,s;return{c(){e=w("input"),this.h()},l(l){e=E(l,"INPUT",{style:!0,type:!0,accept:!0}),this.h()},h(){Cl(e,"display","none"),u(e,"type","file"),u(e,"accept",".jpg, .jpeg, .png")},m(l,t){N(l,e,t),o[30](e),n||(s=$(e,"change",o[29]),n=!0)},p:O,d(l){l&&m(e),o[30](null),n=!1,s()}}}function pl(o){let e,n;return{c(){e=w("img"),this.h()},l(s){e=E(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Ie(e.src,n=Me(o[16],String(o[13].image.url)))||u(e,"src",n),u(e,"alt","Banner"),u(e,"class","svelte-14ajx5b")},m(s,l){N(s,e,l)},p(s,l){l[0]&73728&&!Ie(e.src,n=Me(s[16],String(s[13].image.url)))&&u(e,"src",n)},d(s){s&&m(e)}}}function bl(o){let e,n,s;return{c(){e=w("input"),this.h()},l(l){e=E(l,"INPUT",{style:!0,type:!0,accept:!0}),this.h()},h(){Cl(e,"display","none"),u(e,"type","file"),u(e,"accept",".jpg, .jpeg, .png")},m(l,t){N(l,e,t),o[32](e),n||(s=$(e,"change",o[31]),n=!0)},p:O,d(l){l&&m(e),o[32](null),n=!1,s()}}}function gl(o){let e,n,s=be(o[16],o[13].name,o[13])+"";return{c(){e=w("h1"),n=new Be(!1),this.h()},l(l){e=E(l,"H1",{class:!0});var t=M(e);n=Ve(t,!1),t.forEach(m),this.h()},h(){n.a=null,u(e,"class","svelte-14ajx5b")},m(l,t){N(l,e,t),n.m(s,e)},p(l,t){t[0]&73728&&s!==(s=be(l[16],l[13].name,l[13])+"")&&n.p(s)},d(l){l&&m(e)}}}function vl(o){let e,n=o[1].domain&&(!o[13].id?.includes(o[1].domain)||o[13].preferredUsername!==o[17]),s,l,t=n&&kl(o),i=o[14]&&o[13].preferredUsername===o[17]&&yl(o);function r(f,d){if(f[6])return vt;if(f[5])return gt}let a=r(o),c=a&&a(o);return{c(){e=w("div"),t&&t.c(),s=B(),i&&i.c(),l=B(),c&&c.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var d=M(e);t&&t.l(d),s=V(d),i&&i.l(d),l=V(d),c&&c.l(d),d.forEach(m),this.h()},h(){u(e,"class","controls svelte-14ajx5b")},m(f,d){N(f,e,d),t&&t.m(e,null),k(e,s),i&&i.m(e,null),k(e,l),c&&c.m(e,null)},p(f,d){d[0]&139266&&(n=f[1].domain&&(!f[13].id?.includes(f[1].domain)||f[13].preferredUsername!==f[17])),n?t?t.p(f,d):(t=kl(f),t.c(),t.m(e,s)):t&&(t.d(1),t=null),f[14]&&f[13].preferredUsername===f[17]?i?i.p(f,d):(i=yl(f),i.c(),i.m(e,l)):i&&(i.d(1),i=null),a===(a=r(f))&&c?c.p(f,d):(c&&c.d(1),c=a&&a(f),c&&(c.c(),c.m(e,null)))},d(f){f&&m(e),t&&t.d(),i&&i.d(),c&&c.d()}}}function kl(o){let e,n,s,l=!o[13].ephemeral?.following&&wl(o),t=o[13].ephemeral?.following!==void 0&&o[13].ephemeral?.following&&El(o),i=o[13].capabilities&&o[13].capabilities.enigmatickEncryption&&Tl();return{c(){e=w("div"),l&&l.c(),n=B(),t&&t.c(),s=B(),i&&i.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var a=M(e);l&&l.l(a),n=V(a),t&&t.l(a),s=V(a),i&&i.l(a),a.forEach(m),this.h()},h(){u(e,"class","svelte-14ajx5b")},m(r,a){N(r,e,a),l&&l.m(e,null),k(e,n),t&&t.m(e,null),k(e,s),i&&i.m(e,null)},p(r,a){r[13].ephemeral?.following?l&&(l.d(1),l=null):l?l.p(r,a):(l=wl(r),l.c(),l.m(e,n)),r[13].ephemeral?.following!==void 0&&r[13].ephemeral?.following?t?t.p(r,a):(t=El(r),t.c(),t.m(e,s)):t&&(t.d(1),t=null),r[13].capabilities&&r[13].capabilities.enigmatickEncryption?i?i.p(r,a):(i=Tl(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(r){r&&m(e),l&&l.d(),t&&t.d(),i&&i.d()}}}function wl(o){let e,n='<i class="fa-solid fa-user-plus svelte-14ajx5b"></i>',s,l;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(t){e=E(t,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(e)!=="svelte-1fpfhx1"&&(e.innerHTML=n),this.h()},h(){u(e,"title","Follow"),u(e,"class","svelte-14ajx5b")},m(t,i){N(t,e,i),s||(l=$(e,"click",re(o[25])),s=!0)},p:O,d(t){t&&m(e),s=!1,l()}}}function El(o){let e,n='<i class="fa-solid fa-user-minus svelte-14ajx5b"></i>',s,l;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(t){e=E(t,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(e)!=="svelte-18omo1r"&&(e.innerHTML=n),this.h()},h(){u(e,"title","Unfollow"),u(e,"class","svelte-14ajx5b")},m(t,i){N(t,e,i),s||(l=$(e,"click",re(o[33])),s=!0)},p:O,d(t){t&&m(e),s=!1,l()}}}function Tl(o){let e,n='<i class="fa-solid fa-key svelte-14ajx5b"></i>',s,l;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(t){e=E(t,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(e)!=="svelte-1vnpazn"&&(e.innerHTML=n),this.h()},h(){u(e,"title","Exchange Keys"),u(e,"class","svelte-14ajx5b")},m(t,i){N(t,e,i),s||(l=$(e,"click",re(yt)),s=!0)},p:O,d(t){t&&m(e),s=!1,l()}}}function yl(o){let e,n,s='<i class="fa-solid fa-image-portrait svelte-14ajx5b"></i>',l,t,i='<i class="fa-solid fa-panorama svelte-14ajx5b"></i>',r,a,c,f=!o[6]&&Nl(o);return{c(){e=w("div"),n=w("button"),n.innerHTML=s,l=B(),t=w("button"),t.innerHTML=i,r=B(),f&&f.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var A=M(e);n=E(A,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(n)!=="svelte-lg8yq1"&&(n.innerHTML=s),l=V(A),t=E(A,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(t)!=="svelte-d6jqg4"&&(t.innerHTML=i),r=V(A),f&&f.l(A),A.forEach(m),this.h()},h(){u(n,"title","Change Avatar"),u(n,"class","svelte-14ajx5b"),u(t,"title","Change Banner"),u(t,"class","svelte-14ajx5b"),u(e,"class","svelte-14ajx5b")},m(d,A){N(d,e,A),k(e,n),k(e,l),k(e,t),k(e,r),f&&f.m(e,null),a||(c=[$(n,"keypress",o[34]),$(n,"click",o[35]),$(t,"keypress",o[36]),$(t,"click",o[37])],a=!0)},p(d,A){d[6]?f&&(f.d(1),f=null):f?f.p(d,A):(f=Nl(d),f.c(),f.m(e,null))},d(d){d&&m(e),f&&f.d(),a=!1,Je(c)}}}function Nl(o){let e,n='<i class="fa-solid fa-pencil svelte-14ajx5b"></i>',s,l;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(t){e=E(t,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(e)!=="svelte-14msdjk"&&(e.innerHTML=n),this.h()},h(){u(e,"title","Update Biography"),u(e,"class","svelte-14ajx5b")},m(t,i){N(t,e,i),s||(l=[$(e,"click",re(o[19])),$(e,"keypress",re(o[19]))],s=!0)},p:O,d(t){t&&m(e),s=!1,Je(l)}}}function gt(o){let e,n,s='<i class="fa-solid fa-floppy-disk svelte-14ajx5b"></i>',l,t;return{c(){e=w("div"),n=w("button"),n.innerHTML=s,this.h()},l(i){e=E(i,"DIV",{class:!0});var r=M(e);n=E(r,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(n)!=="svelte-166g12d"&&(n.innerHTML=s),r.forEach(m),this.h()},h(){u(n,"title","Save"),u(n,"class","svelte-14ajx5b"),u(e,"class","svelte-14ajx5b")},m(i,r){N(i,e,r),k(e,n),l||(t=$(n,"click",re(o[22])),l=!0)},p:O,d(i){i&&m(e),l=!1,t()}}}function vt(o){let e,n,s='<i class="fa-solid fa-ban svelte-14ajx5b"></i>',l,t,i='<i class="fa-solid fa-eye svelte-14ajx5b"></i>',r,a,c,f=o[5]&&Al(o);return{c(){e=w("div"),n=w("button"),n.innerHTML=s,l=B(),t=w("button"),t.innerHTML=i,r=B(),f&&f.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var A=M(e);n=E(A,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(n)!=="svelte-ccvfm4"&&(n.innerHTML=s),l=V(A),t=E(A,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(t)!=="svelte-1l4zhbg"&&(t.innerHTML=i),r=V(A),f&&f.l(A),A.forEach(m),this.h()},h(){u(n,"title","Cancel"),u(n,"class","svelte-14ajx5b"),u(t,"title","Preview"),u(t,"class","svelte-14ajx5b"),u(e,"class","svelte-14ajx5b")},m(d,A){N(d,e,A),k(e,n),k(e,l),k(e,t),k(e,r),f&&f.m(e,null),a||(c=[$(n,"click",re(o[21])),$(t,"click",re(o[20]))],a=!0)},p(d,A){d[5]?f?f.p(d,A):(f=Al(d),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(d){d&&m(e),f&&f.d(),a=!1,Je(c)}}}function Al(o){let e,n='<i class="fa-solid fa-floppy-disk svelte-14ajx5b"></i>',s,l;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(t){e=E(t,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),me(e)!=="svelte-d0kmnn"&&(e.innerHTML=n),this.h()},h(){u(e,"title","Save"),u(e,"class","svelte-14ajx5b")},m(t,i){N(t,e,i),s||(l=$(e,"click",re(o[22])),s=!0)},p:O,d(t){t&&m(e),s=!1,l()}}}function Ol(o){let e,n;return{c(){e=w("pre"),n=ce(o[7]),this.h()},l(s){e=E(s,"PRE",{id:!0,contenteditable:!0,class:!0});var l=M(e);n=ue(l,o[7]),l.forEach(m),this.h()},h(){u(e,"id","summary_edit"),u(e,"contenteditable","true"),u(e,"class","svelte-14ajx5b")},m(s,l){N(s,e,l),k(e,n)},p(s,l){l[0]&128&&Bl(n,s[7])},d(s){s&&m(e)}}}function Sl(o){let e,n,s=be(o[16],o[13].summary||"",o[13])+"";return{c(){e=w("div"),n=new Be(!1),this.h()},l(l){e=E(l,"DIV",{class:!0});var t=M(e);n=Ve(t,!1),t.forEach(m),this.h()},h(){n.a=null,u(e,"class","svelte-14ajx5b")},m(l,t){N(l,e,t),n.m(s,e)},p(l,t){t[0]&73728&&s!==(s=be(l[16],l[13].summary||"",l[13])+"")&&n.p(s)},d(l){l&&m(e)}}}function Il(o){let e,n,s=(o[13].summary||"")+"";return{c(){e=w("span"),n=new Be(!1),this.h()},l(l){e=E(l,"SPAN",{class:!0});var t=M(e);n=Ve(t,!1),t.forEach(m),this.h()},h(){n.a=null,u(e,"class","svelte-14ajx5b")},m(l,t){N(l,e,t),n.m(s,e)},p(l,t){t[0]&8192&&s!==(s=(l[13].summary||"")+"")&&n.p(s)},d(l){l&&m(e)}}}function jl(o){let e,n,s;return{c(){e=w("button"),n=ce("Articles"),this.h()},l(l){e=E(l,"BUTTON",{class:!0});var t=M(e);n=ue(t,"Articles"),t.forEach(m),this.h()},h(){u(e,"class",s=pe(o[4]===o[27].Articles?"selected":"")+" svelte-14ajx5b")},m(l,t){N(l,e,t),k(e,n)},p(l,t){t[0]&16&&s!==(s=pe(l[4]===l[27].Articles?"selected":"")+" svelte-14ajx5b")&&u(e,"class",s)},d(l){l&&m(e)}}}function Ml(o){let e,n,s,l,t;return{c(){e=w("button"),n=ce("Posts"),this.h()},l(i){e=E(i,"BUTTON",{class:!0});var r=M(e);n=ue(r,"Posts"),r.forEach(m),this.h()},h(){u(e,"class",s=pe(o[4]===o[27].Posts?"selected":"")+" svelte-14ajx5b")},m(i,r){N(i,e,r),k(e,n),l||(t=$(e,"click",o[38]),l=!0)},p(i,r){r[0]&16&&s!==(s=pe(i[4]===i[27].Posts?"selected":"")+" svelte-14ajx5b")&&u(e,"class",s)},d(i){i&&m(e),l=!1,t()}}}function Fl(o){let e,n,s=Pe(o[13].ephemeral?.leaders||o[9])+"",l,t,i,r,a,c=Pe(o[13].ephemeral?.followers||o[8])+"",f,d,A,K;return{c(){e=w("button"),n=ce("Following • "),l=ce(s),i=B(),r=w("button"),a=ce("Followers • "),f=ce(c),this.h()},l(y){e=E(y,"BUTTON",{class:!0});var T=M(e);n=ue(T,"Following • "),l=ue(T,s),T.forEach(m),i=V(y),r=E(y,"BUTTON",{class:!0});var J=M(r);a=ue(J,"Followers • "),f=ue(J,c),J.forEach(m),this.h()},h(){u(e,"class",t=pe(o[4]===o[27].Following?"selected":"")+" svelte-14ajx5b"),u(r,"class",d=pe(o[4]===o[27].Followers?"selected":"")+" svelte-14ajx5b")},m(y,T){N(y,e,T),k(e,n),k(e,l),N(y,i,T),N(y,r,T),k(r,a),k(r,f),A||(K=[$(e,"click",o[39]),$(r,"click",o[40])],A=!0)},p(y,T){T[0]&8704&&s!==(s=Pe(y[13].ephemeral?.leaders||y[9])+"")&&De(l,s),T[0]&16&&t!==(t=pe(y[4]===y[27].Following?"selected":"")+" svelte-14ajx5b")&&u(e,"class",t),T[0]&8448&&c!==(c=Pe(y[13].ephemeral?.followers||y[8])+"")&&De(f,c),T[0]&16&&d!==(d=pe(y[4]===y[27].Followers?"selected":"")+" svelte-14ajx5b")&&u(r,"class",d)},d(y){y&&(m(e),m(i),m(r)),A=!1,Je(K)}}}function kt(o){let e,n,s={handle:o[0].params.handle,local:o[14],view:"Following",cache:o[15],cachedActor:o[18]};return e=new Hl({props:s}),o[43](e),{c(){ke(e.$$.fragment)},l(l){we(e.$$.fragment,l)},m(l,t){Ee(e,l,t),n=!0},p(l,t){const i={};t[0]&1&&(i.handle=l[0].params.handle),t[0]&16384&&(i.local=l[14]),t[0]&32768&&(i.cache=l[15]),e.$set(i)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){L(e.$$.fragment,l),n=!1},d(l){o[43](null),Te(e,l)}}}function wt(o){let e,n,s={handle:o[0].params.handle,local:o[14],view:"Followers",cache:o[15],cachedActor:o[18]};return e=new Hl({props:s}),o[42](e),{c(){ke(e.$$.fragment)},l(l){we(e.$$.fragment,l)},m(l,t){Ee(e,l,t),n=!0},p(l,t){const i={};t[0]&1&&(i.handle=l[0].params.handle),t[0]&16384&&(i.local=l[14]),t[0]&32768&&(i.cache=l[15]),e.$set(i)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){L(e.$$.fragment,l),n=!1},d(l){o[42](null),Te(e,l)}}}function Et(o){let e,n,s={handle:o[0].params.handle,local:o[14]};return e=new at({props:s}),o[41](e),{c(){ke(e.$$.fragment)},l(l){we(e.$$.fragment,l)},m(l,t){Ee(e,l,t),n=!0},p(l,t){const i={};t[0]&1&&(i.handle=l[0].params.handle),t[0]&16384&&(i.local=l[14]),e.$set(i)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){L(e.$$.fragment,l),n=!1},d(l){o[41](null),Te(e,l)}}}function Dl(o){let e,n,s=o[13]&&dl(o);return{c(){e=w("main"),s&&s.c(),this.h()},l(l){e=E(l,"MAIN",{class:!0});var t=M(e);s&&s.l(t),t.forEach(m),this.h()},h(){u(e,"class","svelte-14ajx5b")},m(l,t){N(l,e,t),s&&s.m(e,null),n=!0},p(l,t){l[13]?s?(s.p(l,t),t[0]&8192&&F(s,1)):(s=dl(l),s.c(),F(s,1),s.m(e,null)):s&&(de(),L(s,1,1,()=>{s=null}),_e())},i(l){n||(F(s),n=!0)},o(l){L(s),n=!1},d(l){l&&m(e),s&&s.d()}}}function Tt(o){let e=o[13],n,s,l=Dl(o);return{c(){l.c(),n=he()},l(t){l.l(t),n=he()},m(t,i){l.m(t,i),N(t,n,i),s=!0},p(t,i){i[0]&8192&&Re(e,e=t[13])?(de(),L(l,1,1,O),_e(),l=Dl(t),l.c(),F(l,1),l.m(n.parentNode,n)):l.p(t,i)},i(t){s||(F(l),s=!0)},o(t){L(l),s=!1},d(t){t&&m(n),l.d(t)}}}async function yt(o){console.log(o)}function Nt(o,e,n){let s,l,t,i,r;ve(o,Vl,b=>n(0,t=b)),ve(o,We,b=>n(28,i=b)),ve(o,Ll,b=>n(1,r=b));const{Converter:a}=Gl;Qe(async()=>{});async function c(b){if(console.debug(`INSTANCE DOMAIN: ${r.domain}`),console.log(`GETTING ${b}`),b.includes("@")){console.debug("REQUEST FOR REMOTE PROFILE"),n(14,j=!1);let I=await f(`@${b}`,H);n(13,h=JSON.parse(I)),console.debug(h),p&&h&&(n(12,p.local=j,p),n(12,p.handle=b,p),n(12,p.profile=h,p)),s?.get_remote_followers(`@${b}`).then(q=>{if(q){let te=JSON.parse(q);n(8,Z=te.totalItems||0)}}),s?.get_remote_following(`@${b}`).then(q=>{if(q){let te=JSON.parse(q);n(9,ie=te.totalItems||0)}})}else console.debug("REQUEST FOR LOCAL PROFILE"),n(14,j=!0),s?.get_profile_by_username(b).then(I=>{console.log("IN get_profile_by_username"),I&&(console.log(I),n(13,h=JSON.parse(I)),console.debug(h),p&&h&&(n(12,p.local=j,p),n(12,p.handle=b,p),n(12,p.profile=h,p)),n(7,P=h?.ephemeral?.summaryMarkdown||""))})}async function f(b,I){if(I)try{return console.debug(`RETRIEVING ${b} FROM CACHE`),await s?.get_actor_cached(I,b)}catch{return console.error(`FAILED TO RETRIEVE: ${b}`),null}return null}function d(b){let I=new a({extensions:[zl({pre:!0,auto_detection:!0})]});return I.setFlavor("github"),I.setOption("tables",!0),I.setOption("requireSpaceBeforeHeadingText",!0),I.makeHtml(b)}function A(b){(b instanceof KeyboardEvent&&(b.key==="Enter"||b.key===" ")||b instanceof MouseEvent&&b.type==="click")&&n(6,le=!0)}function K(b){let I=document.getElementById("summary_edit");if(I){let q=I.innerText;h&&(n(7,P=q),n(6,le=!1),n(13,h.summary=d(q),h),n(5,oe=!0))}}function y(b){n(6,le=!1)}function T(){h&&h.summary&&s?.update_summary(h.summary,P).then(b=>{console.log(b),n(5,oe=!1)})}const J=b=>{let I=b.target;if(I.files!==null){let q=I.files[0],te=String(q.name.match(/\.[0-9a-z]+$/i)).slice(1),Fe=new FileReader;Fe.readAsArrayBuffer(q),Fe.onload=ge=>{if(ge.target!==null){C=ge.target.result!==null?ge.target.result:null,console.log(C);let qe=new Uint8Array(C);s?.upload_avatar(qe,C.byteLength,te).then(()=>{c(t.params.handle)})}}}},S=b=>{let I=b.target;if(I.files!==null){let q=I.files[0],te=String(q.name.match(/\.[0-9a-z]+$/i)).slice(1),Fe=new FileReader;Fe.readAsArrayBuffer(q),Fe.onload=ge=>{if(ge.target!==null){U=ge.target.result!==null?ge.target.result:null,console.log(U);let qe=new Uint8Array(U);s?.upload_banner(qe,U.byteLength,te).then(()=>{c(t.params.handle)})}}}};function Y(b){h&&h.id?(console.log("Following: "+h.id),s?.send_follow(h.id).then(I=>{if(I&&h){let q=JSON.parse(I);console.debug(`Follow sent: ${q.id}`);let te=h.ephemeral||{};te.following=!0,n(13,h.ephemeral=te,h)}})):console.log("no profile loaded")}function D(b){b&&h&&h.id?(console.log("Unfollowing: "+h.id),s?.send_unfollow(h.id,b).then(I=>{if(I&&h){let q=JSON.parse(I);console.debug(`Unfollow sent: ${q.id}`);let te=h.ephemeral||{};te.following=!1,n(13,h.ephemeral=te,h)}})):console.log("no profile loaded")}const G={Articles:Symbol("articles"),Posts:Symbol("posts"),Followers:Symbol("followers"),Following:Symbol("following")};let C,ne,U,x,se=G.Posts,oe=!1,le=!1,P="",Z=0,ie=0,_,g,p,h=null,j=!0,H=null;Yl(async b=>{if(n(4,se=G.Posts),console.debug(b),b.to&&b.to.route.id===null){let I=b.to.url.href;const q=/^https:\/\/(:?[a-zA-Z0-9\-]+)(:?\.[a-zA-Z0-9\-]+)+?\/@[a-zA-Z0-9_]+\/?$/;if(I.match(q)){let te=Ze(I);te&&(console.log(`WEBFINGER: ${te}`),b.cancel(),await Xl(`/${te}`))}}});const W=b=>S(b);function z(b){Oe[b?"unshift":"push"](()=>{x=b,n(3,x)})}const X=b=>J(b);function Q(b){Oe[b?"unshift":"push"](()=>{ne=b,n(2,ne)})}const ee=()=>D(h?.ephemeral?.followActivityAsId),Ce=()=>{ne.click()},ae=()=>{ne.click()},Le=()=>{x.click()},v=()=>{x.click()},R=()=>{n(4,se=G.Posts)},fe=()=>{n(4,se=G.Following)},ye=()=>{n(4,se=G.Followers)};function Ne(b){Oe[b?"unshift":"push"](()=>{p=b,n(12,p)})}function Ae(b){Oe[b?"unshift":"push"](()=>{_=b,n(10,_)})}function Ue(b){Oe[b?"unshift":"push"](()=>{g=b,n(11,g)})}return o.$$.update=()=>{o.$$.dirty[0]&268435456&&n(16,s=i),o.$$.dirty[0]&2&&n(17,l=r.username),o.$$.dirty[0]&268435457&&i&&(n(15,H=new i.EnigmatickCache),c(t.params.handle))},[t,r,ne,x,se,oe,le,P,Z,ie,_,g,p,h,j,H,s,l,f,A,K,y,T,J,S,Y,D,G,i,W,z,X,Q,ee,Ce,ae,Le,v,R,fe,ye,Ne,Ae,Ue]}class Lt extends ze{constructor(e){super(),Ge(this,e,Nt,Tt,Re,{},null,[-1,-1])}}export{Lt as component};
