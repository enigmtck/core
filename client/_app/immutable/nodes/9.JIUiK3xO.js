import{s as ee,f as l,a as L,l as Y,g as r,h as N,u as T,c as E,m as J,d as y,r as te,j as e,i as Q,v as a,D as O,E as V,G as j,M as ae,w as se,x as ne,o as le}from"../chunks/scheduler.tnyNm5U0.js";import{g as re}from"../chunks/globals.0cDDIVm6.js";import{S as oe,i as ie}from"../chunks/index.R_ElRwcJ.js";import{e as ce,a as ue}from"../chunks/stores.bABpd-zC.js";import{g as X}from"../chunks/navigation.xQTcNFtT.js";const{document:Z}=re;function me(v){let s,d,h="ENIGMATICK",f,o,A="Create Account",_,t,n,k=`Username
			<input name="username" type="text" placeholder="bob" class="svelte-1ypu0vx"/>`,M,i,P=`Display Name
			<input name="display_name" type="text" placeholder="Bob Anderson" class="svelte-1ypu0vx"/>`,B,x,H,c,I,b,D,u,q,w,R='<button class="svelte-1ypu0vx">Create Account</button>',S,g,W=`body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  display: block;
  background: white;
}
@media screen and (max-width: 700px) {
  body {
    background: #fafafa;
  }
}`,U,z;return{c(){s=l("main"),d=l("h1"),d.textContent=h,f=L(),o=l("h2"),o.textContent=A,_=L(),t=l("form"),n=l("label"),n.innerHTML=k,M=L(),i=l("label"),i.innerHTML=P,B=L(),x=l("label"),H=Y(`Password
			`),c=l("input"),I=L(),b=l("label"),D=Y(`Confirm Password
			`),u=l("input"),q=L(),w=l("div"),w.innerHTML=R,S=L(),g=l("style"),g.textContent=W,this.h()},l(C){s=r(C,"MAIN",{class:!0});var p=N(s);d=r(p,"H1",{class:!0,"data-svelte-h":!0}),T(d)!=="svelte-1bn9c6g"&&(d.textContent=h),f=E(p),o=r(p,"H2",{class:!0,"data-svelte-h":!0}),T(o)!=="svelte-lqaecl"&&(o.textContent=A),_=E(p),t=r(p,"FORM",{id:!0,method:!0,class:!0});var m=N(t);n=r(m,"LABEL",{class:!0,"data-svelte-h":!0}),T(n)!=="svelte-onj7mi"&&(n.innerHTML=k),M=E(m),i=r(m,"LABEL",{class:!0,"data-svelte-h":!0}),T(i)!=="svelte-1umteht"&&(i.innerHTML=P),B=E(m),x=r(m,"LABEL",{class:!0});var $=N(x);H=J($,`Password
			`),c=r($,"INPUT",{name:!0,type:!0,minlength:!0,placeholder:!0,class:!0}),$.forEach(y),I=E(m),b=r(m,"LABEL",{class:!0});var F=N(b);D=J(F,`Confirm Password
			`),u=r(F,"INPUT",{name:!0,type:!0,minlength:!0,placeholder:!0,class:!0}),F.forEach(y),q=E(m),w=r(m,"DIV",{class:!0,"data-svelte-h":!0}),T(w)!=="svelte-1msvkw3"&&(w.innerHTML=R),m.forEach(y),p.forEach(y),S=E(C);const K=te("svelte-skzsmw",Z.head);g=r(K,"STYLE",{lang:!0,"data-svelte-h":!0}),T(g)!=="svelte-1m6wti8"&&(g.textContent=W),K.forEach(y),this.h()},h(){e(d,"class","svelte-1ypu0vx"),e(o,"class","svelte-1ypu0vx"),e(n,"class","svelte-1ypu0vx"),e(i,"class","svelte-1ypu0vx"),e(c,"name","password"),e(c,"type","password"),c.required=!0,e(c,"minlength","5"),e(c,"placeholder","Use a password manager"),e(c,"class","svelte-1ypu0vx"),e(x,"class","svelte-1ypu0vx"),e(u,"name","confirm_password"),e(u,"type","password"),u.required=!0,e(u,"minlength","5"),e(u,"placeholder","Confirm your password"),e(u,"class","svelte-1ypu0vx"),e(b,"class","svelte-1ypu0vx"),e(w,"class","svelte-1ypu0vx"),e(t,"id","signup"),e(t,"method","POST"),e(t,"class","svelte-1ypu0vx"),e(s,"class","svelte-1ypu0vx"),e(g,"lang","scss")},m(C,p){Q(C,s,p),a(s,d),a(s,f),a(s,o),a(s,_),a(s,t),a(t,n),a(t,M),a(t,i),a(t,B),a(t,x),a(x,H),a(x,c),a(t,I),a(t,b),a(b,D),a(b,u),a(t,q),a(t,w),Q(C,S,p),a(Z.head,g),U||(z=[O(c,"change",V(G)),O(u,"change",V(G)),O(t,"submit",V(v[0]))],U=!0)},p:j,i:j,o:j,d(C){C&&(y(s),y(S)),y(g),U=!1,ae(z)}}}function G(){const v=document.getElementsByName("password")[0],s=document.getElementsByName("confirm_password")[0];return v.value==s.value}function de(v,s,d){let h,f;se(v,ce,_=>d(1,f=_));let o=ne(ue).username;le(()=>{o&&X(`/@${o}`)});async function A(_){const t=document.getElementsByTagName("button")[0];if(t.disabled=!0,_.target.checkValidity&&G()){let n=new FormData(_.target);console.log(n);let k=h?.create_olm_account();if(k){let M=h?.get_identity_public_key(k),i=h?.get_one_time_keys(k);n.get("username")&&n.get("display_name")&&n.get("password")&&M&&i&&h?.create_user(String(n.get("username")),String(n.get("display_name")),String(n.get("password")),String(M),String(i.pickled_account)).then(P=>{X("/login")})}}else console.error("FORM INVALID")}return v.$$.update=()=>{v.$$.dirty&2&&(h=f)},[A,f]}class ye extends oe{constructor(s){super(),ie(this,s,de,me,ee,{})}}export{ye as component};
